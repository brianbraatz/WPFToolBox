<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Petzold Book Blog - WPF Printing II</title></head><body style="text-align: center;">
    <div style="width: 40em; text-align: left;"><p style="text-align: center;"><b><font size="+4">P</font><font size="+3">ETZOLD</font>&nbsp;<font size="+4">B</font><font size="+3">OOK</font>&nbsp;<font size="+4">B</font><font size="+3">LOG</font></b></p><h4 style="text-align: center;">Charles Petzold on writing books, reading books, and exercising the internal <a title="Universal Turing Machine">UTM</a></h4><hr><table width="100%"><tbody><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/blog.xml">Recent Entries</a></td><td width="33%"></td></tr><tr><td width="33%"><a href="http://www.charlespetzold.com/blog/2006/02/220256.html">&lt; Previous</a></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/toc.html">Browse the Archives</a></td><td align="right" width="33%"><a href="http://www.charlespetzold.com/blog/2006/02/231013.html">Next &gt;</a></td></tr><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/rss.xml">Subscribe to the RSS Feed</a></td><td width="33%"></td></tr></tbody></table><hr><a href="http://www.charlespetzold.com/blog/2006/02/230940.html" style="color: rgb(0, 0, 128); text-decoration: none;"><h2>WPF Printing II</h2></a><p style="text-align: right;">February 23, 2006<br>NYC</p><p>
A few days ago <a href="http://www.charlespetzold.com/blog/2006/02/201111.html">I confessed</a> that I couldn't get the WPF <i>PrintDialog</i> to print an arbitrary <i>Visual</i> object, e.g., a panel. A kind correspondent recommended I subject the <i>Visual</i> to a layout pass. Because I've read Chapters 10, 11, and 12 of my forthcoming book, I know that layout involves calls to <i>Measure</i> and <i>Arrange</i>. Without these calls the <i>Visual</i> has a zero dimension, which doesn't quite register on the printed page.
</p>
<p>
It works! The <a href="http://www.charlespetzold.com/blog/2006/02/PrintaBunchaButtons.cs">PrintaBunchaButtons.cs</a> program (<a href="http://www.charlespetzold.com/blog/2006/02/PrintaBunchaButtons.csproj">PrintaBunchaButtons.csproj</a> project file) demonstrates how it's done. After showing a <i>PrintDialog</i>, the program creates a <i>Grid</i>, gives it a gradient brush, populates it with 25 buttons of various sizes, and then calls the grid's <i>Measure</i> method. This causes the <i>Grid</i> to call <i>Measure</i> on each of its children, and those children, etc, etc. The result is that <i>Grid</i> calculates a <i>DesiredSize</i> property that is adequate to fit its contents.
</p>
<p>
The PrintaBunchaButtons program then uses <i>DesiredSize</i> and the size of the printer page to calculate a upper-left corner of the <i>Grid</i> that centers it on the page. A call to the grid's <i>Arrange</i> method cements the deal. (<i>Grid</i>, or course, calls <i>Arrange</i> on its children, etc, etc.)
</p>
<p>
The final step is a call to <i>PrintVisual</i> to print the <i>Grid</i> on the page.
</p>
<p>
It is possible to call <i>PrintVisual</i> multiple times and print multiple pages, but each call to <i>PrintVisual</i> is considered a separate print job. Printing multiple pages in the same print job is better handled through the <i>PrintDocument</i> method that I hope to discuss in a blog entry within the next few days.
</p>
<div id="comments"><hr><table width="100%"><tbody><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/blog.xml">Recent Entries</a></td><td width="33%"></td></tr><tr><td width="33%"><a href="http://www.charlespetzold.com/blog/2006/02/220256.html">&lt; Previous</a></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/toc.html">Browse the Archives</a></td><td align="right" width="33%"><a href="http://www.charlespetzold.com/blog/2006/02/231013.html">Next &gt;</a></td></tr><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/rss.xml">Subscribe to the RSS Feed</a></td><td width="33%"></td></tr></tbody></table><hr><p>(c) Copyright Charles Petzold<br><a href="http://www.charlespetzold.com/">www.charlespetzold.com</a></p></div>
<a href="http://www.charlespetzold.com/">  </a></div></body></html>