<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head profile="http://gmpg.org/xfn/11"><title>XBAPs: OnDemand &amp; ClickOnce at scorbs</title>



	
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="generator" content="WordPress 2.1">
	<meta name="template" content="K2 Beta Two svn">
 	<meta name="description" content="">
  
	<link rel="stylesheet" type="text/css" media="screen" href="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/style.css">
	<link rel="stylesheet" type="text/css" media="print" href="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/print.css">
		<link rel="stylesheet" type="text/css" media="screen" href="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/rollingarchives.css">
			<link rel="stylesheet" type="text/css" media="screen" href="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/karen.css"><!-- hardcoded because I'm lazy --><!--  if life page -->
	
    

    
    
    <link rel="alternate" type="application/rss+xml" title="scorbs" href="http://scorbs.com/feed">
    <link rel="alternate" type="application/rss+xml" title="scorbs &gt;&gt; work" href="http://scorbs.com/work/feed">
    <link rel="alternate" type="application/rss+xml" title="scorbs &gt;&gt; life" href="http://scorbs.com/life/feed">

    
		<link rel="pingback" href="http://scorbs.com/xmlrpc.php">
	
		<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://scorbs.com/xmlrpc.php?rsd">
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/prototype.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/effects.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/k2functions.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/slider.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/trimmer.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/rollingarchives.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/livesearch.php"></script>
<script type="text/javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/comments.php"></script>

	<link rel="stylesheet" href="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/ela.css" type="text/css" media="screen">
		<style type="text/css">
				</style>
			

	<script type="text/javascript">
	//<![CDATA[
		var K2 = {};

				K2.LiveSearch = new Livesearch("searchform", "dynamic-content", "current-content",
			window.location.href.match(/^(http:\/\/[^\/]+)/)[1] + "/wp-content/themes/k2/rollingarchive.php",
			"Type and Wait to Search",
			"go");
		
				K2.RollingArchives = new RollingArchives("rollingarchives", "rollingcontent",
			window.location.href.match(/^(http:\/\/[^\/]+)/)[1] + "/wp-content/themes/k2/theloop.php",
			"Page %1$d of %2$d");
		
			//]]>
	</script>

		<link rel="archives" title="October 2007" href="http://scorbs.com/2007/10/">
	<link rel="archives" title="September 2007" href="http://scorbs.com/2007/09/">
	<link rel="archives" title="August 2007" href="http://scorbs.com/2007/08/">
	<link rel="archives" title="July 2007" href="http://scorbs.com/2007/07/">
	<link rel="archives" title="June 2007" href="http://scorbs.com/2007/06/">
	<link rel="archives" title="May 2007" href="http://scorbs.com/2007/05/">
	<link rel="archives" title="April 2007" href="http://scorbs.com/2007/04/">
	<link rel="archives" title="March 2007" href="http://scorbs.com/2007/03/">
	<link rel="archives" title="February 2007" href="http://scorbs.com/2007/02/">
	<link rel="archives" title="January 2007" href="http://scorbs.com/2007/01/">
	<link rel="archives" title="December 2006" href="http://scorbs.com/2006/12/">
	<link rel="archives" title="November 2006" href="http://scorbs.com/2006/11/">
	<link rel="archives" title="October 2006" href="http://scorbs.com/2006/10/">
	<link rel="archives" title="September 2006" href="http://scorbs.com/2006/09/">
	<link rel="archives" title="August 2006" href="http://scorbs.com/2006/08/">
	<link rel="archives" title="July 2006" href="http://scorbs.com/2006/07/">
	<link rel="archives" title="June 2006" href="http://scorbs.com/2006/06/">
	<link rel="archives" title="May 2006" href="http://scorbs.com/2006/05/">
	<link rel="archives" title="April 2006" href="http://scorbs.com/2006/04/">
	<link rel="archives" title="March 2006" href="http://scorbs.com/2006/03/">
	<link rel="archives" title="February 2006" href="http://scorbs.com/2006/02/">
	<link rel="archives" title="January 2006" href="http://scorbs.com/2006/01/">
	<link rel="archives" title="December 2005" href="http://scorbs.com/2005/12/"></head><body class="wordpress k2 y2007 m11 d01 h12 single s-y2006 s-m06 s-d28 s-h08 s-category-work s-author-admin sidebar-single">

<div id="page">

	<div id="header">

		<h1><a href="http://scorbs.com/">scorbs</a></h1>
		<p class="description"></p>

		<ul class="menu">
<!-- KCORBY EDITS -->
		<li class="current_page_item"><a href="http://scorbs.com/">Blog</a></li>
			<li class="page_item"><a href="http://scorbs.com/life">Life</a></li>
			<li class="page_item"><a href="http://scorbs.com/work">Work</a></li>
			<li class="page_item"><a href="http://scorbs.com/private-posts/" title="Private Posts">Private Posts</a></li>
<li class="page_item"><a href="http://scorbs.com/k2archives/" title="Archives">Archives</a></li>
			<li class="page_item">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>  <!-- hack to separate login -->
			<li class="page_item"><a href="http://scorbs.com/wp-login.php">Login</a></li>

		</ul>

	</div>

		<hr>

<div class="content">

	<div id="primary">
		<div id="current-content" class="hfeed">

			
	
	 


	
			
	<hr>

	
	<div class="navigation">
		<div class="left"><span>«</span> <a href="http://scorbs.com/2006/06/21/caching-xbaps/">Caching &amp; XBAPs</a></div>		<div class="right"><a href="http://scorbs.com/2006/06/29/mount-si/">Mount Si</a> <span>»</span></div>		<div class="clear"></div>
	</div>

	
	<hr>

		<div id="post-80" class="hentry p1 post publish author-admin category-work y2006 m06 d28 h08 alt">
			<div class="entry-head">
				<h3 class="entry-title"><a href="http://scorbs.com/2006/06/28/xbaps-ondemand-clickonce/" rel="bookmark" title="Permanent Link to &quot;XBAPs: OnDemand &amp; ClickOnce&quot;">XBAPs: OnDemand &amp; ClickOnce</a></h3>
				
				<div class="entry-meta">
					<span class="chronodata">
						Published  <abbr class="published" title="2006-06-28T21:06:56-0700">at June 28, 2006</abbr>					</span>

					<span class="entry-category">
						in <a href="http://scorbs.com/work/" title="View all posts in work">work</a>.					</span>

					
					
											<span class="entry-tags">Tags: <a href="http://scorbs.com/tag/work" rel="tag">work</a>.</span>
									</div> <!-- .entry-meta -->
			</div> <!-- .entry-head -->

			<div class="entry-content">
				<p>If
your XBAP has some “heft” to it (large resource files, large
assemblies, etc), it may make sense to architect your app to use
ClickOnce’s OnDemand APIs.</p>
<p>OnDemand APIs enable developers to delay download parts of the
application. This can result in a friendlier end-user UX. Note:
OnDemand files can be traditional resource files (e.g. images, xml
files, etc) or assemblies.</p>
<p><strong>Architecture Tips &amp; Tricks</strong><br>
Got satellite assemblies or large resource files? Slim down your
primary EXE to the bare minimum needed to start the app. Then, when the
XBAP is launched, only the application manifest, deployment manifest,
and primary EXE will be downloaded. As the user navigates around the
xbap, you can use a second thread to download other files/assemblies
silently in the background or show app-specific progress UI.</p>
<p><strong>The Sample</strong><br>
I’ve created a sample XBAP that does just this:</p>
<ol>
<li>Has slim primary EXE.</li>
<li>Utilizes 4 large image files and a controls dll. (Approx 3MB)</li>
<li>When user navigates to xbap, she sees a landing screen while the
controls dll &amp; images are being downloaded on separate thread.</li>
</ol>
<p>The major implementation steps are:</p>
<ol>
<li>Include resource files (i.e. images) as <a href="http://nerddawg.blogspot.com/2005/11/resources-in-windows-presentation.html">Content </a>not <a href="http://nerddawg.blogspot.com/2005/11/resources-in-windows-presentation.html">Resource</a>.</li>
<li>No change to control assemblies.</li>
<li>On the project properties page, select the publish tab. Click the
Application Files button. Put the “OnDemand” files in to a separate
group. (NOT “Required”.)</li>
<li>Add a reference to System.Deployment</li>
<li>Call the OnDemand Deployment APIs on a separate thread.</li>
</ol>
<p>Try it out <a href="http://scorbs.com/workapps/ondemand/OnDemandSample.xbap">the xbap (RC 1)</a>.  Get the code <a href="http://scorbs.com/workapps/ondemand/OnDemandSample.zip">here</a>.</p>
<p>Note: OnDemand APIs should only be called when applications are actually deployed using ClickOnce, not during F5 debug.</p>
<p><em>Pretty Illustrations</em><br>
Step&nbsp;1 above: Setting resources files as Content<br>
<img src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/ResourceProperties.bmp"></p>
<p>&nbsp;Step&nbsp;3 above: Setting resources files as Content<br>
<img src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/ApplicationFiles.bmp"></p>
<p><em>More Resources</em></p>
<ol>
<li><a href="http://msdn2.microsoft.com/en-us/library/ms404266.aspx">MSDN ClickOnce Deployment and Localization</a></li>
<li><a href="http://msdn2.microsoft.com/en-us/library/6czbkkbe.aspx">MSDN ClickOnce OnDemand Deployment Technology Sample</a></li>
<li><a href="http://msdn2.microsoft.com/en-us/library/ak58kz04.aspx">MSDN Walkthrough: Downloading Assemblies on Demand with the ClickOnce Deployment API Using the Designer</a></li>
</ol>

							</div> <!-- .entry-content -->

		</div> <!-- #post-ID -->

		
	
			
	
	<div class="comments">

		<h4><span id="comments">3</span> Responses to “XBAPs: OnDemand &amp; ClickOnce”</h4>

		<div class="metalinks">
			<span class="commentsrsslink"><a href="http://scorbs.com/2006/06/28/xbaps-ondemand-clickonce/feed/">Feed for this Entry</a></span>
					</div>

		
	<hr>

				<ol id="commentlist">

			
			<li id="comment-12016" class="comment c1 c-y2007 c-m06 c-d14 c-h01 alt">
								<a href="#comment-12016" class="counter" title="Permanent Link to this Comment">1</a>
				<span class="commentauthor"><a href="http://karlshifflett.wordpress.com/" rel="external nofollow">Karl Shifflett</a></span>

				<div class="comment-meta">
				<a href="#comment-12016" title="Permanent Link to this Comment">Jun 14th, 2007 at 2:45 am</a>												</div>
			
				<div class="comment-content">
					<p>Hi,</p>
<p>Nice article on a very important subject.</p>
<p>We are a company that currently has an Access / SQL Server solution.
There are abut 4000 total forms in our Utility Bill, Payroll, GL, AR,
Permits, TAX, etc.. application.</p>
<p>We have moved on the applications, Tax Assessment to ASP.NET 1.1 2 years ago.</p>
<p>Until 4 weeks ago, we were going to move everything into ASP.NET 2.0 using AJAX.</p>
<p>Then, I started investigating WPF.  WOW!  Best development tools and platorm I ever seeting in my 20 years of IT.</p>
<p>Question : Is this possible as an XBAP? We know we can do this using
the ClickOnce desktop deployment. We have tested deployments getting
their data over a VPN (remote access) and next week I’ll add in getting
the data over the Internet via Web Services.</p>
<p>But we have some customers, who so some unknown reason, are stuck on
a browser based product. I think it’s a lack of education.</p>
<p>Would it be possible to have a huge application running as an XBAP?
From what I can understand, the user would fire up their utility
billing application, just getting the first screen or two, then as they
click to look up a customer, view their bills, etc those portions of
code could download.</p>
<p>On things we have in our favor, is that most of our customers, would
be sourcing their XBAP from the own Intranet server, so maybe this
would run fast?</p>
<p>Sorry for the rantings.  Microsoft has provided excellent tools and given developers many choices.</p>
<p>Do you know of any real world large appliations running as XBAP’s?</p>
<p>Thank you and have a wonderful day</p>
<p>Karl<br>
704-849-8242 ext 207</p>
 
				</div>

							</li>

			
			<li id="comment-14338" class="comment c2 c-y2007 c-m07 c-d27 c-h03">
								<a href="#comment-14338" class="counter" title="Permanent Link to this Comment">2</a>
				<span class="commentauthor"><a href="http://dllcity.com/" rel="external nofollow">Mike Miller</a></span>

				<div class="comment-meta">
				<a href="#comment-14338" title="Permanent Link to this Comment">Jul 27th, 2007 at 4:39 pm</a>												</div>
			
				<div class="comment-content">
					<p>Karl is that number </p>
<p>704-849-8242</p>
<p>Still valid? Im in the Charlotte Area for a few weeks working on a project?</p>
<p>Thanks</p>
<p>Mike Miller</p>
 
				</div>

							</li>

			
			<li id="comment-18010" class="comment c3 byuser commentauthor-epsilone3 c-y2007 c-m10 c-d04 c-h03 alt">
								<a href="#comment-18010" class="counter" title="Permanent Link to this Comment">3</a>
				<span class="commentauthor">epsilone3</span>

				<div class="comment-meta">
				<a href="#comment-18010" title="Permanent Link to this Comment">Oct 4th, 2007 at 4:13 am</a>												</div>
			
				<div class="comment-content">
					<p>HI I JUST LOOKING IN THE NET ,<br>
FOR XBAP CUSTOM CONTROL SAMPLE AND INFO.</p>
<p>AND FIND ALMOST NOTHING.</p>
<p>LIKE DOE’S CUSTOM CONTROL OF WPF/E &amp; XBAP USING THE SAME INHERTED CLASS AND SO ON.<br>
THERE’S ANY WAY THAT MAYBE KAREN CAN WRITE A NICE ARTICLE ABOUT THE DIFFRENT OF CUSTOM CONTROL IN WPF/E VS XBAP.</p>
<p>ALSO THERE NO XBAP ONLY  !! ,FORUM AROUND.</p>
<p>NICE ARTICLE.</p>
<p>&amp;</p>
<p>10X ALOT.</p>
<p>Guy.</p>
 
				</div>

							</li>

			
		</ol> <!-- END #commentlist -->
				
				
				
		
	</div> <!-- END .comments 1 -->
		
		
		<div class="comments">
		<h4 id="respond" class="reply">Leave a Reply</h4>
		
		
			<form action="http://scorbs.com/wp-comments-post.php" method="post" id="commentform">

						
							<div id="comment-personaldetails">
					<p><input name="author" id="author" value="" size="22" tabindex="1" type="text">
					<label for="author"><strong>Name</strong> </label></p>
					
					<p><input name="email" id="email" value="" size="22" tabindex="2" type="text">
					<label for="email"><strong>Mail</strong> (will not be published) </label></p>
					
					<p><input name="url" id="url" value="" size="22" tabindex="3" type="text">
					<label for="url"><strong>Website</strong></label></p>			
				</div>
							<!--<p><strong>XHTML:</strong> You can use these tags &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;code&gt; &lt;em&gt; &lt;i&gt; &lt;strike&gt; &lt;strong&gt; :</p>-->
		
				<p><textarea name="comment" id="comment" cols="100" rows="10" tabindex="4"></textarea><span style="display: none;" id="error"></span></p>
		
								
				<p><input name="submit" id="submit" tabindex="5" value="Submit" type="submit"><img style="display: none;" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/spinner.gif" id="commentload">
				<input name="comment_post_ID" value="80" type="hidden"></p>
				
				<div class="clear"></div>

				
			</form>

				
			
	<hr>

	
	<div class="navigation">
		<div class="left"><span>«</span> <a href="http://scorbs.com/2006/06/21/caching-xbaps/">Caching &amp; XBAPs</a></div>		<div class="right"><a href="http://scorbs.com/2006/06/29/mount-si/">Mount Si</a> <span>»</span></div>		<div class="clear"></div>
	</div>

	
	<hr>
	
	</div> <!-- END .comments #2 -->
	
		</div> <!-- #current-content -->

		<div id="dynamic-content"></div>
	</div> <!-- #primary -->

	<hr>
<div id="sidebar-main" class="secondary">
<div id="search" class="widget module module1 sb-search alt"><h2 class="widgettitle">Search</h2>
<form method="get" id="searchform" action="http://scorbs.com"><input id="s" name="s" class="livesearch" autocomplete="off" value="Type and Wait to Search" type="text"><span style="opacity: 0.3;" id="searchreset"></span><span style="display: none;" id="searchload"></span><input style="display: none;" id="searchsubmit" value="go" type="submit"></form>
</div><div id="about" class="widget module module2 sb-text"><h2 class="widgettitle">About</h2>
<p>Karen Corby: the 8 sentence bio. <br>
<br>
Born in Pusan, S. Korea. Flown to MN to meet Mom, Dad, &amp;
(eventually) little bro. Grew up in SoCal. Nicknamed scorbs by
childhood pal. Studied at Stanford. Moved to Seattle to be a PM at MS.
Likes travel, reading, hiking, philosophy, photography, and gossip
magazines. Loves mac &amp; cheese.<br>
</p></div><div id="archives" class="widget module module3 sb-months alt"><h2 class="widgettitle">Archives</h2>
	<ul>
			<li><a href="http://scorbs.com/2007/10/" title="October 2007">October 2007</a></li>
	<li><a href="http://scorbs.com/2007/09/" title="September 2007">September 2007</a></li>
	<li><a href="http://scorbs.com/2007/08/" title="August 2007">August 2007</a></li>
	<li><a href="http://scorbs.com/2007/07/" title="July 2007">July 2007</a></li>
	<li><a href="http://scorbs.com/2007/06/" title="June 2007">June 2007</a></li>
	<li><a href="http://scorbs.com/2007/05/" title="May 2007">May 2007</a></li>
	<li><a href="http://scorbs.com/2007/04/" title="April 2007">April 2007</a></li>
	<li><a href="http://scorbs.com/2007/03/" title="March 2007">March 2007</a></li>
	<li><a href="http://scorbs.com/2007/02/" title="February 2007">February 2007</a></li>
	<li><a href="http://scorbs.com/2007/01/" title="January 2007">January 2007</a></li>
	<li><a href="http://scorbs.com/2006/12/" title="December 2006">December 2006</a></li>
	<li><a href="http://scorbs.com/2006/11/" title="November 2006">November 2006</a></li>
	<li><a href="http://scorbs.com/2006/10/" title="October 2006">October 2006</a></li>
	<li><a href="http://scorbs.com/2006/09/" title="September 2006">September 2006</a></li>
	<li><a href="http://scorbs.com/2006/08/" title="August 2006">August 2006</a></li>
	<li><a href="http://scorbs.com/2006/07/" title="July 2006">July 2006</a></li>
	<li><a href="http://scorbs.com/2006/06/" title="June 2006">June 2006</a></li>
	<li><a href="http://scorbs.com/2006/05/" title="May 2006">May 2006</a></li>
	<li><a href="http://scorbs.com/2006/04/" title="April 2006">April 2006</a></li>
	<li><a href="http://scorbs.com/2006/03/" title="March 2006">March 2006</a></li>
	<li><a href="http://scorbs.com/2006/02/" title="February 2006">February 2006</a></li>
	<li><a href="http://scorbs.com/2006/01/" title="January 2006">January 2006</a></li>
	<li><a href="http://scorbs.com/2005/12/" title="December 2005">December 2005</a></li>
	</ul>
	</div><div id="categories" class="widget module module4 sb-categories"><h2 class="widgettitle">Categories</h2>
	<ul>
			<li><a href="http://scorbs.com/life/buenosaires/" title="Nov 2006: Buenos Aires trip">buenos aires</a> (9)
</li>
	<li><a href="http://scorbs.com/life/family/" title="View all posts filed under family">family</a> (3)
</li>
	<li><a href="http://scorbs.com/life/kauai/" title="May/June 2007: Kauai, Hawaii trip">kauai</a> (4)
</li>
	<li><a href="http://scorbs.com/life/" title="View all posts filed under life">life</a> (123)
</li>
	<li><a href="http://scorbs.com/life/malaysiachina/" title="Sept 2006:  Malaysia/China trip">malaysia/china</a> (19)
</li>
	<li><a href="http://scorbs.com/life/thailandcambodia/" title="Dec 2005 to Jan 2006: Thailand/Cambodia vacation">thailand/cambodia</a> (21)
</li>
	<li><a href="http://scorbs.com/life/travel/" title="Travels">travel</a> (56)
</li>
	<li><a href="http://scorbs.com/work/" title="View all posts filed under work">work</a> (38)
</li>
	</ul>
	</div></div> <!-- #sidebar-main -->


<div class="clear"></div>

</div> <!-- .content -->

	<div class="clear"></div>

</div> <!-- Close Page -->

<hr>

<div id="footer">
	<p>scorbs is powered by <a href="http://wordpress.org/" title="Where children sing songs of binary bliss">WordPress 2.1</a> and <a href="http://getk2.com/" title="Loves you like a kitten.">K2<!--Beta Two svn--></a></p>
	<p>Current style is <a href="" title=" by Michael Heilemann"> 0.5</a> by <a href="http://binarybonsai.com/">Michael Heilemann</a><br></p>	<p><a href="http://scorbs.com/feed/">RSS Entries</a> and <a href="http://scorbs.com/comments/feed/">RSS Comments</a></p>
	<!-- 30 queries. 1.1130 seconds. -->
</div>
<!-- Start of StatCounter Code -->
<script type="text/javascript" language="javascript">
var sc_project=1711729; 
var sc_invisible=1; 
var sc_partition=16; 
var sc_security="9ae964a0"; 
</script>

<script type="text/javascript" language="javascript" src="XBAPs%20%20OnDemand%20&amp;%20ClickOnce%20at%20scorbs_files/counter.js"></script><noscript><a
href="http://www.statcounter.com/" target="_blank"><img
src="http://c17.statcounter.com/counter.php?sc_project=1711729&amp;java=0&amp;security=9ae964a0&amp;invisible=1"
alt="web page hit counter" border="0"></a> </noscript>
<!-- End of StatCounter Code -->

</body></html>