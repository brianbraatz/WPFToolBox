<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Petzold Book Blog - Converting Non-Loose XAML to XBAP</title></head><body style="text-align: center;">
    <div style="width: 40em; text-align: left;"><p style="text-align: center;"><b><font size="+4">P</font><font size="+3">ETZOLD</font>&nbsp;<font size="+4">B</font><font size="+3">OOK</font>&nbsp;<font size="+4">B</font><font size="+3">LOG</font></b></p><h4 style="text-align: center;">Charles Petzold on writing books, reading books, and exercising the internal <a title="Universal Turing Machine">UTM</a></h4><hr><table width="100%"><tbody><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/blog.xml">Recent Entries</a></td><td width="33%"></td></tr><tr><td width="33%"><a href="http://www.charlespetzold.com/blog/2007/08/160934.html">&lt; Previous</a></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/toc.html">Browse the Archives</a></td><td align="right" width="33%"><a href="http://www.charlespetzold.com/blog/2007/08/200408.html">Next &gt;</a></td></tr><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/rss.xml">Subscribe to the RSS Feed</a></td><td width="33%"></td></tr></tbody></table><hr><a href="http://www.charlespetzold.com/blog/2007/08/191027.html" style="color: rgb(0, 0, 128); text-decoration: none;"><h2>Converting Non-Loose XAML to XBAP</h2></a><p style="text-align: right;">August 19, 2007<br>Roscoe, N.Y.</p><p>
In some recent blog entries, I've shown some XAML files that reference
the Petzold.Media3D library. You can also find a bunch of these
"non-loose" XAML files in the <i>Figures</i> directory along with the downloadable code for my new book
<a href="http://www.charlespetzold.com/3D"><i>3D Programming for Windows</i></a>. 
</p>
<p>
I created these files in XamlCruncher 2.0. If you'd like to run these
XAML files outside of XamlCruncher 2.0, they must be converted to EXEs
or XBAPs. Converting to an XBAP is the easier option. Here's how:
</p>
<p>Suppose you have a XAML file named MyMasterpiece.xaml that
references a DLL named MyLibrary.dll. In Visual Studio, create a new
project of type XAML Browser Application named MyMasterpiece. </p>
<p>
Delete the files Readme.txt, Page1.xaml, Page1.xaml.cs, and App.xaml.cs.
</p>
<p>
From the Project menu, select Add Existing Item (or right-click the
Project name in the Solution Explorer and select Add and Existing
Item). Add MyMasterpiece.xaml to the project. You can either copy the
file to the project directory or just add a link to it.
</p>
<p>
From the Project menu, select Add Reference. Click the Browse tab. Navigate to MyLibrary.dll and select it.
</p>
<p>Edit the App.xaml file. Delete the x:Class attribute. For the
StartupUri attribute, replace Page1.xaml with MyMasterpiece.xaml.
Select Save from the File menu to save the new version. (This shouldn't
be necessary but it sometimes it.) </p>
<p>
You can now compile and run MyMasterpiece.xbap. 
</p>
<p>
If Visual Studio complains it can't find the executable after compiling
it, it probably screwed up the .CSPROJ project file. Right click the
project name in the Solution Explorer and select Unload Project. Right
click the project name again and select Edit MyMasterpiece.csproj. Make
sure the <i>ApplicationExtension</i> tag comes <b>before</b> the <i>StartArguments</i>
tag. (That's usually the problem.) Right click the project name again
and select Reload Project. You'll be prompted to save the project file.
Do so.
</p>
<p>Once you have compiled an XBAP, it is extremely easy to publish it
to your Web site: Select Properties from the Project menu, click the
Publish tab, and in the Publish Location enter an FTP address you would
normally use to copy files to your site. The FTP address can include a
new subdirectory (commonly the name of the project). Click Publish Now.
You will be prompted for a login name and password.
</p>


<div id="comments"><p><b>Submit comment:</b></p><div style="background: rgb(240, 240, 240) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;"><form method="post" action="/cgi-bin/cgiemail/blog/CommentForm.txt"><input name="success" value="http://www.charlespetzold.com/blog/SubmitSuccess.html" type="hidden"><input name="Subject" value="Converting Non-Loose XAML to XBAP" type="hidden">Name:<br><input name="Name" size="40" type="text"><br>URL or Email (optional):<br><input name="Site" size="60" type="text"><br>Comment (no HTML please):<br><textarea name="Comment" type="text" rows="10" cols="60"></textarea><br><input value="Submit" align="middle" type="submit"></form><p><b>NOTE: </b>Comments are examined personally and generally are posted within 12 hours.</p></div></div><hr><table width="100%"><tbody><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/blog.xml">Recent Entries</a></td><td width="33%"></td></tr><tr><td width="33%"><a href="http://www.charlespetzold.com/blog/2007/08/160934.html">&lt; Previous</a></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/blog/toc.html">Browse the Archives</a></td><td align="right" width="33%"><a href="http://www.charlespetzold.com/blog/2007/08/200408.html">Next &gt;</a></td></tr><tr><td width="33%"></td><td align="center" width="33%"><a href="http://www.charlespetzold.com/rss.xml">Subscribe to the RSS Feed</a></td><td width="33%"></td></tr></tbody></table><hr><p>(c) Copyright Charles Petzold<br><a href="http://www.charlespetzold.com/">www.charlespetzold.com</a></p></div>
<a href="http://www.charlespetzold.com/">  </a></body></html>