<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0059)http://blogs.msdn.com/dancre/archive/2006/08/05/689542.aspx -->
<HTML><HEAD><TITLE>Dan Crevier's Blog : DM-V-VM part 5: Commands</TITLE>
<META content=DM-V-VM name=keywords>
<META 
content="In the previous posts, I've covered data models and how to make data easily consumable by Avalon. Now, I want to start getting into the view model side of things because I don't think it's clear what I mean by them and I'm working up to an example. I" 
name=description>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blogs.msdn.com/dancre/pingback.aspx" rel=pingback><LINK media=print 
href="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/print.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/Common.css" 
type=text/css rel=stylesheet><LINK media=screen 
href="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/Blog.css" type=text/css 
rel=stylesheet><LINK media=print 
href="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/common_print.css" 
type=text/css rel=stylesheet><LINK media=print 
href="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/blog_print.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel="shortcut icon"><LINK title="Dan Crevier's Blog (RSS 2.0)" 
href="http://blogs.msdn.com/dancre/rss.xml" type=application/rss+xml 
rel=alternate><LINK title="Dan Crevier's Blog (Atom 1.0)" 
href="http://blogs.msdn.com/dancre/atom.xml" type=application/atom+xml 
rel=alternate><LINK title="DM-V-VM part 5: Commands Comment RSS (RSS 2.0)" 
href="http://blogs.msdn.com/dancre/commentrss.aspx?PostID=689542" 
type=application/rss+xml rel=alternate>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<SCRIPT src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/global.js" 
type=text/javascript></SCRIPT>

<STYLE type=text/css>BODY {
	FONT-SIZE: 84%
}
</STYLE>

<SCRIPT language=JavaScript>var doImage=doImage;var TType=TType;
function mhHover(tbl,idx,cls){var t,d;if(document.getElementById)t=document.getElementById(tbl);else t=document.all(tbl);if(t==null)return;if(t.getElementsByTagName)d=t.getElementsByTagName("TD");else d=t.all.tags("TD");if(d==null)return;if(d.length<=idx)return;d[idx].className=cls;}

</SCRIPT>

<SCRIPT language=javascript 
src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/minmax.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<FORM id=aspnetForm name=aspnetForm 
action=/dancre/archive/2006/08/05/689542.aspx method=post>
<DIV><INPUT id=__VIEWSTATE type=hidden 
value=/wEPDwUKLTMyNjg0MDc1MWRk4kqgif0qb+BsXqBU64DM+rPSfXA= name=__VIEWSTATE> 
</DIV>
<SCRIPT language=javascript 
src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/Telligent_Modal.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript type=text/javascript>
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['CommonModal'],['CommonModalTitle'],['CommonModalClose'],['CommonModalContent'],['CommonModalFooter'],['CommonModalResize'],['CommonModalMask'],100);
// ]]>
</SCRIPT>

<SCRIPT src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/ratingcontrol.js" 
type=text/javascript></SCRIPT>

<DIV id=AllContent>
<DIV id=CommonHeader>
<DIV id=msviMasthead>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE height=22 cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD id=msviRegionIdGraphic bgColor=#ffffff></TD>
          <TD width="100%" bgColor=#3568cc><IMG title="" height=22 alt=* 
            src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/topGradient.jpg" 
            width=250></TD></TR></TBODY></TABLE></TD>
    <TD id=msviGlobalToolbar noWrap align=left bgColor=#3568cc height=22>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=gt0 onmouseover="mhHover('msviGlobalToolbar', 0, 'gt1')" 
          onmouseout="mhHover('msviGlobalToolbar', 0, 'gt0')" noWrap><A 
            style="FONT-SIZE: 95%" 
            href="http://www.microsoft.com/">Microsoft.com Home</A></TD>
          <TD class=gtsep>|</TD>
          <TD class=gt0 onmouseover="mhHover('msviGlobalToolbar', 2, 'gt1')" 
          onmouseout="mhHover('msviGlobalToolbar', 2, 'gt0')" noWrap><A 
            style="FONT-SIZE: 95%" 
            href="http://www.microsoft.com/library/toolbar/3.0/sitemap/en-us.mspx">Site 
            Map</A></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD width="100%">
      <TABLE height=42 cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=msviBrandBanner bgColor=#ffffff><A 
            href="http://msdn.microsoft.com/"><IMG title="" height=42 alt=MSDN 
            src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/msdn_masthead_ltr.gif" 
            width=225 border=0></A></TD>
          <TD width="100%" bgColor=#6799ff><IMG title="" height=42 alt=* 
            src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/topGradient2.jpg" 
            width=250></TD></TR></TBODY></TABLE></TD>
    <TD id=msviGlobalSearch bgColor=#6799ff>
      <DIV id=msviNoSearch></DIV></TD></TR></TBODY></TABLE>
<DIV id=msviLocalToolbar>
<TABLE height=19 cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD id=msviHomePageLink noWrap width=177><A 
      href="http://msdn.microsoft.com/">MSDN Home</A></TD>
    <TD><SPAN class=ltsep>|</SPAN></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 2, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 2, 'lt0')" noWrap><A 
      href="http://msdn.microsoft.com/developercenters/">Developer 
Centers</A></TD>
    <TD><SPAN class=ltsep>|</SPAN></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 4, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 4, 'lt0')" noWrap><A 
      href="http://msdn.microsoft.com/flash">MSDN Flash</A></TD>
    <TD><SPAN class=ltsep>|</SPAN></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 6, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 6, 'lt0')" noWrap><A 
      href="http://msdn.microsoft.com/subscriptions/">Subscribers</A></TD>
    <TD></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 8, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 8, 'lt0')" noWrap>&nbsp;</TD>
    <TD></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 10, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 10, 'lt0')" noWrap>&nbsp;</TD>
    <TD></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 12, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 12, 'lt0')" noWrap>&nbsp;</TD>
    <TD></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 14, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 14, 'lt0')" noWrap>&nbsp;</TD>
    <TD></TD>
    <TD class=lt0 onmouseover="mhHover('msviLocalToolbar', 16, 'lt1')" 
    onmouseout="mhHover('msviLocalToolbar', 16, 'lt0')" noWrap>&nbsp;</TD>
    <TD width="100%"></TD></TR></TBODY></TABLE></DIV></DIV></DIV>
<TABLE dir=ltr cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD id=CommonLeftColumn 
    style="BORDER-RIGHT: #999999 1px solid; OVERFLOW-X: hidden" width=181 
    bgColor=#f1f1f1 height="100%">
      <DIV class=mnpMenuTop id=mnpMenuTop>
      <DIV class=mnpInherit>
      <DIV class=CommonSidebarArea>
      <DIV class=CommonSidebarContent><A 
      href="http://blogs.msdn.com/default.aspx">Blogs Home</A> </DIV></DIV>
      <DIV class=CommonSidebarArea>
      <DIV class=CommonSidebarContent><A 
      id=ctl00___ctl00___ctl00_ctl00_AggWelcome___Login 
      href="http://blogs.msdn.com/login.aspx?ReturnUrl=%2fdancre%2farchive%2f2006%2f08%2f05%2f689542.aspx">Sign 
      in</A> | <A id=ctl00___ctl00___ctl00_ctl00_AggWelcome___Register 
      href="http://blogs.msdn.com/user/CreateUser.aspx?ReturnUrl=/dancre/archive/2006/08/05/689542.aspx">Join</A> 
      </DIV></DIV>
      <DIV class=CommonSidebarArea>
      <DIV class=CommonSidebarContent>
      <UL class=CommonSidebarList>
        <LI><A href="http://blogs.msdn.com/search/">Search</A> 
        <LI><A href="http://blogs.msdn.com/MainFeed.aspx?Type=AllBlogs">RSS</A> 
        <LI><A href="http://blogs.msdn.com/Opml.aspx">OPML</A> 
      </LI></UL></DIV></DIV></DIV></DIV>
      <DIV class=mnpAds 
      style="BACKGROUND: #f1f1f1; PADDING-BOTTOM: 20px; WIDTH: 181px; HEIGHT: 100%"></DIV></TD>
    <TD width="100%">
      <TABLE style="TABLE-LAYOUT: fixed" cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD width="100%">
            <DIV class=clsDocBody id=pageContainer>
            <DIV class=CommonContentArea>
            <H2 class=CommonTitle><A class=headermaintitle 
            id=ctl00___ctl00___ctl00_ctl00_bcr_bth___BlogTitle 
            href="http://blogs.msdn.com/dancre/default.aspx">Dan Crevier's 
            Blog</A></H2>
            <DIV class=CommonContent>In search of a better name...</DIV>
            <DIV class=CommonContent>
            <STYLE>.DoNotDisplay {
	DISPLAY: none
}
</STYLE>

            <DIV class=BlogPostArea>
            <H4 class=BlogPostHeader>DM-V-VM part 5: Commands <SPAN 
            id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___Ratings 
            title="Rated Excellent [5 out of 5 / rated 1 time(s)]."></SPAN><INPUT 
            id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___Ratings_Value 
            type=hidden value=5></H4>
            <DIV class=BlogPostContent>
            <P>In the previous posts, I've covered data models and how to make 
            data easily consumable by Avalon. Now, I want to start getting into 
            the view model side of things because I don't think it's clear what 
            I mean by them and I'm working up to an example.</P>
            <P>I want to start by talking about handling behavior in the UI. 
            Let's take a simple example. Say you have some UI that has a TextBox 
            and a Button that does some operation on that text. The standard way 
            you might do something like this with Xaml and code behind is 
            something like:</P>
            <DIV 
            style="FONT-SIZE: 11pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: consolas">
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&lt;</SPAN><SPAN 
            style="COLOR: maroon">Window</SPAN><SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">x:Class</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">CommandDemo.Window1</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">xmlns</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">http://schemas.microsoft.com/winfx/2006/xaml/presentation</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">xmlns:x</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">http://schemas.microsoft.com/winfx/2006/xaml</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">Title</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">CommandDemo</SPAN>"<SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">Height</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">300</SPAN>"<SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">Width</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">300</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &lt;</SPAN><SPAN style="COLOR: maroon">StackPanel</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp; &lt;</SPAN><SPAN style="COLOR: maroon">TextBox</SPAN><SPAN 
            style="COLOR: blue"> </SPAN><SPAN 
            style="COLOR: red">Name</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">_textBox</SPAN>"<SPAN 
            style="COLOR: blue">/&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp; &lt;</SPAN><SPAN style="COLOR: maroon">Button</SPAN><SPAN 
            style="COLOR: blue"> </SPAN><SPAN 
            style="COLOR: red">Name</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">_button</SPAN>"<SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">Click</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">OnButtonClick</SPAN>"<SPAN 
            style="COLOR: blue">&gt;</SPAN>Do something<SPAN 
            style="COLOR: blue">&lt;/</SPAN><SPAN 
            style="COLOR: maroon">Button</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &lt;/</SPAN><SPAN style="COLOR: maroon">StackPanel</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&lt;/</SPAN><SPAN 
            style="COLOR: maroon">Window</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P></DIV>
            <P>and the code behind:</P>
            <DIV 
            style="FONT-SIZE: 11pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: consolas">
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">namespace</SPAN> 
            CommandDemo</P>
            <P style="MARGIN: 0px">{</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">public</SPAN> <SPAN 
            style="COLOR: blue">partial</SPAN> <SPAN 
            style="COLOR: blue">class</SPAN> <SPAN 
            style="COLOR: teal">Window1</SPAN> : <SPAN 
            style="COLOR: teal">Window</SPAN></P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">public</SPAN> Window1()</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; InitializeComponent();</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">private</SPAN> <SPAN 
            style="COLOR: blue">void</SPAN> OnButtonClick(<SPAN 
            style="COLOR: blue">object</SPAN> sender, <SPAN 
            style="COLOR: teal">RoutedEventArgs</SPAN> e)</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">string</SPAN> text = 
            _textBox.Text;</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: green">// Do something with 
            text</SPAN></P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">}</P></DIV>
            <P>The Xaml specifies the function that should be called on click 
            and the code behind goes directly to the text box to get the text. 
            So, there's a fair amount of coupling between the Xaml and the code 
            behind. Now let's say you want the button to be disabled when the 
            TextBox is empty. You might have code behind that watches for the 
            text changing and enables/disables the button. That leads to more 
            coupling. Or, you could write a ValueConverter and bind the enabled 
            state to the text box text passed through the value converter.</P>
            <P>But, I want to get the behavior side of things out of the code 
            behind to clearly separate the behavior aspects from the styling. 
            This will make the behavior more unit testable and makes it easier 
            for designers to own the Xaml and developers to own the 
behavior.</P>
            <P>Let's start with a quick example of how to do this with 
            RoutedCommands. A button can be bound to an ICommand. ICommand lets 
            the button know when to be enabled and what to do when it's clicked. 
            RoutedCommand is an ICommand implementation that fires a routed 
            event looking for a CommandBinding definied on an element that 
            handles that command. One other thing that commands support is a 
            command parameter. Here's an example of how we can use a 
            RoutedCommand to handle the scenario above.</P>
            <P>First, the code behind:</P>
            <DIV 
            style="FONT-SIZE: 11pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: consolas">
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">public</SPAN> <SPAN 
            style="COLOR: blue">partial</SPAN> <SPAN 
            style="COLOR: blue">class</SPAN> <SPAN 
            style="COLOR: teal">Window1</SPAN> : <SPAN 
            style="COLOR: teal">Window</SPAN></P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">public</SPAN> Window1()</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; InitializeComponent();</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">this</SPAN>.CommandBindings.Add(<SPAN 
            style="COLOR: blue">new</SPAN> <SPAN 
            style="COLOR: teal">CommandBinding</SPAN>(<SPAN 
            style="COLOR: blue">this</SPAN>.MyCommand, OnExecute,</P>
            <P 
            style="MARGIN: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
            OnQueryCommandEnabled));</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">public</SPAN> <SPAN 
            style="COLOR: teal">RoutedCommand</SPAN> MyCommand</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">get</SPAN> { <SPAN 
            style="COLOR: blue">return</SPAN> _myCommand; }</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">private</SPAN> <SPAN 
            style="COLOR: blue">void</SPAN> OnQueryCommandEnabled(<SPAN 
            style="COLOR: blue">object</SPAN> sender, <SPAN 
            style="COLOR: teal">CanExecuteRoutedEventArgs</SPAN> e)</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; e.CanExecute = !<SPAN 
            style="COLOR: blue">string</SPAN>.IsNullOrEmpty(e.Parameter <SPAN 
            style="COLOR: blue">as</SPAN> <SPAN 
            style="COLOR: blue">string</SPAN>);</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; e.Handled = <SPAN 
            style="COLOR: blue">true</SPAN>;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: blue">private</SPAN> <SPAN 
            style="COLOR: blue">void</SPAN> OnExecute(<SPAN 
            style="COLOR: blue">object</SPAN> sender, <SPAN 
            style="COLOR: teal">ExecutedRoutedEventArgs</SPAN> e)</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: blue">string</SPAN> text = 
            e.Parameter <SPAN style="COLOR: blue">as</SPAN> <SPAN 
            style="COLOR: blue">string</SPAN>;</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; <SPAN style="COLOR: green">// Do something with 
            text</SPAN></P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
            <P style="MARGIN: 0px">&nbsp;</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN 
            style="COLOR: teal">RoutedCommand</SPAN> _myCommand = <SPAN 
            style="COLOR: blue">new</SPAN> <SPAN 
            style="COLOR: teal">RoutedCommand</SPAN>();</P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; }</P></DIV>
            <P>Note: We've removed any reference to specific UI elements from 
            the code behind! We set up a RoutedCommand and make it available 
            through a property. And, we've set up a binding pointing to query 
            enabled and execute functions. These functions get the string to 
            operate on through the command parameter.</P>
            <P>Now, here's the Xaml:</P>
            <DIV 
            style="FONT-SIZE: 11pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: consolas">
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&lt;</SPAN><SPAN 
            style="COLOR: maroon">Window</SPAN><SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">x:Class</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">CommandDemo.Window1</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">xmlns</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">http://schemas.microsoft.com/winfx/2006/xaml/presentation</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">xmlns:x</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">http://schemas.microsoft.com/winfx/2006/xaml</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">Title</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">CommandDemo</SPAN>"<SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">Height</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">300</SPAN>"<SPAN style="COLOR: blue"> 
            </SPAN><SPAN style="COLOR: red">Width</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">300</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            </SPAN><SPAN style="COLOR: red">DataContext</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN style="COLOR: blue">{Binding 
            RelativeSource={RelativeSource Self}}</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &lt;</SPAN><SPAN style="COLOR: maroon">StackPanel</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp; &lt;</SPAN><SPAN style="COLOR: maroon">TextBox</SPAN><SPAN 
            style="COLOR: blue"> </SPAN><SPAN 
            style="COLOR: red">Name</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">_textBox</SPAN>"<SPAN 
            style="COLOR: blue">/&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp; &lt;</SPAN><SPAN style="COLOR: maroon">Button</SPAN><SPAN 
            style="COLOR: blue"> </SPAN><SPAN 
            style="COLOR: red">Name</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN 
            style="COLOR: blue">_button</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; </SPAN><SPAN 
            style="COLOR: red">Command</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN style="COLOR: blue">{Binding 
            MyCommand}</SPAN>"</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; </SPAN><SPAN 
            style="COLOR: red">CommandParameter</SPAN><SPAN 
            style="COLOR: blue">=</SPAN>"<SPAN style="COLOR: blue">{Binding 
            Text, ElementName=_textBox}</SPAN>"<SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Do 
            something</P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &nbsp; &lt;/</SPAN><SPAN style="COLOR: maroon">Button</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&nbsp;&nbsp;&nbsp; 
            &lt;/</SPAN><SPAN style="COLOR: maroon">StackPanel</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P>
            <P style="MARGIN: 0px"><SPAN style="COLOR: blue">&lt;/</SPAN><SPAN 
            style="COLOR: maroon">Window</SPAN><SPAN 
            style="COLOR: blue">&gt;</SPAN></P></DIV>
            <P>One key thing I've done here is to set the DataContext of the 
            window to itself. That's what lets Command="{Binding MyCommand}" 
            work in the button. That binding is relative to the DataContext. It 
            sets up the command parameter by binding to the text in the text 
            box.</P>
            <P>With this version, the button's enabled state will change when 
            the text field changes. How does that work exactly? Well, ICommand 
            has a CanExecuteChanged event that the button registers for and 
            requeries the enabled state each time it fires. But, when does it 
            fire? With a RoutedCommand, it will fire on any input event. You can 
            also suggest that commands update by calling 
            CommandManager.InvalidateRequerySuggested. So, after each key press 
            or other input event, WPF will call OnQueryCommandEnabled.</P>
            <P>So, where are we? We've really cleaned things up from the 
            original version. The code behind no longer knows about any of the 
            UI elements in the Xaml. But, we can go further and completely 
            remove the command behavior from the code behind. That'll be my next 
            post!</P></DIV>
            <DIV class=BlogPostFooter>Published Saturday, August 05, 2006 8:49 
            AM by <A 
            id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___AuthorLink 
            href="http://blogs.msdn.com/user/Profile.aspx?UserID=3401">dancre</A> 

            <DIV><SPAN 
            id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel>Filed 
            under: <A 
            href="http://blogs.msdn.com/dancre/archive/tags/DM-V-VM/default.aspx" 
            rel=tag>DM-V-VM</A></SPAN><INPUT 
            id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___InlineTagEditorPanel_State 
            type=hidden value=nochange 
            name=ctl00$_$ctl00$_$ctl00$ctl00$bcr$ctl00$_$Entry$_$InlineTagEditorPanel></DIV></DIV></DIV>
            <DIV id=comments>
            <H3>Comments </H3>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl01_NameLink 
                  title="Marc Stevens">Marc Stevens</A> said:</H4>
                  <DIV class=CommentText>Quite interesting series … One comment 
                  though: <BR><BR>“One key thing I've done here is to set the 
                  DataContext of the window to itself.” <BR><BR>When reading 
                  this remark, I cannot help thinking that XAML’s DataContext 
                  concept should be duplicated into a ‘Business Layer 
                  DataContext’ and a ‘Presentation Layer Data Context’. Indeed, 
                  in a business application, the TextBox in your example will 
                  most likely be intrinsically ‘Business Layer’ (data context) 
                  bound. It looks to me that a conflict in 'data context usage' 
                  will arise. <BR><BR>There are indeed (quite many) other XAML 
                  example code cases where such a ‘conflict in data context 
                  addressing' is felt (at least in my opinion) when referring to 
                  the presentation layer and business layer. <BR><BR>Thanks for 
                  your reaction on this matter ... <BR><BR></DIV>
                  <DIV class=CommentFooter>August 10, 2006 6:47 AM </DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/avatar.jpg" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl02_NameLink 
                  title=bryant 
                  href="http://blogs.sqlxml.org/BryantLikes">bryant</A> 
                  said:</H4>
                  <DIV class=CommentText>I really appreciate this series. I'm 
                  working on a WPF application and there isn't much guidance out 
                  there. So I really like hearing your stories from the 
                  trenches. <BR><BR>Any chance of getting part six soon? 
:)</DIV>
                  <DIV class=CommentFooter>August 25, 2006 3:27 PM </DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="D:\LINKS\DM-V-VM\Dan Crevier's Blog  DM-V-VM part 5 Commands_files\avatar(1).jpg" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl03_NameLink 
                  title=Ivolved 
                  href="http://mbrownchicago.spaces.live.com/">Ivolved</A> 
                  said:</H4>
                  <DIV class=CommentText>Link to part 6 <A 
                  href="http://blogs.msdn.com/dancre/archive/2006/08/25/724938.aspx" 
                  target=_new 
                  rel=nofollow>http://blogs.msdn.com/dancre/archive/2006/08/25/724938.aspx</A></DIV>
                  <DIV class=CommentFooter>August 31, 2006 10:59 AM </DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl04_NameLink 
                  title=TrackBack 
                  href="http://blogs.msdn.com/dancre/archive/2006/09/15/756095.aspx" 
                  rel=nofollow>Dan Crevier's Blog</A> said:</H4>
                  <DIV class=CommentText>In part 5, I talked about commands and 
                  how they are used for behavior. Now, I want to talk about a 
                  better...</DIV>
                  <DIV class=CommentFooter>September 15, 2006 11:56 AM 
              </DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl05_NameLink 
                  title=TrackBack 
                  href="http://blogs.sqlxml.org/bryantlikes/archive/2006/09/27/WPF-Patterns.aspx" 
                  rel=nofollow>Bryant Likes's Blog</A> said:</H4>
                  <DIV class=CommentText>If you're doing WPF development, you 
                  really need to check out Dan Crevier 's series on 
                  DataModel-View-ViewModel.</DIV>
                  <DIV class=CommentFooter>September 27, 2006 4:31 PM 
              </DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl06_NameLink 
                  title=TrackBack 
                  href="http://blogs.msdn.com/dancre/archive/2006/09/15/dm-v-vm-part-7-encapsulating-commands.aspx" 
                  rel=nofollow>Dan Crevier's Blog</A> said:</H4>
                  <DIV class=CommentText>
                  <P>In part 5 , I talked about commands and how they are used 
                  for behavior. Now, I want to talk about a better</P></DIV>
                  <DIV class=CommentFooter>October 11, 2006 9:59 PM </DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl07_NameLink 
                  title=TrackBack 
                  href="http://blogs.msdn.com/dancre/archive/2006/10/11/datamodel-view-viewmodel-pattern-series.aspx" 
                  rel=nofollow>Dan Crevier's Blog</A> said:</H4>
                  <DIV class=CommentText>
                  <P>I thought I should add a post with the full list of posts 
                  in the D-V-VM pattern. They are: 
                  DataModel-View-ViewModel</P></DIV>
                  <DIV class=CommentFooter>October 11, 2006 10:00 PM 
</DIV></TD></TR>
              <TR vAlign=top>
                <TD class="Comment CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="Comment  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl08_NameLink 
                  title=Leo>Leo</A> said:</H4>
                  <DIV class=CommentText>
                  <P>Nice series.</P>
                  <P>Currently I am very interested in if the the button is not 
                  only bind to the Text of one TextBox but Text of more than two 
                  TextBoxes, say TextBoxUserName and TextBoxPassword, how can I 
                  apply Commands to the Login Button?</P>
                  <P>Thanks </P></DIV>
                  <DIV class=CommentFooter>October 17, 2006 12:45 AM 
</DIV></TD></TR>
              <TR vAlign=top>
                <TD class="CommentOwner CommentAvatar"><IMG 
                  src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/anonymous.gif" 
                  border=1>&nbsp; </TD>
                <TD class="CommentOwner  CommentContent" width="100%">
                  <H4 class=CommentTitle><A 
                  id=ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Comments___Comments_ctl09_NameLink 
                  title=dancre href="http://blogs.msdn.com/dancre">dancre</A> 
                  said:</H4>
                  <DIV class=CommentText>
                  <P>Unfortunately, I don't know a good way to do this without 
                  some code behind. If anyone has some ideas on this, let me 
                  know.</P></DIV>
                  <DIV class=CommentFooter>October 17, 2006 12:00 PM 
              </DIV></TD></TR></TBODY></TABLE></DIV><EM>New Comments to this post 
            are disabled</EM> </DIV></DIV></DIV></TD></TR></TBODY></TABLE></TD>
    <TD id=CommonRightColumn style="FONT-SIZE: 100%">
      <DIV class=CommonSidebar>
      <DIV id=BlogLinksSideBar>
      <DIV class=CommonSidebarArea>
      <H4 class=CommonSidebarHeader>This Blog</H4>
      <DIV class=CommonSidebarContent>
      <UL class=CommonSidebarList>
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___home 
        href="http://blogs.msdn.com/dancre/default.aspx">Home</A> 
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___Contactlink1 
        href="http://blogs.msdn.com/dancre/contact.aspx">Email</A> 
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___wl___LinkListLink1 
        href="http://blogs.msdn.com/dancre/linklist.aspx">Links</A> 
      </LI></UL></DIV></DIV></DIV>
      <DIV id=TasksSideBar></DIV>
      <DIV id=SubscriptionsSideBar>
      <DIV class=CommonSidebarArea>
      <H4 class=CommonSidebarHeader>Syndication</H4>
      <DIV class=CommonSidebarContent>
      <UL class=CommonSidebarList>
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___rss 
        href="http://blogs.msdn.com/dancre/rss.xml">RSS 2.0</A> 
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___bs___atom 
        href="http://blogs.msdn.com/dancre/atom.xml">Atom 1.0</A> 
      </LI></UL></DIV></DIV></DIV>
      <DIV id=RecentPostsSideBar>
      <DIV class=CommonSidebarArea>
      <H4 class=CommonSidebarHeader>Recent Posts</H4>
      <DIV class=CommonSidebarContent>
      <UL class=CommonSidebarList>
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl00_Link 
        href="http://blogs.msdn.com/dancre/archive/2007/10/11/more-skydrive-goodness.aspx">More 
        SkyDrive goodness</A> 
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl01_Link 
        href="http://blogs.msdn.com/dancre/archive/2007/08/22/frustrating-error-using-remote-desktop.aspx">Frustrating 
        error using Remote Desktop</A> 
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl02_Link 
        href="http://blogs.msdn.com/dancre/archive/2007/08/21/tafiti.aspx">Tafiti</A> 

        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl03_Link 
        href="http://blogs.msdn.com/dancre/archive/2007/08/09/windows-live-skydrive-spaces-integration.aspx">Windows 
        Live SkyDrive/Spaces integration</A> 
        <LI><A id=ctl00___ctl00___ctl00_ctl00_rcr_bsb___rp___PostList_ctl04_Link 
        href="http://blogs.msdn.com/dancre/archive/2007/08/09/windows-live-folders-is-now-windows-live-skydrive.aspx">Windows 
        Live Folders is now Windows Live SkyDrive!</A> 
</LI></UL></DIV></DIV></DIV>
      <DIV id=TagSideBar>
      <DIV class=CommonSidebarArea>
      <H4 class=CommonSidebarHeader>Tags</H4>
      <DIV class=CommonSidebarContent>
      <UL class=CommonSidebarTagCloud>
        <LI class=CommonTag3><A 
        href="http://blogs.msdn.com/dancre/archive/tags/ASP.NET/default.aspx" 
        rel=tag>ASP.NET</A> 
        <LI class=CommonTag6><A 
        href="http://blogs.msdn.com/dancre/archive/tags/Debugging/default.aspx" 
        rel=tag>Debugging</A> 
        <LI class=CommonTag1><A 
        href="http://blogs.msdn.com/dancre/archive/tags/DM-V-VM/default.aspx" 
        rel=tag>DM-V-VM</A> 
        <LI class=CommonTag1><A 
        href="http://blogs.msdn.com/dancre/archive/tags/Max/default.aspx" 
        rel=tag>Max</A> 
        <LI class=CommonTag6><A 
        href="http://blogs.msdn.com/dancre/archive/tags/PageModel/default.aspx" 
        rel=tag>PageModel</A> 
        <LI class=CommonTag4><A 
        href="http://blogs.msdn.com/dancre/archive/tags/PanelLayoutAnimator/default.aspx" 
        rel=tag>PanelLayoutAnimator</A> 
        <LI class=CommonTag2><A 
        href="http://blogs.msdn.com/dancre/archive/tags/pdc2005/default.aspx" 
        rel=tag>pdc2005</A> 
        <LI class=CommonTag4><A 
        href="http://blogs.msdn.com/dancre/archive/tags/Tips+_2600_amp_3B00_+Tricks/default.aspx" 
        rel=tag>Tips &amp; Tricks</A> 
        <LI class=CommonTag2><A 
        href="http://blogs.msdn.com/dancre/archive/tags/Utilities/default.aspx" 
        rel=tag>Utilities</A> 
        <LI class=CommonTag3><A 
        href="http://blogs.msdn.com/dancre/archive/tags/VirtualizingTilePanel/default.aspx" 
        rel=tag>VirtualizingTilePanel</A> 
        <LI class=CommonTag6><A 
        href="http://blogs.msdn.com/dancre/archive/tags/Vista/default.aspx" 
        rel=tag>Vista</A> 
        <LI class=CommonTag6><A 
        href="http://blogs.msdn.com/dancre/archive/tags/Web+Perf/default.aspx" 
        rel=tag>Web Perf</A> </LI></UL></DIV></DIV></DIV>
      <DIV id=NewsSideBar>
      <DIV class=CommonSidebarArea>
      <H4 class=CommonSidebarHeader>News</H4>
      <DIV class=CommonSidebarContent>The posts on this weblog are provided "AS 
      IS" with no warranties, and confer no rights. The opinions expressed 
      herein are my own personal opinions and do not represent my employer's 
      view in any way. </DIV></DIV></DIV>
      <DIV id=ArchiveSideBar>
      <DIV class=CommonSidebarArea>
      <H4 class=CommonSidebarHeader>Archives</H4>
      <DIV class=CommonSidebarContent>
      <UL class=CommonSidebarList>
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/10.aspx">October 
        2007 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/08.aspx">August 
        2007 (4)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/07.aspx">July 
        2007 (4)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/06.aspx">June 
        2007 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/03.aspx">March 
        2007 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/02.aspx">February 
        2007 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2007/01.aspx">January 
        2007 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/12.aspx">December 
        2006 (6)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/11.aspx">November 
        2006 (2)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/10.aspx">October 
        2006 (3)</A> 
        <LI><A 
        href="http://blogs.msdn.com/dancre/archive/2006/09.aspx">September 2006 
        (8)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/08.aspx">August 
        2006 (7)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/07.aspx">July 
        2006 (6)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/03.aspx">March 
        2006 (6)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/02.aspx">February 
        2006 (11)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2006/01.aspx">January 
        2006 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/12.aspx">December 
        2005 (2)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/11.aspx">November 
        2005 (1)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/10.aspx">October 
        2005 (3)</A> 
        <LI><A 
        href="http://blogs.msdn.com/dancre/archive/2005/09.aspx">September 2005 
        (7)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/06.aspx">June 
        2005 (6)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/05.aspx">May 2005 
        (11)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/04.aspx">April 
        2005 (3)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/02.aspx">February 
        2005 (3)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2005/01.aspx">January 
        2005 (3)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/12.aspx">December 
        2004 (15)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/11.aspx">November 
        2004 (4)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/10.aspx">October 
        2004 (10)</A> 
        <LI><A 
        href="http://blogs.msdn.com/dancre/archive/2004/09.aspx">September 2004 
        (8)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/08.aspx">August 
        2004 (8)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/07.aspx">July 
        2004 (5)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/06.aspx">June 
        2004 (5)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/05.aspx">May 2004 
        (13)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/04.aspx">April 
        2004 (15)</A> 
        <LI><A href="http://blogs.msdn.com/dancre/archive/2004/03.aspx">March 
        2004 (18)</A> </LI></UL></DIV></DIV></DIV></DIV></TD></TR></TBODY></TABLE><!--NOINDEX_START-->
<DIV id=CommonFooter><BR style="OVERFLOW: hidden; LINE-HEIGHT: 1px" clear=all>
<TABLE id=msviFooter cellSpacing=0 cellPadding=0 width="100%">
  <TBODY>
  <TR vAlign=bottom>
    <TD id=msviFooter2>
      <DIV id=msviLocalFooter><NOBR><A 
      href="http://go.microsoft.com/?linkid=317027">Manage Your Profile</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://msdn.microsoft.com/isapi/gomscom.asp?target=/legal/" 
      target=_parent>Legal</A> |</NOBR><WBR><NOBR><A 
      href="http://register.microsoft.com/contactus30/contactus.asp?domain=msdn" 
      target=_parent>Contact Us</A> |</NOBR><WBR><NOBR><A 
      href="http://msdn.microsoft.com/flash/" target=_parent>MSDN Flash 
      Newsletter</A></NOBR></DIV>
      <DIV id=msviGlobalFooter><SPAN>©2005 Microsoft Corporation. All rights 
      reserved.&nbsp;</SPAN><NOBR><A 
      href="http://www.microsoft.com/info/cpyright.mspx">Terms of Use</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://msdn.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</A> 
      |</NOBR><WBR><NOBR><A 
      href="http://www.microsoft.com/info/privacy.mspx">Privacy 
      Statement</A></NOBR></DIV></TD>
    <TD width=105 bgColor=#669aff><IMG title="" height=29 alt=Microsoft 
      src="Dan Crevier's Blog  DM-V-VM part 5 Commands_files/bottomMSFTLogo.jpg" 
      width=105 border=0></TD></TR></TBODY></TABLE></DIV></DIV>
<SCRIPT language=javascript>var ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___Ratings=new RateControl('ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___Ratings','ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___Ratings','ctl00___ctl00___ctl00_ctl00_bcr_ctl00___Entry___Ratings_Value', 5, '/Themes/default/images/common/', false, 'CommonRateControl','CommonRateControlActive','CommonRateControlReadOnly',['Terrible','Poor','Fair','Average','Good','Excellent'],true,true);</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/dancre/archive/2006/08/05/dm-v-vm-part-5-commands.aspx"
dc:identifier="http://blogs.msdn.com/dancre/archive/2006/08/05/dm-v-vm-part-5-commands.aspx"
dc:title="DM-V-VM part 5: Commands"
trackback:ping="http://blogs.msdn.com/dancre/trackback.aspx?PostID=689542" />
</rdf:RDF>
--></FORM></BODY></HTML>
