<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>POKE 53280,0: Pete Brown's Blog : UserControls as Screens in Silverlight 1.1 - Part 2 of 2</title>
 




<meta name="keywords" content=".NET,User Experience (UX),Silverlight,Remix07Boston">
<meta name="description" content="In Part 1 , I outlined how we handled screen management in the Silverlight 1.1 Carbon Calculator. In Part 2, I&amp;#39;ll present a basic framework for handling similar screen management in your own Silverlight applications. If you haven&amp;#39;t yet read Part">
<meta name="GENERATOR" content="CommunityServer 2.1 (Build: 60809.935)">
<link rel="pingback" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/pingback.aspx">
<link rel="stylesheet" href="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/style.css" type="text/css" media="screen">
<link rel="stylesheet" href="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/print.css" type="text/css" media="print">
<link rel="stylesheet" href="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/fall.css" type="text/css" media="screen">
<link rel="shortcut icon" type="image/ico" href="http://community.irritatedvowel.com/favicon.ico">
<link rel="alternate" type="application/rss+xml" title="POKE 53280,0: Pete Brown's Blog (RSS 2.0)" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/rss.aspx">
<link rel="alternate" type="application/atom+xml" title="POKE 53280,0: Pete Brown's Blog (Atom 1.0)" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/atom.aspx">
<link rel="alternate" type="application/rss+xml" title="UserControls as Screens in Silverlight 1.1 - Part 2 of 2  Comment RSS (RSS 2.0)" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/commentrss.aspx?PostID=1368">

	<script src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/global.js" type="text/javascript"></script></head><body>
<form name="aspnetForm" method="post" action="/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="aspnetForm">
<div>
<input name="__EVENTTARGET" id="__EVENTTARGET" value="" type="hidden">
<input name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" type="hidden">
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgIFH2N0bDAwJF8kY3RsMDAkXyRzd3MkXyRTZWFyY2hCb3gFKmN0bDAwJF8kY3RsMDAkXyRjdGwwMiRfJGZvcm0kXyRjaGtSZW1lbWJlcnehKasvFGArvEzmeRH8U+mm8txm" type="hidden">
</div>

<script type="text/javascript">
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script>


<script src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/WebResource_002.js" type="text/javascript"></script>


<script src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/WebResource.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</script>


<div id="masthead">
	<div id="userArea">
		
			<div id="welcome" align="right">
				
						Welcome to irritatedVowel.com
<a id="ctl00___ctl00___duw1_ac1___Login" href="http://community.irritatedvowel.com/login.aspx?ReturnUrl=%2fblogs%2fpete_browns_blog%2farchive%2f2007%2f10%2f16%2fUserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx">Sign in</a>



					
				 |  <a id="ctl00___ctl00___duw1_Faq1" href="http://community.irritatedvowel.com/languages/en-US/docs/faq.aspx">Help</a>
			</div>
		
		
		
	
<div id="Search" align="right">
	<table border="0" cellpadding="0" cellspacing="0">
	<tbody><tr><td>
		<input name="ctl00$_$ctl00$_$sws$_$SearchBox" id="ctl00___ctl00___sws___SearchBox" class="searchBox" onkeydown="KeyDownHandlerctl00___ctl00___sws___SearchButton(event);" type="text"> 
	</td><td>
		<span class="SearchButtonOuter"><a id="ctl00___ctl00___sws___SearchButton" class="SearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$sws$_$SearchButton','')">Search</a></span>
	</td></tr>
	</tbody></table>
</div>
	 
	</div>
	<div id="title">
		

<h1><a id="ctl00___ctl00___bt___BlogTitle" class="headermaintitle" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/default.aspx">POKE 53280,0: Pete Brown's Blog</a></h1>
<div class="headersubtitle">Silverlight, WPF, Woodworking, .NET Programming, CNC, Nature, and other topics.</div>


	</div>	
</div>
<div id="nav">
	<div id="navbar">
		<ul>
			<li><a id="ctl00___ctl00___Homelink1" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/default.aspx">Home</a></li>
			<li><a id="ctl00___ctl00___Contactlink1" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/contact.aspx">Email</a></li>
			<li><a id="ctl00___ctl00___Aboutlink1" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/about.aspx">About</a></li>
			<li><a id="ctl00___ctl00___rss" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/rss.aspx">RSS 2.0</a></li>
			<li><a id="ctl00___ctl00___atom" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/atom.aspx">Atom 1.0</a></li>
			
		</ul>
	</div>
</div>
<div id="content">
	<div id="leftmenu">
		

<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/pmb_blog_avatar.png" alt="Pete Brown's Blog">
<p style="font-size: 8pt; color: Gray;">Pete Brown writes on a number
of topics including Silverlight, WPF, .NET, woodworking and working as
a consultant in the DC area. On most forums, Pete goes by the name
Psychlist1972.</p>

<div id="TagSideBar">
<h3>Tags</h3>
<ul class="SidebarTagCloud">
<li class="Tag1"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/.NET/default.aspx" rel="tag">.NET</a></li>
<li class="Tag6"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/3d/default.aspx" rel="tag">3d</a></li>
<li class="Tag6"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Demoscene/default.aspx" rel="tag">Demoscene</a></li>
<li class="Tag4"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Digital+Home/default.aspx" rel="tag">Digital Home</a></li>
<li class="Tag3"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Events/default.aspx" rel="tag">Events</a></li>
<li class="Tag5"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/FIOS/default.aspx" rel="tag">FIOS</a></li>
<li class="Tag2"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/General/default.aspx" rel="tag">General</a></li>
<li class="Tag6"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Health/default.aspx" rel="tag">Health</a></li>
<li class="Tag2"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Hobbies/default.aspx" rel="tag">Hobbies</a></li>
<li class="Tag1"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Home+Renovation/default.aspx" rel="tag">Home Renovation</a></li>
<li class="Tag3"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/MIX06/default.aspx" rel="tag">MIX06</a></li>
<li class="Tag4"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/MIX07/default.aspx" rel="tag">MIX07</a></li>
<li class="Tag5"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/MOSS+and+WSS/default.aspx" rel="tag">MOSS and WSS</a></li>
<li class="Tag4"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/PDC+2005/default.aspx" rel="tag">PDC 2005</a></li>
<li class="Tag2"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Pregnancy+and+Baby/default.aspx" rel="tag">Pregnancy and Baby</a></li>
<li class="Tag3"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Remix07Boston/default.aspx" rel="tag">Remix07Boston</a></li>
<li class="Tag1"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Silverlight/default.aspx" rel="tag">Silverlight</a></li>
<li class="Tag5"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/SilverlightDevCampDC/default.aspx" rel="tag">SilverlightDevCampDC</a></li>
<li class="Tag6"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/UMPC/default.aspx" rel="tag">UMPC</a></li>
<li class="Tag1"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/User+Experience+_2800_UX_2900_/default.aspx" rel="tag">User Experience (UX)</a></li>
<li class="Tag4"><a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/WPF/default.aspx" rel="tag">WPF</a></li>
</ul>

</div>


<div>
	<a href="http://www.silverlight.net/" target="_blank"><img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/silverlight_logo_small.png" border="0"></a>
</div>

<div id="RecentPostsSideBar">

	
<h3>Recent Posts</h3>	
<ul>
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl01_Link" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/11/05/The-_2200_P_2200_-in-WPF.aspx">The "P" in WPF</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl02_Link" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/11/05/More-Photos-from-Silverlight-DevCamp-DC.aspx">More Photos from Silverlight DevCamp DC</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl03_Link" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/11/04/Silverlight-Dev-Camp-DC-Slides.aspx">Silverlight Dev Camp DC Slides</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl04_Link" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/11/03/Links-from-Silverlight-Dev-Camp-DC.aspx">Links from Silverlight Dev Camp DC</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl05_Link" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/11/03/Photos-from-Silverlight-Dev-Camp-DC.aspx">Photos from Silverlight Dev Camp DC</a></li>
    </ul>
    
	

</div>



<div id="WorldMapSideBar">
	<h3>World Domination</h3>

	<a href="http://www.structuretoobig.com/WorldMap.aspx?userid=e3255f4f-989b-412e-a2a3-1325a88744a1" target="_blank">
        	<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/getmap.png" border="0">
	</a>					    

</div>


 
<div id="ArchiveSideBar">

	
<h3>Archives</h3>
<ul>

        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/11.aspx">November 2007 (6)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10.aspx">October 2007 (27)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/09.aspx">September 2007 (14)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/08.aspx">August 2007 (11)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/07.aspx">July 2007 (12)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/06.aspx">June 2007 (15)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/05.aspx">May 2007 (13)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/04.aspx">April 2007 (10)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/03.aspx">March 2007 (7)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/02.aspx">February 2007 (1)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/01.aspx">January 2007 (2)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/11.aspx">November 2006 (3)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/10.aspx">October 2006 (5)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/09.aspx">September 2006 (1)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/08.aspx">August 2006 (1)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/07.aspx">July 2006 (6)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/06.aspx">June 2006 (9)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/05.aspx">May 2006 (8)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/04.aspx">April 2006 (6)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/03.aspx">March 2006 (18)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/02.aspx">February 2006 (4)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2006/01.aspx">January 2006 (10)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2005/12.aspx">December 2005 (2)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2005/11.aspx">November 2005 (12)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2005/10.aspx">October 2005 (12)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2005/09.aspx">September 2005 (20)</a>
        </li>
    
        <li>
            <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2005/08.aspx">August 2005 (13)</a>
        </li>
    
</ul>
	
</div>

<div id="AddThis">
			<!-- AddThis Bookmark Button BEGIN -->
			<a href="http://www.addthis.com/bookmark.php" onclick="addthis_url   = location.href; addthis_title = document.title; return addthis_click(this);" target="_blank"><img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/button1-bm.gif" alt="AddThis Social Bookmark Button" border="0" height="16" width="125"></a>
			<script type="text/javascript">var addthis_pub = 'T2HYKEWY6SW8A5T5';</script>
			<script type="text/javascript" src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/widget.php"></script>
			<!-- AddThis Bookmark Button END -->

</div>

<div id="NavSideBar">
<h3>Navigation</h3>

	
<div id="headertab">
<ul>
		
				 <li><a id="ctl00___ctl00___bs___nm___Menu_ctl00_MenuItem" href="http://community.irritatedvowel.com/">Home</a></li>
			
				 <li><a id="ctl00___ctl00___bs___nm___Menu_ctl01_MenuItem" href="http://community.irritatedvowel.com/blogs/default.aspx">Blogs</a></li>
			
				 <li><a id="ctl00___ctl00___bs___nm___Menu_ctl02_MenuItem" href="http://community.irritatedvowel.com/photos/default.aspx">Photos</a></li>
			
	</ul>
</div>

	
</div>

<!--
<div id ="LinkSideBar">

        <h3>Blogs I Read</h3>
        <ul>
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl01_Link" href="http://weblogs.asp.net/scottgu/">ScottGu</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl02_Link" href="http://www.nikhilk.net/Category.aspx?id=1">Nikhil Kothari</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl03_Link" href="http://blogs.msdn.com/kaevans/default.aspx">Kirk Allen Evans</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl04_Link" href="http://blogs.msdn.com/ie/default.aspx">IE</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl05_Link" href="http://blogs.msdn.com/gsnowman/default.aspx">.NET Banana</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl06_Link" href="http://www.dilbert.com/">Dilbert</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl07_Link" href="http://blogs.msdn.com/somasegar">Somasegar's .NET Blog</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl08_Link" href="http://fortes.com/daily">Filipe Fortes</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl09_Link" href="http://blogs.msdn.com/bclteam/default.aspx">.NET BCL Team</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl10_Link" href="http://spaces.msn.com/members/manodesign/">Manuel Clement's Space</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl11_Link" href="http://www.notstatic.com">Robert Ingebretsen</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl12_Link" rel="co-worker" title="Frank's World (Frank La Vigne)" href="http://franksworld.com/blog/">Frank La Vigne</a></li>
            </ul>
    
        <h3>Events</h3>
        <ul>
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl01_Link" href="http://www.PAFOX.org">2007-11-01 - PAFOX - Intro to Silverlight</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl02_Link" href="http://www.remix07boston.com">2007-10-09 - Microsoft Remix Boston - Real World Silverlight</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl03_Link" href="http://www.barcamp.org/SilverlightDevCampDC">2007-11-03 - Silverlight DevCamp DC - Real World Silverlight</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl04_Link" href="http://www.cmap-online.org">2007-11-06 - CMAP - Extension Methods</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl05_Link" href="http://www.cmap-online.org">2007-10-02 - CMAP - Real-world Silverlight</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl06_Link" href="http://www.baltomsdn.com/DesktopDefault.aspx">2007-09-19 - BaltoMSDN - Introduction to Silverlight</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl07_Link" href="http://www.cmap-online.org">2007-07-03 - CMAP - Silverlight Carbon Calculator</a></li>
            </ul>
    
        <h3>irritatedVowel.com</h3>
        <ul>
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl01_Link" href="http://www.irritatedVowel.com">irritatedVowel Main Page</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl02_Link" href="http://www.irritatedVowel.com/Guestbook/">irritatedVowel.com Guestbook</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl03_Link" href="http://www.irritatedvowel.com/Wallpaper/Thumbnails.aspx?Category=57ff92e3-b57d-438a-b3ba-1d9d2fe5ec66">Geek Desktop Wallpaper</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl04_Link" href="http://www.irritatedvowel.com/Railroad/Layout/Trackplan/Trackplan.aspx">My Model Railroad</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl05_Link" href="http://www.irritatedvowel.com/Railroad/Workshop/CNCAndCasting.aspx">CNC and Resin Casting</a></li>
            </ul>
    

	
</div>
-->


	</div>
	<div id="main">
		
			

<div class="post">
	<h5 class="posthead pageTitle">UserControls as Screens in Silverlight 1.1 - Part 2 of 2  </h5>
	<p>In <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/12/UserControls-as-Screens-in-Silverlight-1.1.aspx" target="_blank">Part 1</a>,
I outlined how we&nbsp;handled&nbsp;screen management in the
Silverlight 1.1 Carbon Calculator. In Part 2, I'll present a basic
framework for handling similar screen management in your own
Silverlight applications. If you haven't yet read Part 1, please do so,
as it presents the basics we're building upon here.</p><p>Links for the
demo application and the source code are both posted at the end of this
article. For all images, click the thumbnails for larger versions.</p><p>The
pattern illustrated here provides a way to simulate windows in what is
inherently a non-windowed system: the Silverlight plug-in running
inside the browser. While I may toss around words like framework, what
I have here isn't necessarily a framework to be used as-is, but it is
an implementation of a pattern you may find useful in your own
Silverlight applications. Feel free to take the code and adjust as you
see fit.</p><p>Before we start, if you have Silverlight 1.1 installed,
you may want to run the demo first, to get a feel for how it operates.
You can run the demo <a href="http://www.irritatedvowel.com/Silverlight/UserControlScreens/" target="_blank">from my site here</a>.&nbsp;</p><p>&nbsp;</p><p><strong><u>Basics</u></strong></p><p>As
is typical in a Silverlight application, it all starts with Page.xaml.
Atypically, however, Page does next to nothing in this application.
Instead, Page instantiates MainScreen which is the first screen in the
application to follow the UserControl-as-screen pattern. The downside
of that is the vast majority of the application has to resolve control
names using FindName, but I explained some ways to ease that pain in
Part 1.</p><p>MainScreen hosts on it a couple&nbsp;buttons and some
hidden screens. Those screens are shown or hidden based upon which
buttons the user clicks. While I could have put those all directly on
Page, having a MainScreen like I do here allows me to animate the main
screen the same way I do all the others.</p><p>Unlike a true windowing
system, everything here exists in the same screen space, so you have to
understand zorder and&nbsp;the natural placement of xaml elements so
that, for example, your dialog box doesn't display underneath the
caption for something on your main screen. Luckily, this is pretty
simple to do as long as you don't muck around with&nbsp;z-order early
in the process.&nbsp;Simply put things in the order they should be on
the visual stack with the items most on top listed last in the xaml
file (the xaml processor puts them in in the order it reads them so
last=on top)</p><p>If you do mess with z-order, do so understanding
you'll probably lose a lot of hair in the process. At least in the
earlier versions of 1.1, z-order didn't work quite correctly, and it
caused all sorts of issues. My main recommendation here is to establish
a range of zorders to be used for each "layer" in the application, and
stick to those numbers; that will make it easier for you to manage.</p><p><strong><u>Class Model</u></strong></p><p>Since
I wrote this demo from scratch, I took the opportunity to refactor a
bit and use more intuitive (no baggage) class names. The class diagram
follows below.</p><p>&nbsp;<a href="http://www.irritatedvowel.com/pub/blog/pmb_usercontrol_screens_class_diagram.jpg" target="_blank"><img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/pmb_usercontrol_screens_class_diagram_thumb.jpg" style="width: 350px; height: 183px;" border="0" height="183" width="350"></a></p><p>Whereas
Part 1 presented ControlBaseEx for the primary base class, I simplified
that here to ControlBase. I also refactored the wizard functionality
into a separate set of classes rather than roll it all into the main
screen base class. In the end, I think you'll find the code easier to
follow. While the code is pretty self-explanitory, here are the
descriptions of the main classes:</p><p><strong><u>ControlBase</u></strong></p><p>This is the root class from which all my controls and screens derive. It has three things we're interested in:</p><p><strong>LoadXaml()</strong>
- This function wraps the ugliness that comes with the usercontrol
template by default. It also handles assigning the RootElement needed
for FindByName</p><p><strong>RootElement</strong> - This is the element
returned from InitializeFromXaml. You need this to do any FindName-type
name resolution as calling FindName on the control itself will not
return what you are looking for. (it took me a while to figure this out
on the Carbon Calculator project)</p><p><strong>FindByName</strong> -
As mentioned in Part 1, FindByName cleans up the FindName functionality
a bit, automatically going agains the correct root element and
returning a strongly-typed reference to the element.</p><p><strong><u>ScreenBase</u></strong>&nbsp;</p><p>The
primary class upon which the basic screens build is ScreenBase.
ScreenBase includes a number of useful functions with Show() and Hide()
being the most important.</p><p><strong>Show()</strong> handles
displaying a window on the screen. Since this calls out to an animation
with a known name (the constant in this file), the way the window is
shown can be almost anything from a simple display to rolling in from
the side of the screen while zooming in and out and varying opacity. Of
course, that may make the user cry out for Dramamine and ginger root,
but I'm not concerned about that here :)</p><p><strong>Hide()</strong>
does the opposite of show. Like Show, if an animation with a known name
exists, if will use that to hide the screen. Otherwise, it will just
set the screen to Visiblity.Collapsed.</p><p>&nbsp;</p><p><strong><u>Basic Screens</u></strong></p><p>Basic
screens, like MainScreen.* are the foundation upon which we build these
types of applications. While I used one only for the root screen here,
one could use them for any number of other screens in a typical
application.</p><p>Keep in mind that screens need not be rectangular.
You could use this pattern to implement simple scene management
functionality to keep the application components encapsulated when
using very fluid screens with complately non-rectangular shapes.</p><p>&nbsp;</p><p><strong><u>Wizard Pages</u></strong></p><p>Like
most people with a Windows Forms (and VB3-6) background, I&nbsp;have
have written countless wizards over the years. For this Silverlight
example, I whipped up a very simplified version of the pattern I
followed in those wizards.</p><p>The wizard itself controls the
navigation from page to page. Each page, however, controls whether or
not it allows moving forward or moving backwards, typically based upon
its position in the chain and whether or not the data entered on that
page is valid.</p><p><a href="http://www.irritatedvowel.com/pub/blog/pmb_usercontrol_screens_wizard_screenshot.jpg" target="_blank"><img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/pmb_usercontrol_screens_wizard_screenshot_thumb.jpg" style="width: 350px; height: 264px;" border="0" height="264" width="350"></a></p><p>When
you get into more complex wizards (with multiple brances, and the
ability to skip around based on user entries) I'll typically have a
navigation graph/tree at the controller page level and handle all
navigation through it. In that case, each page will simply implement an
IsValid method to let you know if the page data is ok or not.</p><p>When
storing data for the wizards, a publically-accessible class (typically
a singleton) is the easiest way. Each page of the wizard will then plug
its values into the wizard pages.</p><p>In the carbon calculator, we
did basically that. Steve wrote the data and calculation classes and I
wrote the singleton state manager which maintained the application
state. The wizards simply get/set data in those classes via the state
manager.</p><p>There are lots of different ways to handle wizard
management. Feel free to implement your own patterns directly on top of
the usercontrol screen framework presented here.</p><p>&nbsp;</p><p><strong><u>Modal Windows</u></strong></p><p>Modal
windows (dialog and message boxes in standard Windows applications) are
a special type of window which blocks all other processing until the
user takes an action to close the window. To simulate the most
important part of this behavior: disallowing clicking on anything
outside of this window, I use a screen-covering canvas to absorb the
clicks and visually darken the rest of the Silverlight control. Ideally
you'll make your covering some variant on the primary background color
from your main screen. In the Carbon Calculator, that was white; in
this example, it is black.</p><p><a href="http://www.irritatedvowel.com/pub/blog/pmb_usercontrol_screens_dialog_screenshot.jpg" target="_blank"><img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/pmb_usercontrol_screens_dialog_screenshot_thumb.jpg" style="width: 350px; height: 264px;" border="0" height="264" width="350"></a>&nbsp;</p><p>Hey, dig those enormous touchscreen-friendly buttons :)</p><p>The
"modal" window here has a DialogResult just like real modal windows.
Interestingly enough, Microsoft left the DialogResult enum in
System.Windows.Controls for Silverlight. I simply re-used it here.</p><p>Like
the other windows, one simply uses the .Show() method to display the
dialog. Unlike standard Windows modal dialogs, the .Show() method
immediately returns, so you need an event handler to capture the dialog
result once the user closes the window. The code you use to retrieve
the dialog result looks like this:</p><pre style="font-family: courier;">   // Raised when the dialog hide animation has completed
   void _exampleDialogScreen_Closed(object sender, EventArgs e)
   {
       // Operate on the selection made in that window
       if (_exampleDialogScreen.DialogResult == DialogResult.OK)
       {
           _messages.Text = "You clicked \"OK\"";
       }
       else
       {
           _messages.Text = "You cancelled the dialog.";
       }
   }</pre><pre style="font-family: courier;"></pre><p><strong><u>Debugging Tip</u></strong></p><p>One
main debugging tip to offer you when you build your own extensions to
this: put exception handlers in your constructors. I usually put
exception handlers in there with a break point on the catch statement
(or you can set the compiler to break on all exceptions). The reason is
that exceptions in the usercontrol constructors show up as XAML Parser
errors further up the stack. The deeper you nest your screens and
controls, the harder it will be for you to find problems.</p><p>&nbsp;</p><p><strong><u>Wrap-Up</u></strong></p><p>You can run the demo <a href="http://www.irritatedvowel.com/Silverlight/UserControlScreens/" target="_blank">from my site here</a>.&nbsp;</p><p>The Silverlight 1.1 September Refresh version of the <a href="http://www.irritatedvowel.com/pub/blog/PeteBrown.UserControlScreens.zip">source code may be found here</a>.
You'll need Visual Studio 2008 Beta 2 to compile it. In the code I have
included a sample button, a sample dialog box, and a sample wizard. The
base classes are all also present.</p><p>There is a lot more that you
can do with this&nbsp;pattern to make a true&nbsp;and robust windowing
system in Silverlight, especially around handling modal windows and
handling reuse/dynamic instantiation of multiple instances of a single
window. If Microsoft doesn't provide a windowing system in the release
of 1.1 (most RIAs can&nbsp;function well&nbsp;without one), I'll
revisit this project and make it into something serious.</p><p>If you
have any questions or ideas for this, please post a comment right to
this post. I'd love to get other ideas on how you might be interested
in using a pattern such as this.</p>
<div class="shareblock"><strong>Share this post:</strong> <a title="Email UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+" href="mailto:?body=Thought%20you%20might%20like%20this:%20http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx&amp;subject=UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+">Email it!</a> | <a href="http://del.icio.us/post?url=http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx&amp;title=UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+" title="Submit UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+ to del.icio.us">bookmark it!</a> | <a href="http://www.digg.com/submit?url=http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx&amp;phase=2" title="Submit UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+ to digg.com">digg it!</a> | <a href="http://reddit.com/submit?url=http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx&amp;title=UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+" title="Submit UserControls+as+Screens+in+Silverlight+1.1+-+Part+2+of+2+ to reddit.com">reddit!</a></div>
	<div class="postfoot">
		<span class="em">Posted:</span> Tuesday, October 16, 2007 6:47 PM
		by
		<a id="ctl00___ctl00___ctl02___Entry___AuthorLink" href="http://community.irritatedvowel.com/user/Profile.aspx?UserID=2112">Psychlist1972</a>
		
		<div><span id="ctl00___ctl00___ctl02___Entry___InlineTagEditorPanel">Filed under: <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/.NET/default.aspx" rel="tag">.NET</a>, <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/User+Experience+_2800_UX_2900_/default.aspx" rel="tag">User Experience (UX)</a>, <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Silverlight/default.aspx" rel="tag">Silverlight</a>, <a href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/tags/Remix07Boston/default.aspx" rel="tag">Remix07Boston</a></span><input name="ctl00$_$ctl00$_$ctl02$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl02___Entry___InlineTagEditorPanel_State" value="nochange" type="hidden"></div>
		
	</div>
</div>            


<div id="comments">
	<h2>
	Comments
</h2>
	
		<div class="CommentArea">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl00_NameLink" rel="nofollow" title="TrackBack" href="http://community.irritatedvowel.com/utility/Redirect.aspx?U=http%3a%2f%2finq.net%2farchive%2f2007%2f10%2f18%2flink-listing---october-17-2007.aspx">Christopher Steen</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3">Link Listing - October 17, 2007</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl00_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1376">#</a> October 18, 2007 4:02 AM </div>
		</div>
	
		<div class="CommentArea">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl01_NameLink" rel="nofollow" title="TrackBack" href="http://community.irritatedvowel.com/utility/Redirect.aspx?U=http%3a%2f%2fdotnetjunkies.com%2fWebLog%2fcsteen%2farchive%2f2007%2f10%2f18%2f339500.aspx">Christopher Steen</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3">Modular schemas, include, and tooling support [Via: Anil John ] The Seven Deadly Sins of SOA [Via:...</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl01_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1377">#</a> October 18, 2007 4:04 AM </div>
		</div>
	
		<div class="CommentArea">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl02_NameLink" title="Emari2">Emari2</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3">Marktap
sent me here from
http://silverlight.net/forums/p/5903/18073.aspx#18073
I am impressed!. For years I have been programming in visual basic with
MDI for everything and I tried to do the same with Xaml+Silverlight
(well, to see if it was possible, so my questions in the forums).
I need to update my mind. Your information is genial.I will do a hard
effort to translate all your C# to Basic (.net as the last)as it was my
language since 1981 with my first Sharp MZ80 computer.Keep on going. I
guess I need time even when I do not have all that but I'll follow your
lessons.How do you fit Blend in all of this?. Thanks</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl02_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1394">#</a> October 21, 2007 9:07 AM </div>
		</div>
	
		<div class="CommentAreaOwner">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl03_NameLink" title="Psychlist1972" href="http://community.irritatedvowel.com/user/Profile.aspx?UserID=2112">Psychlist1972</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3"><p>Hi Emari2</p>
<p>I presented on the usercontrol as screens pattern back in 1999 at a
Microsoft conference in DC. The language at the time was VB5/6. If I
can find the samples from way back then, I'll let you know. The pattern
is the same although it would be interesting to see what I have
unknowingly changed since then.</p>
</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl03_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1397">#</a> October 21, 2007 12:22 PM </div>
		</div>
	
		<div class="CommentArea">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl04_NameLink" title="Emari2">Emari2</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3">I have an error 
 Protected Sub LoadXaml(ByVal xamlResourceName As String)
        Try

            Dim s As System.IO.Stream = Me.GetType().Assembly.GetManifestResourceStream(xamlResourceName)
            Stop
            _rootElement = Me.InitializeFromXaml(New System.IO.StreamReader(s).ReadToEnd())

        Catch ex As Exception
            Stop
            System.Diagnostics.Debug.WriteLine(ex.ToString())
            Throw
        End Try

    End Sub
in _rootelement=Me.nitializeFromXaml
 that supose do not let to show the mainstreen page </div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl04_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1402">#</a> October 22, 2007 4:31 PM </div>
		</div>
	
		<div class="CommentAreaOwner">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl05_NameLink" title="Psychlist1972" href="http://community.irritatedvowel.com/user/Profile.aspx?UserID=2112">Psychlist1972</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3"><p>Hi Emari2</p>
<p>I see this is your translated version of the code, so it could be anything.</p>
<p>However, an error in InitializeFromXaml typically means either an
exception was thrown from the constructor of an object that was on that
usercontrol (put try/catch in each constructor and a breakpoint in the
catch to see the exception, or just break on all errors), or the xaml
itself was bad. Since you are translating the code from C# to VB, I'm
going to assume the former. </p>
</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl05_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1403">#</a> October 22, 2007 5:30 PM </div>
		</div>
	
		<div class="CommentArea">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl06_NameLink" title="Emari2 (Emilio)">Emari2 (Emilio)</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3">Hi,
I arrive well to this subrutine
protected void LoadXaml(string xamlResourceName)
…….
When I execute your code I found the following
Value of s={System.IO.UnmanedMemoryStream}
Value of xamlResourceName=”PeteBrown.UsercontrolScreens.Screen.Mainscreen.Xaml”

When I execute my code
Dim s as System.IO.Stream=Me.GetType.Assembly.GetManifestResourceStream(xamlResourceName)
Value of s = nothing
Value of xamlResourceName=”PeteBrown.UsercontrolScreens.Mainscreen.Xaml”
(I did not make the screen folder)
Unfortunately I do not know how to get the right value of s in Visual Basic.
Note. I needed to change the Mainstreen() for New() to get the LoadXaml.
</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl06_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1405">#</a> October 23, 2007 3:26 PM </div>
		</div>
	
		<div class="CommentAreaOwner">
			<h4 class="CommentTitle">
				<a id="ctl00___ctl00___ctl02___Comments___Comments_ctl07_NameLink" title="Psychlist1972" href="http://community.irritatedvowel.com/user/Profile.aspx?UserID=2112">Psychlist1972</a> 
				said:
				<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/spacer.gif" class="CommentArrow" align="absbottom">
			</h4>
			<div class="CommentText">
				<div class="CommentText2">
					<div class="CommentText3"><p>I
think the main problem you're running into is VB's (annoying, IMHO)
method of dealing with the namespace. In your project property pages,
there will be a property named something like "Root Namespace" and will
have the full project name stuffed in there. Make sure that is only the
root name.</p>
<p>Then, change the namespace declarations in code to only have the
additional part (for example just "Screens" instead of
"PeteBrown.UserControlScreens.Screens" assuming the root namespace is
set to "PeteBrown.UserControlScreens".</p>
<p>If that doesn't work, send me the latest version of your translated
code and I'll take a stab at it. I should have some time later this
evening.</p>
<p>Pete</p>
</div>
				</div>
			</div>
			<div class="CommentFooter"><a id="ctl00___ctl00___ctl02___Comments___Comments_ctl07_PermaLink" title="permalink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx#1406">#</a> October 23, 2007 3:57 PM </div>
		</div>
	
</div>

	


	
<fieldset id="commentform">
<legend>Leave a Comment</legend>

	<p>
    </p><div><label for="ctl00___ctl00___ctl02___form___tbTitle">Title</label> <em>(required)</em><span id="ctl00___ctl00___ctl02___form___Requiredfieldvalidator1" style="color: Red; visibility: hidden;">*</span></div>
	<div><input name="ctl00$_$ctl00$_$ctl02$_$form$_$tbTitle" value="re: UserControls as Screens in Silverlight 1.1 - Part 2 of 2 " id="ctl00___ctl00___ctl02___form___tbTitle" class="smallbox" type="text"></div>
	
	<p>
    </p><div id="ctl00___ctl00___ctl02___form___NameTitle"><label for="ctl00___ctl00___ctl02___form___tbName">Name</label> <em>(required)</em><span id="ctl00___ctl00___ctl02___form___Requiredfieldvalidator2" style="color: Red; visibility: hidden;">*</span></div><div id="ctl00___ctl00___ctl02___form___NameDesc"><input name="ctl00$_$ctl00$_$ctl02$_$form$_$tbName" id="ctl00___ctl00___ctl02___form___tbName" class="smallbox" type="text"></div>
    
    <p>
    </p><div><label for="ctl00___ctl00___ctl02___form___tbUrl">Your URL</label> <em>(optional</em>)</div>
    <div><input name="ctl00$_$ctl00$_$ctl02$_$form$_$tbUrl" id="ctl00___ctl00___ctl02___form___tbUrl" class="smallbox" type="text"></div>
    
    <p>
    </p><div><label for="ctl00___ctl00___ctl02___form___tbComment">Comments</label> <em>(required)</em><span id="ctl00___ctl00___ctl02___form___Requiredfieldvalidator3" style="color: Red; visibility: hidden;">*</span></div>
    <div><textarea name="ctl00$_$ctl00$_$ctl02$_$form$_$tbComment" rows="5" cols="25" id="ctl00___ctl00___ctl02___form___tbComment"></textarea></div>
	
	<p>
    </p><div><input id="ctl00___ctl00___ctl02___form___chkRemember" name="ctl00$_$ctl00$_$ctl02$_$form$_$chkRemember" type="checkbox"><label for="ctl00___ctl00___ctl02___form___chkRemember">Remember Me?</label></div>
    
<p>
</p><div id="ctl00___ctl00___ctl02___form___captcha1">
	<img src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/captchaimage.jpg" style="border-width: 0px; display: block;"><span>Enter the text you see in the image: </span><input name="ctl00$_$ctl00$_$ctl02$_$form$_$captcha1$ctl03" size="3" type="text">
</div>

	<p>
    <input name="ctl00$_$ctl00$_$ctl02$_$form$_$btnSubmit" value="Submit" onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$_$ctl00$_$ctl02$_$form$_$btnSubmit", "", true, "", "", false, false))' id="ctl00___ctl00___ctl02___form___btnSubmit" type="submit">
	</p>

</fieldset>



	

<fieldset id="postnotification">
	<legend>Comment Notification</legend>
	<p>
	If you would like to receive an email when updates are made to this post, please register <a id="ctl00___ctl00___ctl02___DetailedSubBar___RegisterLink" href="http://community.irritatedvowel.com/user/CreateUser.aspx?ReturnUrl=/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx">here</a>
	
	</p>
	<p>
	Subscribe to this post's comments using
	<a id="ctl00___ctl00___ctl02___DetailedSubBar___CommentRssLink" href="http://community.irritatedvowel.com/blogs/pete_browns_blog/commentrss.aspx?PostID=1368">RSS</a>
	</p>
</fieldset>
   
    
	</div>
	<div id="footer">
		<a target="_blank" href="http://communityserver.org/r.ashx?1"><img alt="Powered by Community Server, by Telligent Systems " src="UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx_files/EULA.GIF" border="0"></a>
	</div>
</div>

<script type="text/javascript">
<!--
var Page_Validators =  new Array(document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator1"), document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator2"), document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator3"));
// -->
</script>

<script type="text/javascript">
<!--
var ctl00___ctl00___ctl02___form___Requiredfieldvalidator1 = document.all ? document.all["ctl00___ctl00___ctl02___form___Requiredfieldvalidator1"] : document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator1");
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.controltovalidate = "ctl00___ctl00___ctl02___form___tbTitle";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.errormessage = "*";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.initialvalue = "";
var ctl00___ctl00___ctl02___form___Requiredfieldvalidator2 = document.all ? document.all["ctl00___ctl00___ctl02___form___Requiredfieldvalidator2"] : document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator2");
ctl00___ctl00___ctl02___form___Requiredfieldvalidator2.controltovalidate = "ctl00___ctl00___ctl02___form___tbName";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator2.errormessage = "*";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator2.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator2.initialvalue = "";
var ctl00___ctl00___ctl02___form___Requiredfieldvalidator3 = document.all ? document.all["ctl00___ctl00___ctl02___form___Requiredfieldvalidator3"] : document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator3");
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.controltovalidate = "ctl00___ctl00___ctl02___form___tbComment";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.errormessage = "*";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.initialvalue = "";
// -->
</script>

<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___sws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$sws$_$SearchButton','')	}
}

//-->
</script>

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx"
dc:identifier="http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2007/10/16/UserControls-as-Screens-in-Silverlight-1.1-_2D00_-Part-2-of-2-.aspx"
dc:title="UserControls as Screens in Silverlight 1.1 - Part 2 of 2 "
trackback:ping="http://community.irritatedvowel.com/blogs/pete_browns_blog/trackback.aspx?PostID=1368" />
</rdf:RDF>
-->

<script type="text/javascript">
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</script>
        </form>
</body></html>