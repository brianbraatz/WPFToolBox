<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://www.codeproject.com/dotnet/MycroXaml.asp -->
<HTML><HEAD><TITLE>MycroXaml - The Code Project - .NET</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="A Declarative Xml Parser In Less Than 300 Lines Of Code" 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Marc Clifton" name=Author>
<META content="22 Sep 2004 14:00:00 GMT" name=Search.PublishDate>
<META content="22 Sep 2004 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, XAML MyXaml xml declarative" 
name=keywords>
<META 
content="Article content copyright Marc Clifton, 2004, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="MycroXaml - The Code Project - _NET_files/global.css" type=text/css 
rel=stylesheet>
<SCRIPT language=javascript 
src="MycroXaml - The Code Project - _NET_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.3199" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT src="MycroXaml - The Code Project - _NET_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="MycroXaml - The Code Project - _NET_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=4490&cb=1651692\" border=0 frameborder=0 scrolling=no width=728 height=90></IFRAME>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,642,377 members and 
            growing! &nbsp; 9,817 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=3157962">My 
            Profile </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/dotnet/MycroXaml.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=3157962">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/dotnet/MycroXaml.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD noWrap><A href="http://www.codeproject.com/index.asp?cat=1">All 
            Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT src="MycroXaml - The Code Project - _NET_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT src="MycroXaml - The Code Project - _NET_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A> &gt;&gt; <A 
            href="http://www.codeproject.com/dotnet/">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/dotnet/#XAML">XAML</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">MycroXaml</DIV><B>By 
            <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=36803">Marc 
            Clifton</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">A Declarative Xml Parser In Less Than 
            300 Lines Of Code</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#, Generic<BR>Windows, 
            .NET<BR>Win32, VS<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>23 Sep 
            2004</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>38,462</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN: 12px 3px 12px 0px" 
            height=12 alt="VS 2008" 
            src="MycroXaml - The Code Project - _NET_files/VS2008_sm.gif" 
            width=20> <A 
            href="http://www.codeproject.com/Feature/VS2008/">Visual Studio 
            2008<BR>competition.<BR>$25,000 in prizes</A></DIV>
            <DIV style="PADDING-TOP: 3px"><IMG 
            style="MARGIN-LEFT: 2px; MARGIN-RIGHT: 5px" height=16 alt=Jobs 
            src="MycroXaml - The Code Project - _NET_files/staff_sm.gif" 
            width=12 align=absMiddle> <A 
            href="http://www.codeproject.com/info/jobs/">http://www.codeproject.com/info/jobs/</A></DIV>
            <DIV style="PADDING-TOP: 3px"><IMG 
            style="MARGIN-LEFT: 2px; MARGIN-RIGHT: 5px" height=20 alt=Comp 
            src="MycroXaml - The Code Project - _NET_files/prize_winner_sm.gif" 
            width=10 align=absMiddle> <A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=4321&cb=1651701\" border=0 frameborder=0 scrolling=no width=160 height=600></IFRAME>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="MycroXaml - The Code Project - _NET_files/t.gif" width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="MycroXaml - The Code Project - _NET_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/dotnet/MycroXaml.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MycroXaml - The Code Project - _NET_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=MycroXaml%2Fdotnet9%2F23%2F2004">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MycroXaml - The Code Project - _NET_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fdotnet%2FMycroXaml%2Easp&amp;guid=MycroXaml%2Fdotnet9%2F23%2F2004">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MycroXaml - The Code Project - _NET_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/dotnet/MycroXaml.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MycroXaml - The Code Project - _NET_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=MycroXaml%2Fdotnet9%2F23%2F2004">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>21 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/red.gif" 
                              width=7 border=0><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/white.gif" 
                              width=13 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        5.72</A>. Rating: <B>4.33</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/dotnet/MycroXaml/MycroXaml_demo.zip">Download 
              demo project -&nbsp;7.73 Kb</A> </LI></UL>
            <P><IMG height=222 alt="Sample Image - colorChooser.png" 
            src="MycroXaml - The Code Project - _NET_files/colorChooser.png" 
            width=406></P>
            <H2>Introduction</H2>
            <P>So why did I write this (again???)?&nbsp; Mainly because I wanted 
            a lightweight declarative parser.&nbsp; <A 
            href="http://www.myxaml.com/">MyXaml</A> isn't what I would consider 
            lightweight, so I was faced with a dilemma: how do I write applets 
            and articles about declarative programming without requiring that 
            reader to download and install the whole MyXaml package?&nbsp; I 
            needed something that was simple and didn't detract from the focus 
            of the applet/article itself, hence "MycroXaml" was born.</P>
            <H3>What Does MycroXaml Do?</H3>
            <P>MycroXaml parses an <CODE>XmlDocument</CODE>, instantiating 
            classes and assigning values to properties at runtime.&nbsp; 
            MycroXaml has the following features:</P>
            <UL>
              <LI>Implements a true class-property-class architecture 
              <LI>Automatically collects named instances 
              <LI>Allows referencing of those instances 
              <LI>Supports the <CODE>ISupportInitialize </CODE>interface 
              <LI>Provides a custom <CODE>IMycroXaml </CODE>interface for 
              classes that perform custom parsing 
              <LI>Supports <CODE>IList </CODE>and <CODE>ICollection 
              </CODE>interfaces 
              <LI>Is implemented in less than 300 lines of code 
              <LI>Strict error checking 
              <LI>Event binding to a specified event sink 
              <LI>DataBinding </LI></UL>
            <H3>What Doesn't It Do?</H3>
            <P>The following features are not supported (but are in MyXaml):</P>
            <UL>
              <LI>Late binding 
              <LI>The "ref:" construct to re-use an existing instance instead of 
              instantiating a new one 
              <LI>Resources and bitmaps 
              <LI>Styles 
              <LI>Include 
              <LI>Sub-forms 
              <LI>Inline and code-behind runtime compilation 
              <LI>Specifying target instances for event binding 
              <LI>IExtenderProvider management 
              <LI>Default namespace 
              <LI>Does not install in the GAC 
              <LI>Structs 
              <LI>Auto-initialization of C# fields </LI></UL>
            <P>That said, MycroXaml is a very useful "playground" for exploring 
            declarative programming and writing lightweight applets.&nbsp; In 
            this article I'm going to describe how the micro-parser works.&nbsp; 
            </P>
            <H2>Demonstration Program</H2>
            <P>A simple demonstration of declarative programming with data 
            binding and events is illustrated with the color picker (screen shot 
            at top of article), created with the following declarative xml:</P><PRE lang=xml>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;MycroXaml Name="Form"
  xmlns:wf="System.Windows.Forms, System.Windows.Forms,
        Version=1.0.5000.0, Culture=neutral,
        PublicKeyToken=b77a5c561934e089"
  xmlns:mc="MycroXaml.MxContainer, MycroXaml.MxContainer"&gt;
  &lt;wf:Form Name="AppMainForm"
    Text="Color Chooser"
    ClientSize="400, 190"
    BackColor="White"
    FormBorderStyle="FixedSingle"
    StartPosition="CenterScreen"&gt;

    &lt;wf:Controls&gt;
      &lt;wf:TrackBar Name="RedScroll" Orientation="Vertical"
          TickFrequency="16" TickStyle="BottomRight" Minimum="0"
          Maximum="255" Value="128" Scroll="OnScrolled" Size="42, 128"
          Location="10, 30"/&gt;
      &lt;wf:TrackBar Name="GreenScroll" Orientation="Vertical"
          TickFrequency="16" TickStyle="BottomRight" Minimum="0"
          Maximum="255" Value="128" Scroll="OnScrolled" Size="42, 128"
          Location="55, 30"/&gt;
      &lt;wf:TrackBar Name="BlueScroll" Orientation="Vertical"
          TickFrequency="16" TickStyle="BottomRight" Minimum="0"
          Maximum="255" Value="128" Scroll="OnScrolled" Size="42, 128"
          Location="100, 30"/&gt;

      &lt;wf:Label Size="40,15" TextAlign="TopCenter"
          Font="Microsoft Sans Serif, 8.25pt, style= Bold"
          Location="10, 10" ForeColor="Red" Text="Red"/&gt;
      &lt;wf:Label Size="40,15" TextAlign="TopCenter"
          Font="Microsoft Sans Serif, 8.25pt, style= Bold"
          Location="55, 10" ForeColor="Green" Text="Green"/&gt;
      &lt;wf:Label Size="40,15" TextAlign="TopCenter"
          Font="Microsoft Sans Serif, 8.25pt, style= Bold"
          Location="100, 10" ForeColor="Blue" Text="Blue"/&gt;

      &lt;wf:Label Name="RedValue" Size="40,15" TextAlign="TopCenter"
          Font="Microsoft Sans Serif, 8.25pt, style= Bold"
          Location="10, 160" ForeColor="Red"&gt;
        &lt;wf:DataBindings&gt;
          &lt;mc:DataBinding PropertyName="Text" DataSource="{RedScroll}"
              DataMember="Value"/&gt;
        &lt;/wf:DataBindings&gt;
      &lt;/wf:Label&gt;

      &lt;wf:Label Name="GreenValue" Size="40,15" TextAlign="TopCenter"
          Font="Microsoft Sans Serif, 8.25pt, style= Bold"
          Location="55, 160" ForeColor="Green"&gt;
        &lt;wf:DataBindings&gt;
          &lt;mc:DataBinding PropertyName="Text" DataSource="{GreenScroll}"
              DataMember="Value"/&gt;
        &lt;/wf:DataBindings&gt;
      &lt;/wf:Label&gt;

      &lt;wf:Label Name="BlueValue" Size="40,15" TextAlign="TopCenter"
          Font="Microsoft Sans Serif, 8.25pt, style= Bold"
          Location="100, 160" ForeColor="Blue"&gt;
        &lt;wf:DataBindings&gt;
          &lt;mc:DataBinding PropertyName="Text" DataSource="{BlueScroll}"
              DataMember="Value"/&gt;
        &lt;/wf:DataBindings&gt;
      &lt;/wf:Label&gt;

      &lt;wf:PictureBox Name="ColorPanel" Location="90, 0" Size="200, 100"
          Dock="Right" BorderStyle="Fixed3D" BackColor="128, 128, 128"/&gt;
    &lt;/wf:Controls&gt;
  &lt;/wf:Form&gt;
&lt;/MycroXaml&gt;</PRE>
            <P>The classes are instantiated and the event handler defined with 
            the following C# code:</P><PRE lang=cs><SPAN class=cs-keyword>using</SPAN> System;
<SPAN class=cs-keyword>using</SPAN> System.Diagnostics;
<SPAN class=cs-keyword>using</SPAN> System.IO;
<SPAN class=cs-keyword>using</SPAN> System.Windows.Forms;
<SPAN class=cs-keyword>using</SPAN> System.Xml;

<SPAN class=cs-keyword>using</SPAN> MycroXaml.Parser;

<SPAN class=cs-keyword>namespace</SPAN> Demo
{
  <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>class</SPAN> Startup
  {
    <SPAN class=cs-keyword>protected</SPAN> Parser mp;

    [STAThread]
    <SPAN class=cs-keyword>static</SPAN> <SPAN class=cs-keyword>void</SPAN> Main() 
    {
      <SPAN class=cs-keyword>new</SPAN> Startup();
    }

    <SPAN class=cs-keyword>public</SPAN> Startup()
    {
      mp=<SPAN class=cs-keyword>new</SPAN> Parser();
      StreamReader sr=<SPAN class=cs-keyword>new</SPAN> StreamReader(<SPAN class=cpp-string>"ColorPicker.mycroxaml"</SPAN>);
      <SPAN class=cs-keyword>string</SPAN> text=sr.ReadToEnd();
      sr.Close();
      XmlDocument doc=<SPAN class=cs-keyword>new</SPAN> XmlDocument();
      <SPAN class=cs-keyword>try</SPAN>
      {
        doc.LoadXml(text);
      }
      <SPAN class=cs-keyword>catch</SPAN>(Exception e)
      {
        Trace.Fail(<SPAN class=cpp-string>"Malformed xml:\r\n"</SPAN>+e.Message);
      }

      Form form=(Form)mp.Load(doc, <SPAN class=cpp-string>"Form"</SPAN>, <SPAN class=cs-keyword>this</SPAN>);
      form.ShowDialog();
    }

    <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>void</SPAN> OnScrolled(<SPAN class=cs-keyword>object</SPAN> sender, EventArgs e)
    {
      TrackBar RedScroll = (TrackBar)mp.GetInstance(<SPAN class=cpp-string>"RedScroll"</SPAN>);
      TrackBar GreenScroll = (TrackBar)mp.GetInstance(<SPAN class=cpp-string>"GreenScroll"</SPAN>);
      TrackBar BlueScroll = (TrackBar)mp.GetInstance(<SPAN class=cpp-string>"BlueScroll"</SPAN>);
      PictureBox ColorPanel = (PictureBox)mp.GetInstance(<SPAN class=cpp-string>"ColorPanel"</SPAN>);

      ColorPanel.BackColor = System.Drawing.Color.FromArgb(
         (<SPAN class=cs-keyword>byte</SPAN>)RedScroll.Value,
         (<SPAN class=cs-keyword>byte</SPAN>)GreenScroll.Value,
         (<SPAN class=cs-keyword>byte</SPAN>)BlueScroll.Value);
    }
  }
}</PRE>
            <H2>How Does The Parser Work?</H2>
            <H3>Initialization</H3>
            <P>The first thing the parser has to do is locate the root element 
            and identify the xml namespaces that map to assembly 
            namespaces.&nbsp; Once this is done, it can begin processing the 
            child element of the root node.&nbsp; It is assumed that there will 
            only be a single child element from which the object graph is 
            constructed.</P><PRE lang=cs><SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>object</SPAN> Load(XmlDocument doc, <SPAN class=cs-keyword>string</SPAN> objectName, <SPAN class=cs-keyword>object</SPAN> eventSink)
{
  <SPAN class=cs-keyword>this</SPAN>.eventSink=eventSink;
  objectCollection=<SPAN class=cs-keyword>new</SPAN> Hashtable();

  <SPAN class=cs-keyword>object</SPAN> ret=<SPAN class=cs-keyword>null</SPAN>;
  XmlNode node=doc.SelectSingleNode(<SPAN class=cpp-string>"//MycroXaml[@Name='"</SPAN>+objectName+<SPAN class=cpp-string>"']"</SPAN>);
  Trace.Assert(node != <SPAN class=cs-keyword>null</SPAN>, <SPAN class=cpp-string>"Couldn't find MycroXaml element "</SPAN>+objectName);
  Trace.Assert(node.ChildNodes.Count==<SPAN class=cs-literal>1</SPAN>,
        <SPAN class=cpp-string>"Only one child of the root is allowed."</SPAN>)
  ProcessNamespaces(node);
  ret=ProcessNode(node.ChildNodes[<SPAN class=cs-literal>0</SPAN>], <SPAN class=cs-keyword>null</SPAN>);
  <SPAN class=cs-keyword>return</SPAN> ret;
}</PRE>
            <P>If all goes well, the top-level instance is returned to the 
            caller.&nbsp; The namespace processing is very simple.&nbsp; Later 
            during class instantiation the namespace information is used to 
            generate a fully qualified name for the class.</P><PRE lang=cs><SPAN class=cs-keyword>protected</SPAN> <SPAN class=cs-keyword>void</SPAN> ProcessNamespaces(XmlNode node)
{
  nsMap=<SPAN class=cs-keyword>new</SPAN> Hashtable();
  <SPAN class=cs-keyword>foreach</SPAN>(XmlAttribute attr <SPAN class=cs-keyword>in</SPAN> node.Attributes)
  {
    <SPAN class=cs-keyword>if</SPAN> (attr.Prefix==<SPAN class=cpp-string>"xmlns"</SPAN>)
    {
      nsMap[attr.LocalName]=attr.Value;
    }
  }
}</PRE>
            <H3>Processing The Object Graph</H3>
            <P>The object graph is processed assuming a class-property-class 
            hierarchy.&nbsp; The property sandwiched between the classes is 
            usually a collection, but can also be a concrete instance of a 
            property whose type is either an interface or an abstract 
            class.&nbsp; The main loop inspects the created instance to see if 
            it implements the <CODE>ISupportInitialize</CODE> and 
            <CODE>IMycroXaml</CODE> interfaces.&nbsp; The first, 
            <CODE>ISupportInitialize</CODE>, is critical to ensure that a .NET 
            Form object is properly constructed with regards to docking.</P><PRE lang=cs><SPAN class=cs-keyword>protected</SPAN> <SPAN class=cs-keyword>object</SPAN> ProcessNode(XmlNode node, <SPAN class=cs-keyword>object</SPAN> parent)
{
  <SPAN class=cs-keyword>object</SPAN> ret=<SPAN class=cs-keyword>null</SPAN>;
  <SPAN class=cs-keyword>if</SPAN> (node <SPAN class=cs-keyword>is</SPAN> XmlElement)
  {
    <SPAN class=cs-comment>// instantiate the class</SPAN>
    <SPAN class=cs-keyword>string</SPAN> ns=node.Prefix;
    <SPAN class=cs-keyword>string</SPAN> cname=node.LocalName;
    Trace.Assert(nsMap.Contains(ns),
          <SPAN class=cpp-string>"Namespace '"</SPAN>+ns+<SPAN class=cpp-string>"' has not been declared."</SPAN>);
    <SPAN class=cs-keyword>string</SPAN> asyName=(<SPAN class=cs-keyword>string</SPAN>)nsMap[ns];
    <SPAN class=cs-keyword>string</SPAN> qname=StringHelpers.LeftOf(asyName, ',')+<SPAN class=cpp-string>"."</SPAN>+cname+<SPAN class=cpp-string>", "</SPAN>+
                 StringHelpers.RightOf(asyName, ',');
    Type t=Type.GetType(qname, <SPAN class=cs-keyword>false</SPAN>);
    Trace.Assert(t != <SPAN class=cs-keyword>null</SPAN>, <SPAN class=cpp-string>"Type "</SPAN>+qname+<SPAN class=cpp-string>" could not be determined."</SPAN>);
    <SPAN class=cs-keyword>try</SPAN>
    {
      ret=Activator.CreateInstance(t);
    }
    <SPAN class=cs-keyword>catch</SPAN>(Exception e)
    {
      Trace.Fail(<SPAN class=cpp-string>"Type "</SPAN>+qname+<SPAN class=cpp-string>" could not be instantiated:\r\n"</SPAN>+e.Message);
    }

    <SPAN class=cs-comment>// support the ISupportInitialize interface</SPAN>
    <SPAN class=cs-keyword>if</SPAN> (ret <SPAN class=cs-keyword>is</SPAN> ISupportInitialize)
    {
      ((ISupportInitialize)ret).BeginInit();
    }

    <SPAN class=cs-comment>// If the instance implements the IMicroXaml interface, then it may need </SPAN>
    <SPAN class=cs-comment>// access to the parser.</SPAN>
    <SPAN class=cs-keyword>if</SPAN> (ret <SPAN class=cs-keyword>is</SPAN> IMycroXaml)
    {
      ((IMycroXaml)ret).Initialize(parent);
    }

    <SPAN class=cs-comment>// implements the class-property-class model</SPAN>
    ProcessChildProperties(node, ret);
    <SPAN class=cs-keyword>string</SPAN> refName=ProcessAttributes(node, ret, t);

    <SPAN class=cs-comment>// support the ISupportInitialize interface</SPAN>
    <SPAN class=cs-keyword>if</SPAN> (ret <SPAN class=cs-keyword>is</SPAN> ISupportInitialize)
    {
      ((ISupportInitialize)ret).EndInit();
    }

    <SPAN class=cs-comment>// If the instance implements the IMicroXaml interface,</SPAN>
    <SPAN class=cs-comment>// then it has the option</SPAN>
    <SPAN class=cs-comment>// to return an object that replaces the instance created by the parser.</SPAN>
    <SPAN class=cs-keyword>if</SPAN> (ret <SPAN class=cs-keyword>is</SPAN> IMycroXaml)
    {
      ret=((IMycroXaml)ret).ReturnedObject;
      <SPAN class=cs-keyword>if</SPAN> ( (ret != <SPAN class=cs-keyword>null</SPAN>) &amp;&amp; (refName != String.Empty) )
      {
        AddInstance(refName, ret);
      }
    }
  }
  <SPAN class=cs-keyword>return</SPAN> ret;
}</PRE>
            <H3>Processing Child Nodes</H3>
            <P>A child node of a class is assumed to be a property of that 
            class.&nbsp; A special exception is made allowing disassociated 
            classes to be instantiated, allowing you to construct independent 
            objects off of the parent object that are referenced later on.&nbsp; 
            The typical child node is either a property managing a collection or 
            a property whose value type is an interface or an abstract 
class.</P>
            <H4>Collection Properties</H4>
            <P>A collection property has zero or more child items that the 
            parser adds to the collection.</P>
            <H4>Interface/Abstract Property Types</H4>
            <P>A property whose value type is an interface or abstract class has 
            exactly one child item.&nbsp; This child item is a concrete instance 
            that is assigned to the property of the parent instance.</P>
            <H4>Implementation</H4>
            <P>Note how the "CanWrite" <CODE>PropertyInfo</CODE> value is tested 
            to determine whether the property is a collection or a list.&nbsp; 
            According to the .NET guidelines, properties whose value type are a 
            collection/list should be read only.&nbsp; This makes sense, as it 
            prevents the overwriting of the collection/list.&nbsp; Another point 
            to bring up is that the parser assumes that the collection 
            implements an <CODE>Add</CODE> method that takes only one 
            parameter--the item being added.&nbsp; Some third party tools 
            (DevExpress comes to mind) implement Add methods in that take two or 
            more parameters.&nbsp; This makes it very difficult to work with 
            such implementation.</P><PRE lang=cs><SPAN class=cs-keyword>protected</SPAN> <SPAN class=cs-keyword>void</SPAN> ProcessChildProperties(XmlNode node, <SPAN class=cs-keyword>object</SPAN> parent)
{
  Type t=parent.GetType();

  <SPAN class=cs-comment>// children of a class must always be properties</SPAN>
  <SPAN class=cs-keyword>foreach</SPAN>(XmlNode child <SPAN class=cs-keyword>in</SPAN> node.ChildNodes)
  {
    <SPAN class=cs-keyword>if</SPAN> (child <SPAN class=cs-keyword>is</SPAN> XmlElement)
    {
      <SPAN class=cs-keyword>string</SPAN> pname=child.LocalName;
      PropertyInfo pi=t.GetProperty(pname);

      <SPAN class=cs-keyword>if</SPAN> (pi==<SPAN class=cs-keyword>null</SPAN>)
      {
        <SPAN class=cs-comment>// Special case--we're going to assume that the child is</SPAN>
        <SPAN class=cs-comment>// a class instance</SPAN>
        <SPAN class=cs-comment>// not associated with the parent object</SPAN>
        ProcessNode(child, <SPAN class=cs-keyword>null</SPAN>);
        <SPAN class=cs-keyword>continue</SPAN>;
      }

      <SPAN class=cs-comment>// a property can only have one child node unless it's a collection</SPAN>
      <SPAN class=cs-keyword>foreach</SPAN>(XmlNode grandChild <SPAN class=cs-keyword>in</SPAN> child.ChildNodes)
      {
        <SPAN class=cs-keyword>if</SPAN> (grandChild <SPAN class=cs-keyword>is</SPAN> XmlElement)
        {
          <SPAN class=cs-keyword>object</SPAN> propObject=pi.GetValue(parent, <SPAN class=cs-keyword>null</SPAN>);
          <SPAN class=cs-keyword>object</SPAN> obj=ProcessNode(grandChild, propObject);

          <SPAN class=cs-comment>// A null return is valid in cases where a class implementing</SPAN>
          <SPAN class=cs-comment>// the IMicroXaml interface</SPAN>
          <SPAN class=cs-comment>// might want to take care of managing the instance it creates</SPAN>
          <SPAN class=cs-comment>// itself. See DataBinding</SPAN>
          <SPAN class=cs-keyword>if</SPAN> (obj != <SPAN class=cs-keyword>null</SPAN>)
          {

            <SPAN class=cs-comment>// support for ICollection objects</SPAN>
            <SPAN class=cs-keyword>if</SPAN> (!pi.CanWrite)
            {
              <SPAN class=cs-keyword>if</SPAN> (propObject <SPAN class=cs-keyword>is</SPAN> ICollection)
              {
                MethodInfo mi=t.GetMethod(<SPAN class=cpp-string>"Add"</SPAN>, <SPAN class=cs-keyword>new</SPAN> Type[] {obj.GetType()});
                <SPAN class=cs-keyword>if</SPAN> (mi != <SPAN class=cs-keyword>null</SPAN>)
                {
                  <SPAN class=cs-keyword>try</SPAN>
                  {
                    mi.Invoke(obj, <SPAN class=cs-keyword>new</SPAN> <SPAN class=cs-keyword>object</SPAN>[] {obj});
                  }
                  <SPAN class=cs-keyword>catch</SPAN>(Exception e)
                  {
                    Trace.Fail(<SPAN class=cpp-string>"Adding to collection failed:\r\n"</SPAN>+e.Message);
                  }
                }
                <SPAN class=cs-keyword>else</SPAN> <SPAN class=cs-keyword>if</SPAN> (propObject <SPAN class=cs-keyword>is</SPAN> IList)
                {
                  <SPAN class=cs-keyword>try</SPAN>
                  {
                    ((IList)propObject).Add(obj);
                  }
                  <SPAN class=cs-keyword>catch</SPAN>(Exception e)
                  {
                    Trace.Fail(<SPAN class=cpp-string>"List/Collection add failed:\r\n"</SPAN>+e.Message);
                  }
                }
              }
              <SPAN class=cs-keyword>else</SPAN>
              {
                Trace.Fail(<SPAN class=cpp-string>"Unsupported read-only property: "</SPAN>+pname);
              }
            }
            <SPAN class=cs-keyword>else</SPAN>
            {
              <SPAN class=cs-comment>// direct assignment if not a collection</SPAN>
              <SPAN class=cs-keyword>try</SPAN>
              {
                pi.SetValue(parent, obj, <SPAN class=cs-keyword>null</SPAN>);
              }
              <SPAN class=cs-keyword>catch</SPAN>(Exception e)
              {
                Trace.Fail(<SPAN class=cpp-string>"Property setter for "</SPAN>+pname+<SPAN class=cpp-string>" failed:\r\n"</SPAN>+
                           e.Message);
              }
            }
          }
        }
      }
    }  
  }
}</PRE>
            <H3>Processing Attributes</H3>
            <P>Processing the attributes of an element is all about mapping the 
            attribute value to either a property or an event.&nbsp; Type 
            conversion is necessary to convert the string to the appropriate 
            property type.&nbsp; The parser implements a special check for 
            attribute values surrounded by {}, which tells the parser to replace 
            the string value with an instance previously defined.&nbsp; Any 
            class with a "Name" attribute is automatically added to the instance 
            collection (but the class must provide a Name property in the debug 
            mode).&nbsp; The most interesting aspect of this code is how events 
            are wired up. </P><PRE lang=cs><SPAN class=cs-keyword>protected</SPAN> <SPAN class=cs-keyword>string</SPAN> ProcessAttributes(XmlNode node, <SPAN class=cs-keyword>object</SPAN> ret, Type t)
{
  <SPAN class=cs-keyword>string</SPAN> refName=String.Empty;

  <SPAN class=cs-comment>// process attributes</SPAN>
  <SPAN class=cs-keyword>foreach</SPAN>(XmlAttribute attr <SPAN class=cs-keyword>in</SPAN> node.Attributes)
  {
    <SPAN class=cs-keyword>string</SPAN> pname=attr.Name;
    <SPAN class=cs-keyword>string</SPAN> pvalue=attr.Value;

    <SPAN class=cs-comment>// it's either a property or an event</SPAN>
    PropertyInfo pi=t.GetProperty(pname);
    EventInfo ei=t.GetEvent(pname);

    <SPAN class=cs-keyword>if</SPAN> (pi != <SPAN class=cs-keyword>null</SPAN>)
    {
      <SPAN class=cs-comment>// it's a property!</SPAN>
      <SPAN class=cs-keyword>if</SPAN> ( pvalue.StartsWith(<SPAN class=cpp-string>"{"</SPAN>) &amp;&amp; pvalue.EndsWith(<SPAN class=cpp-string>"}"</SPAN>) )
      {
        <SPAN class=cs-comment>// And the value is a reference to an instance!</SPAN>
        <SPAN class=cs-comment>// Get the referenced object. Late binding is not supported!</SPAN>
        <SPAN class=cs-keyword>object</SPAN> val=GetInstance(pvalue.Substring(<SPAN class=cs-literal>1</SPAN>, pvalue.Length-<SPAN class=cs-literal>2</SPAN>));
        <SPAN class=cs-keyword>try</SPAN>
        {
          pi.SetValue(ret, val, <SPAN class=cs-keyword>null</SPAN>);
        }
        <SPAN class=cs-keyword>catch</SPAN>(Exception e)
        {
          Trace.Fail(<SPAN class=cpp-string>"Couldn't set property "</SPAN>+pname+<SPAN class=cpp-string>" to an instance of "</SPAN>+
                pvalue+<SPAN class=cpp-string>":\r\n"</SPAN>+e.Message);
        }
      }
      <SPAN class=cs-keyword>else</SPAN>
      {
        <SPAN class=cs-comment>// it's string, so use a type converter.</SPAN>
        TypeConverter tc=TypeDescriptor.GetConverter(pi.PropertyType);
        <SPAN class=cs-keyword>if</SPAN> (tc.CanConvertFrom(<SPAN class=cs-keyword>typeof</SPAN>(<SPAN class=cs-keyword>string</SPAN>)))
        {
          <SPAN class=cs-keyword>object</SPAN> val=tc.ConvertFrom(pvalue);
          <SPAN class=cs-keyword>try</SPAN>
          {
            pi.SetValue(ret, val, <SPAN class=cs-keyword>null</SPAN>);
          }
          <SPAN class=cs-keyword>catch</SPAN>(Exception e)
          {
            Trace.Fail(<SPAN class=cpp-string>"Property setter for "</SPAN>+pname+<SPAN class=cpp-string>" failed:\r\n"</SPAN>+e.Message);
          }
        }
      }

      <SPAN class=cs-comment>// auto-add to our object collection</SPAN>
      <SPAN class=cs-keyword>if</SPAN> (pname==<SPAN class=cpp-string>"Name"</SPAN>)
      {
        refName=pvalue;
        AddInstance(pvalue, ret);
      }
    }
    <SPAN class=cs-keyword>else</SPAN> <SPAN class=cs-keyword>if</SPAN> (ei != <SPAN class=cs-keyword>null</SPAN>)
    {
      <SPAN class=cs-comment>// it's an event!</SPAN>
      Delegate dlgt=<SPAN class=cs-keyword>null</SPAN>;
      <SPAN class=cs-keyword>try</SPAN>
      {
        MethodInfo mi=eventSink.GetType().GetMethod(pvalue,
           BindingFlags.Public | BindingFlags.NonPublic |
           BindingFlags.Instance | BindingFlags.Static);
        dlgt=Delegate.CreateDelegate(ei.EventHandlerType, eventSink, mi.Name);
      }
      <SPAN class=cs-keyword>catch</SPAN>(Exception e)
      {
        Trace.Fail(<SPAN class=cpp-string>"Couldn't create a delegate for the event "</SPAN>+pvalue+
              <SPAN class=cpp-string>":\r\n"</SPAN>+e.Message);
      }

      <SPAN class=cs-keyword>try</SPAN>
      {
        ei.AddEventHandler(ret, dlgt);
      }
      <SPAN class=cs-keyword>catch</SPAN>(Exception e)
      {
        Trace.Fail(<SPAN class=cpp-string>"Binding to event "</SPAN>+pname+<SPAN class=cpp-string>" failed: "</SPAN>+e.Message);
      }
    }
    <SPAN class=cs-keyword>else</SPAN>
    {
      <SPAN class=cs-comment>// who knows what it is???</SPAN>
      Trace.Fail(<SPAN class=cpp-string>"Failed acquiring property information for "</SPAN>+pname);
    }
  }
  <SPAN class=cs-keyword>return</SPAN> refName;
}</PRE>
            <H2>Conclusion</H2>
            <P>That's it!&nbsp; Declarative programming with xml in less than 
            300 lines of code!&nbsp; Now I can write simple UI's for other nifty 
            things without requiring the reader to download the entire MyXaml 
            package.&nbsp; And yes, after using xml to declaratively construct 
            object graphs (and declarative programming in general for years), 
            the thought of constructing an application the "Microsoft Way" gives 
            me shivers.&nbsp; Declarative programming is very flexible, easily 
            customizable, has sufficiently fast execution time, and I find it to 
            be as fast (if not faster in some cases) than using a designer and 
            writing C# code.&nbsp; Especially when considering programming 
            holistically--the inevitable design changes and new requirements 
            that can cause considerable rewrites and recompilations of C# 
            code--declarative programming in my opinion really shines.&nbsp; And 
            if you're concerned about not having compile-time checking of the 
            markup, you can always use MxLint.&nbsp; OK, I'll get off the 
            declarative programming soapbox 
            now!</P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT src="MycroXaml - The Code Project - _NET_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Marc Clifton</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="MycroXaml - The Code Project - _NET_files/{CCCA6270-7875-4937-96C2-0CF123E2F30F}.jpg"><BR><A 
                  href="http://www.codeproject.com/script/profile/MemberTypes.asp#mvps"><IMG 
                  height=64 alt="CodeProject MVP" 
                  src="MycroXaml - The Code Project - _NET_files/MVP.gif" 
                  width=64 border=0></A> <A 
                  href="http://www.codeproject.com/script/profile/MemberTypes.asp#protectors"><IMG 
                  height=64 alt="CodeProject Protector" 
                  src="MycroXaml - The Code Project - _NET_files/Protector.gif" 
                  width=48 border=0></A> <A 
                  href="http://www.codeproject.com/script/profile/MemberTypes.asp#supporters"><IMG 
                  height=64 alt="CodeProject Supporter" 
                  src="MycroXaml - The Code Project - _NET_files/Supporter.gif" 
                  width=48 border=0></A> </TD>
                <TD class=smallText>Marc is the creator of <A 
                  href="http://www.myxaml.com/">MyXaml</A>, an open source, 
                  declarative, XML instantiation engine. He is an industry 
                  consultant working primarily with companies interested in 
                  utilizing declarative programming concepts to add flexibility 
                  to n-tier architectures on web, CE, and desktop platforms. His 
                  other major open source project is the <A 
                  href="http://www.marcclifton.com/Projects/AdvancedUnitTesting/tabid/102/Default.aspx">Advanced 
                  Unit Testing framework</A>.&nbsp; He operates his own website, 
                  <A 
                  href="http://www.marcclifton.com/">http://www.marcclifton.com/</A>, 
                  where you will find many of his articles. <BR><BR>Marc lives 
                  in Hudson, NY with his girlfriend Karen and his son Ian, who 
                  attends the <A 
                  href="http://www.hawthornevalleyschool.org/">Hawthorne Valley 
                  School</A>. To contact Marc, email him at <A 
                  href="mailto:marc.clifton@gmail.com">marc.clifton@gmail.com</A>.
                  <P></P><BR>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=36803">here</A> 
                  to view Marc Clifton's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular .NET articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/dotnet/regextutorial.asp">The 
                    30 Minute Regex Tutorial</A>
                    <DIV class=smallText>Learn how to use regular expressions in 
                    30 minutes with Expresso.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/dotnet/strings.asp">Strings 
                    UNDOCUMENTED</A>
                    <DIV class=smallText>Detailed looked at the implementation 
                    of strings in .NET</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/dotnet/expresso.asp">Expresso 
                    - A Tool for Building and Testing Regular Expressions</A>
                    <DIV class=smallText>For learning, building, and debugging 
                    .NET Framework regular expressions</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/dotnet/cominterop.asp">Understanding 
                    Classic COM Interoperability With .NET Applications</A>
                    <DIV class=smallText>Discusses how existing COM components 
                    can be used from managed code.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4078&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FInstallShield%5Fblkboard%5F300x250%5Fcb%2Ejpg&C=False&id=4078&cb=1651704\" alt=\"\" border=0 width=300 height=250></a>");</SCRIPT>
                </TD></TR></TBODY></TABLE><BR>
            <SCRIPT language=JavaScript 
            src="MycroXaml - The Code Project - _NET_files/addto.js" 
            type=text/javascript></SCRIPT>

            <SCRIPT language=JavaScript type=text/javascript>
var addtoMethod=1;
var AddURL = document.location.href;
var AddTitle = escape(document.title);
DrawLinks(100, 0, "smallText", "addto") 
</SCRIPT>
            <BR><BR>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=MycroXaml/dotnet9/23/2004 
            name=vote_name> <INPUT type=hidden value=/dotnet/MycroXaml.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/dotnet/MycroXaml.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <DIV style="MARGIN: 10px"><SPAN id=AdBanner5>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=4114&cb=1651695\" border=0 frameborder=0 scrolling=no width=468 height=60></IFRAME>");</SCRIPT>
            </SPAN></DIV></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="MycroXaml - The Code Project - _NET_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=109844"><IMG 
                              height=15 
                              src="MycroXaml - The Code Project - _NET_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION 
                              value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="MycroXaml - The Code Project - _NET_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 11 of 11 (Total: 
                              11) (<A 
                              href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1875439_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1875439xx></A><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=1875439#xx1875439xx" 
                                name=1875439><B>Default namespace</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1929381"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B><FONT>[Marc]</FONT></B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>21:19 2 
                                Feb 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1875439_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>To 
                                enable a default namespace, i did the 
                                following:<BR><PRE><BR>        private void ProcessNamespaces(XmlNode node)<BR>        {<BR>            nsMap = new Dictionary<STRING, string>();<BR>            foreach (XmlAttribute attr in node.Attributes)<BR>            {<BR>                if (attr.Prefix == "xmlns")<BR>                {<BR>                    nsMap[attr.LocalName] = attr.Value;<BR>                }<BR>                <B>// added by me<BR>                else if (attr.Name == "xmlns")<BR>                {<BR>                    nsMap[""] = attr.Value;<BR>                }</B><BR>            }<BR>        }<BR></PRE><BR>By 
                                the way, is this whole My(cro)Xaml thing being 
                                used/developed in any way nowadays? I like the 
                                Mycro thingy (just one class, can be used in 
                                close source app) in conjunction with VG.net 
                                (needed some tweaking though). Perhaps a bit 
                                overshadowed by the whole .Net 3 buzz, but this 
                                is still some nice work! <BR><BR>
                                <DIV class=ForumSig>
                                <HR color=white SIZE=1>
                                <SMALL>
                                <DIV 
                                style="COLOR: #000033; TEXT-ALIGN: right">"..Commit 
                                yourself to quality from day one..it's better to 
                                do nothing at all than to do something 
                                badly.."<BR>-- Mark McCormick</DIV>
                                <HR color=white SIZE=1>
                                || <A href="http://folding.stanford.edu/" 
                                target=_blank rel=nofollow>Fold With Us!</A> || 
                                <A href="http://www.pensieve.org/" target=_blank 
                                rel=nofollow>Pensieve</A> || <A 
                                href="http://www.vgdotnet.com/" target=_blank 
                                rel=nofollow>VG.Net</A> 
                                ||</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1875439">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1875439">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=1875439&amp;forumid=109844&amp;select=1875439#xx1875439xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1875439#xx1875439xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1875439#xx1875439xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1929381,1875439);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1222033_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1222033xx></A><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=1222033#xx1222033xx" 
                                name=1222033><B>License</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=476847"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Daniel 
                                Grunwald</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>8:36 10 
                                Sep 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1222033_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>What is 
                                the license of MycroXaml?<BR>It is GPL like 
                                MyXaml or is it possible to use MycroXaml in 
                                closed source applications? 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1222033">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1222033">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=1222033&amp;forumid=109844&amp;select=1222033#xx1222033xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1222033#xx1222033xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1222033#xx1222033xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(476847,1222033);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1222034_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1222034xx></A><IMG 
                                height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=1222034#xx1222034xx" 
                                name=1222034>Re: License</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=36803"><IMG 
                                title="CodeProject Protector - Click for Profile" 
                                height=16 
                                src="MycroXaml - The Code Project - _NET_files/protect_icon.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Marc 
Clifton&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:38 10 Sep 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1222034_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent><SMALL><B>Daniel Grunwald 
                                wrote:</B></SMALL><BR><I>It is GPL like MyXaml 
                                or is it possible to use MycroXaml in closed 
                                source applications? </I><BR><BR>It's BSD, so 
                                you can use it on closed source 
                                applications.<BR><BR>Marc <BR><BR><A 
                                href="http://www.marcclifton.com/">My 
                                website</A><BR><A 
                                href="http://www.codeproject.com/useritems/Traceract.asp">Traceract</A><BR><A 
                                href="http://www.codeproject.com/useritems/simpledatabinding.asp">Understanding 
                                Simple Data Binding</A><BR><A 
                                href="http://www.codeproject.com/useritems/DiaryOfACeoPreface.asp">Diary 
                                Of A CEO - 
                                Preface</A><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1222034">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1222034">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=1222033&amp;forumid=109844&amp;select=1222034#xx1222034xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1222034#xx1222034xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1222033#xx1222033xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(36803,1222034);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1112640_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1112640xx></A><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=1112640#xx1112640xx" 
                                name=1112640><B>Problem with 
                                Type.GetType()</B></A></TD>
                                <TD vAlign=bottom noWrap><IMG height=13 
                                alt="Unconfirmed/Anonymous posting" 
                                src="MycroXaml - The Code Project - _NET_files/usersuss.gif" 
                                width=15></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Seredenlo 
                                Dmitry</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:16 20 
                                May 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1112640_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>After 
                                manually adding <I>colorPicker.mycroxaml</I>, 
                                trying to build demo project, I get next error 
                                at MycroParser.cs_76: <BR><BR>"Assertion Failed: 
                                Abort=Quit, Retry=Debug, Ignore=Continue<BR>Type 
                                System.Windows.Forms.Form, 
                                System.Windows.Forms,<BR>Version=1.0.5000.0, 
                                Culture=neutral,<BR>PublicKeyToken=b77a5c561934e089 
                                could not be determined.<BR>at 
                                Parser.ProcessNode(XmlNode node, Object parent) 
                                c:\work\codegenerator\mycroxaml_demo\mycroparser.cs(80)<BR>at 
                                Parser.Load(XmlDocument doc, String objectName, 
                                Object eventSink) 
                                c:\work\codegenerator\mycroxaml_demo\mycroparser.cs(37)<BR>at 
                                Startup..ctor() 
                                c:\work\codegenerator\mycroxaml_demo\demo\demo.cs(41)<BR>at 
                                Startup.Main() 
                                c:\work\codegenerator\mycroxaml_demo\demo\demo.cs(19)".<BR>How 
                                can I solve this problem?<BR><BR>P.S. Assembly 
                                <I>MycroXaml.MxContainer</I> also absent in the 
                                demo project<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1112640">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1112640">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=1112640&amp;forumid=109844&amp;select=1112640#xx1112640xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1112640#xx1112640xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1112640#xx1112640xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1112640">Modify</A> 
                                | <A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1112640">Delete</A>]<BR>Score: 
                                1.0 (1 vote).
                                <SCRIPT language=Javascript>MsgVoteForm(0,1112640);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1412073_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1412073xx></A><IMG 
                                height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=1412073#xx1412073xx" 
                                name=1412073>Re: Problem with 
                                Type.GetType()</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2170344"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>thebeekeeper&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:46 17 Mar 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1412073_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This 
                                question is pretty old, but I just ran into the 
                                same problem. You can get the missing dll from 
                                <A 
                                href="http://www.codeproject.com/dotnet/DeclarativePropertyGrid.asp">this 
                                article</A>. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1412073">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=1412073">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=1112640&amp;forumid=109844&amp;select=1412073#xx1412073xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1412073#xx1412073xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=1112640#xx1112640xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2170344,1412073);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=937854_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx937854xx></A><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=937854#xx937854xx" 
                                name=937854><B>Culture Info problem</B></A></TD>
                                <TD vAlign=bottom noWrap><IMG height=13 
                                alt="Unconfirmed/Anonymous posting" 
                                src="MycroXaml - The Code Project - _NET_files/usersuss.gif" 
                                width=15></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Harri 
                                Väinölä</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>6:40 1 Oct 
                                '04</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=937854_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I think 
                                MycroParser has problems when 
                                Windows.RegionalSetting.Location is something 
                                else than English. Problem can be corrected by 
                                this, MycroParser.Line_247<BR><BR>//object 
                                val=tc.ConvertFrom(pvalue);<BR><BR>System.Globalization.CultureInfo 
                                culture = new System.Globalization.CultureInfo 
                                ("en-US", false);<BR>object val=tc.ConvertFrom 
                                (null, culture ,pvalue);<BR><BR>But I am not 
                                sure is it the right way to correct that 
                                problem. <BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=937854">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=937854">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=937854&amp;forumid=109844&amp;select=937854#xx937854xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=937854#xx937854xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=937854#xx937854xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=937854">Modify</A> 
                                | <A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=937854">Delete</A>]<BR>Score: 
                                2.0 (1 vote).
                                <SCRIPT language=Javascript>MsgVoteForm(0,937854);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=951389_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx951389xx></A><IMG 
                                height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=951389#xx951389xx" 
                                name=951389>Re: Culture Info problem</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=476847"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>ynik&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>6:37 19 Oct 
                                '04&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=951389_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Better 
                                use InvariantCulture:<BR>object 
                                val=tc.ConvertFrom(null, 
                                System.Globalization.CultureInfo.InvariantCulture, 
                                pvalue);<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=951389">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=951389">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=937854&amp;forumid=109844&amp;select=951389#xx951389xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=951389#xx951389xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=937854#xx937854xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(476847,951389);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=951396_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx951396xx></A><IMG 
                                height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=951396#xx951396xx" 
                                name=951396>Re: Culture Info problem</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=36803"><IMG 
                                title="CodeProject Protector - Click for Profile" 
                                height=16 
                                src="MycroXaml - The Code Project - _NET_files/protect_icon.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Marc 
Clifton&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>6:52 19 Oct 
                                '04&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=951396_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=18><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Harri,<BR><BR>Can you check to see 
                                if:<BR><BR>tc.ConvertFromInvariantString(pvalue);<BR><BR>works? 
                                That's what I use in MyXaml after someone 
                                suggested it.<BR><BR>Marc <BR><BR><A 
                                href="http://www.myxaml.com/">MyXaml</A><BR><A 
                                href="http://aut.tigris.org/">Advanced Unit 
                                Testing</A><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=951396">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=951396">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=937854&amp;forumid=109844&amp;select=951396#xx951396xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=951396#xx951396xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=937854#xx937854xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(36803,951396);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=951419_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx951419xx></A><IMG 
                                height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=36><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=951419#xx951419xx" 
                                name=951419>Re: Culture Info problem</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=784810"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Väinölä 
                                Harri&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7:39 19 Oct 
                                '04&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=951419_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MycroXaml - The Code Project - _NET_files/ind.gif" 
                                width=36><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>YES, 
                                syntax tc.ConvertFromInvariantString(pvalue); 
                                works ok.<BR><BR>; is common delimiter in 
                                Europe.<BR><BR>Harri <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=951419">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=951419">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=937854&amp;forumid=109844&amp;select=951419#xx951419xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=951419#xx951419xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=937854#xx937854xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(784810,951419);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=935672_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx935672xx></A><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=935672#xx935672xx" 
                                name=935672><B>XMLDocument</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=161720"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>SHG</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>3:13 29 
                                Sep 
                            '04</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=935672_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>My 
                                interest in this program is the use of 
                                XMLDocument, I have used XMLDocument in a 
                                released program but it had a memoryleak!! the 
                                result was a Windows crash after 2 hours. I had 
                                to recode without XMLDocument.<BR><BR>So I 
                                wanted to run the demo with boundschecker 
                                but:<BR>The demo prj. have a reference that is 
                                not used!<BR>And at runtime 
                                ColorPicker.mycroxaml is 
                                missing!<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=935672">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=935672">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=935672&amp;forumid=109844&amp;select=935672#xx935672xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=935672#xx935672xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=935672#xx935672xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.6 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(161720,935672);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=932374_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx932374xx></A><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;forumid=109844&amp;select=932374#xx932374xx" 
                                name=932374><B>Is vs As</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=245321"><IMG 
                                title="Click for User Profile" height=15 
                                src="MycroXaml - The Code Project - _NET_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>bobddddd</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:51 24 
                                Sep 
                            '04</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=932374_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MycroXaml - The Code Project - _NET_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Marc 
                                awesome article as you always produce. I wanted 
                                to point out one small nit picky pattern I see 
                                and since many follow your code and use it as a 
                                learning tool I htought I would bring it up. The 
                                "Is" keyword should be avoided if you then act 
                                upon the "Is" by conversion into the type. 
                                Following the pattern as coded resutls in 2 
                                conversions to the type (once by the is and once 
                                within the if). Instead you should use 'As' and 
                                check for null<BR><BR><CODE><BR>if (ret is 
                                ISupportInitialize) //conversion 
                                1<BR>{<BR>((ISupportInitialize)ret).EndInit(); 
                                //conversion 2<BR>}<BR></CODE><BR><BR>should be 
                                rewritten as 
                                <BR><BR><CODE><BR>ISupportInitialize 
                                _iSupportInit = ret as ISupportInitialize 
                                //conversion 1<BR>if (iSupportInit 
                                !=null)<BR>{<BR>_iSupportInit.EndInit();<BR>}<BR></CODE><BR><BR>Keep 
                                up the great work! You have many many followers! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=932374">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/dotnet/MycroXaml.asp&amp;df=100&amp;forumid=109844&amp;select=932374">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?df=100&amp;tid=932374&amp;forumid=109844&amp;select=932374#xx932374xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=932374#xx932374xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/dotnet/MycroXaml.asp?msg=932374#xx932374xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 3.7 (6 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(245321,932374);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MycroXaml - The Code Project - _NET_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 22:02 Saturday 
                              20th October, 2007</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="MycroXaml - The Code Project - _NET_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="MycroXaml - The Code Project - _NET_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="MycroXaml - The Code Project - _NET_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="MycroXaml - The Code Project - _NET_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="MycroXaml - The Code Project - _NET_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="MycroXaml - The Code Project - _NET_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 23 Sep 2004 </TD>
                <TD class=SmallText align=right>Article content copyright Marc 
                  Clifton, 2004<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web18 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT src="MycroXaml - The Code Project - _NET_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="MycroXaml - The Code Project - _NET_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
