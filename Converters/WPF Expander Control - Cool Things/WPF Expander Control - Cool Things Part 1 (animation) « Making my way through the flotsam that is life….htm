<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0093)http://ewilkerson.wordpress.com/2007/01/03/wpf-expander-control-cool-things-part-1-animation/ -->
<HTML lang=en dir=ltr xmlns="http://www.w3.org/1999/xhtml"><HEAD 
profile=http://gmpg.org/xfn/11><TITLE>WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…</TITLE>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK media=screen 
href="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/style.css" 
type=text/css rel=stylesheet><LINK title="RSS 2.0" 
href="http://ewilkerson.wordpress.com/feed/" type=application/rss+xml 
rel=alternate><LINK href="http://ewilkerson.wordpress.com/xmlrpc.php" 
rel=pingback><LINK title="May 2007" 
href="http://ewilkerson.wordpress.com/2007/05/" rel=archives><LINK 
title="April 2007" href="http://ewilkerson.wordpress.com/2007/04/" 
rel=archives><LINK title="February 2007" 
href="http://ewilkerson.wordpress.com/2007/02/" rel=archives><LINK 
title="January 2007" href="http://ewilkerson.wordpress.com/2007/01/" 
rel=archives><LINK 
href="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/global.css" 
type=text/css rel=stylesheet><LINK title=RSD 
href="http://ewilkerson.wordpress.com/xmlrpc.php?rsd" type=application/rsd+xml 
rel=EditURI>
<SCRIPT type=text/javascript>

function addLoadEvent(func) {
  var oldonload = window.onload;
  if (typeof window.onload != 'function') {
    window.onload = func;
  } else {
    window.onload = function() {
      oldonload();
      func();
    }
  }
}
</SCRIPT>

<SCRIPT 
src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/urchin.js" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-52447-2";

_udn = "wordpress.com";
urchinTracker();
</SCRIPT>
<LINK title="Atom API" href="http://ewilkerson.wordpress.com/wp-app.php" 
type=application/atomserv+xml rel=introspection><LINK 
href="http://ewilkerson.wordpress.com/?openidserver=1" rel=openid.server>
<SCRIPT id=snap_preview_anywhere 
src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/snap_preview_anywhere.htm" 
defer type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<DIV id=wrapper>
<DIV id=header>
<DIV id=title>
<H1><A href="http://ewilkerson.wordpress.com/">Making my way through the flotsam 
that is life…</A></H1></DIV></DIV>
<DIV id=content>
<DIV class=post id=post-4>
<H2 class=posttitle><A 
title="Permanent link toWPF Expander Control - Cool Things Part 1&nbsp;(animation)" 
href="http://ewilkerson.wordpress.com/2007/01/03/wpf-expander-control-cool-things-part-1-animation/">WPF 
Expander Control - Cool Things Part 1&nbsp;(animation)</A></H2>
<P class=commentmeta>January 3rd, 2007 at 12:17 am (<A 
title="View all posts in .Net 3.0" href="http://wordpress.com/tag/net-30/" 
rel="category tag">.Net 3.0</A>, <A title="View all posts in C#" 
href="http://wordpress.com/tag/c/" rel="category tag">C#</A>, <A 
title="View all posts in Programming" 
href="http://wordpress.com/tag/programming/" rel="category tag">Programming</A>, 
<A title="View all posts in WPF" href="http://wordpress.com/tag/wpf/" 
rel="category tag">WPF</A>) </P>
<DIV class=snap_preview>
<P>Hmm…this is by no means a tutorial. There - that’s my disclaimer. So now that 
I’ve absolved myself from all WPF-sin, we can get started. WPF…that’s Windows 
Presentation Foundation for the layman…has been around for&nbsp;over a year now 
in multitude of incarnations (Avalon, WinFX, etc.) , and&nbsp;is the backbone 
Microsoft’s new OS “Vista”. If you didn’t already know, WPF uses a customized 
XML language called XAML for creating/rendering all of its controls. XAML 
(rhymes with camel) stands for <STRONG>Extensible Application Markup 
Language…</STRONG>and quite honestly…is the coolest thing since sliced 
bread.</P>
<P><SPAN id=more-4></SPAN></P>
<P>Because it’s an XML-based language…it gives the developer and end-user easy 
to use, yet very powerful control over customization/theming&nbsp;and 
templating. I’m not going to get into alot of&nbsp;detail, but believe me when I 
tell you that this can/will radically change the way alot of people handle the 
UI side of things. Custom controls are a given in today’s enterprise world 
because they’re scalable and reusable. They save you tons of&nbsp; time because 
you don’t have to re-invent the wheel everytime you go to make a new 
application. It’s the essence of object-oriented programming.</P>
<P>Now, imagine that every control at your disposal, even the ones straight out 
of the box, are custom controls. That’s what WPF gives you. You can apply 
branding/theming to every button, in every application you make just by 
including another XAML file or two. And not only that, you can make all you 
controls “act” a certain way in a multitude of different situations. Some may 
argue that this functionality (or&nbsp;some subset thereof) was already 
available in .NET 2.0…or on some other platform…or in some other progamming 
language/environment…but for those people like me (targetting a platform that 
has about 98% market share…or work in a corporate environment&nbsp;where all 
machines are running Windows XP) WPF and its child technologies are a very 
powerful and scalable solution. It gives you great user experiences in and out 
of the browser, and helps you practice the “Law of Least Privilege” with it’s 
sandboxed XBAPs (the web&nbsp;applications formerly known as XAPPs).</P>
<P>Now like I said, this is a great technology…and it’s been around for quite 
some time. But guess what…almost nobody I know uses it…and tutorials are a 
little scarce. But if you’ve made it to this blog…obviously you’ve just started 
to use it…or have been using it…and you need a little help with one of the most 
obviously “cool” things that you don’t get out of the box with WPF. Now…the 
Expander control is very cool when you first include it in you application. It’s 
basically a collapsible menu of sorts.&nbsp;If you’re like me, you not only 
expected it to animate in/out, but you also&nbsp;probably expected it 
to&nbsp;retract when you moved your mouse off of it. BUT…no such luck. The whole 
purpose of XAML/WPF is to give you what’s necessary(the bare minimum)&nbsp;…and 
let you build the rest. So let’s get started with the animation bit, shall 
we?</P>
<P>Before we start, I’m going to assume that you’re using Microsoft Expression 
Blend (currently in Beta 1) and/or&nbsp;Microsoft Visual Studio.&nbsp;There are 
a couple of different ways to actually handle the animation of the expander 
control. First, let’s take a look at&nbsp;the programmatic way to handle the 
expander control’s animation.</P>
<P>Programmatic animation is alot more intuitive to developers coming from a 
strong&nbsp;.NET&nbsp;background…or those who don’t like firing up another 
application just to <STRONG>quickly</STRONG> apply an animation effect. The main 
drawback with programmatic animation is that it doesn’t animate to scale — 
meaning that if your user changes the size of the application window, the 
animation isn’t scaled to meet the change in window size (unless you scale your 
animations by using percentages). Make sure to include the 
System.Windows.Media.Animation namespace in your code-behind file.&nbsp;<FONT 
color=#0000ff> </FONT></P>
<P>First you need to add event handlers for the Collapased/Expanded events of 
the Expander control.&nbsp; Here, we have an Expander Control named expMenu.</P>
<P><CODE><BR><FONT color=#0000ff size=1>public</FONT><FONT size=2> </FONT><FONT 
color=#010001 size=1>Window1</FONT><FONT size=1>()</FONT><BR><FONT 
size=1>{</FONT><CODE><FONT size=1> </FONT><FONT color=#010001 
size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent</FONT><FONT 
size=1>();</FONT><FONT size=1><FONT color=#008000 
size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp; //add handlers for the expanded/collapsed 
events of the expMenu Control</FONT></FONT></CODE></CODE><CODE> 
</CODE><CODE><CODE><FONT color=#008000 size=1>&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT></CODE><CODE><FONT size=1><FONT color=#010001>expMenu</FONT>.<FONT 
color=#010001>Collapsed</FONT> += <FONT color=#0000ff>new</FONT> <FONT 
color=#2b91af>RoutedEventHandler</FONT>(<FONT 
color=#010001>expMenu_Collapsed</FONT>);</FONT><FONT color=#010001><BR><FONT 
size=1>&nbsp;&nbsp;&nbsp;&nbsp; expMenu</FONT></FONT><FONT size=1>.<FONT 
color=#010001>Expanded</FONT> += <FONT color=#0000ff>new</FONT> <FONT 
color=#2b91af>RoutedEventHandler</FONT>(<FONT 
color=#010001>expMenu_Expanded</FONT>);<BR>}</FONT></CODE></CODE></P>
<P>Next you simply need to create two&nbsp;DoubleAnimation objects that animate 
the Width property of an Expander Control. So first, we place the necessary 
DoubleAnimation in the Expander.Collapsed event handler.</P>
<P><CODE><BR><FONT color=#0000ff size=1>void</FONT><FONT size=1> </FONT><FONT 
color=#010001 size=1>expMenu_Collapsed</FONT><FONT size=1>(</FONT><FONT 
color=#0000ff size=1>object</FONT><FONT size=1> </FONT><FONT color=#010001 
size=1>sender</FONT><FONT size=1>, </FONT><FONT color=#2b91af 
size=1>RoutedEventArgs</FONT><FONT size=1> </FONT><FONT color=#010001 
size=1>e</FONT><FONT size=1>)</FONT><FONT size=1><BR>{</FONT></CODE><CODE><FONT 
size=1><FONT color=#2b91af 
size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DoubleAnimation</FONT><FONT size=1> 
</FONT><FONT color=#010001 size=1>dblAnimation</FONT><FONT size=1> = 
</FONT><FONT color=#0000ff size=1>new</FONT><FONT size=1> </FONT><FONT 
color=#2b91af size=1>DoubleAnimation</FONT><FONT 
size=1>();</FONT></FONT></CODE><CODE><FONT size=1><FONT size=1><FONT 
color=#008000 size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//set the width that we 
want the expander control to<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//have when 
animation is complete</FONT></FONT></FONT></CODE><CODE><FONT color=#010001 
size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dblAnimation</FONT><FONT 
size=1>.</FONT><FONT color=#010001 size=1>To</FONT><FONT size=1> = 
35;</FONT></CODE><CODE></CODE><CODE><FONT size=1><FONT color=#008000 
size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//set the duration of this animation - 
generally 1/4 or less looks best</FONT></FONT><FONT size=1> </FONT><FONT 
color=#010001 size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dblAnimation</FONT><FONT 
size=1>.</FONT><FONT color=#010001 size=1>Duration</FONT><FONT size=1> = 
</FONT><FONT color=#0000ff size=1>new</FONT><FONT size=1> </FONT><FONT 
color=#2b91af size=1>Duration</FONT><FONT size=1>(</FONT><FONT color=#2b91af 
size=1>TimeSpan</FONT><FONT size=1>.</FONT><FONT color=#010001 
size=1>FromSeconds</FONT><FONT size=1>(.25));</FONT><FONT size=1><FONT 
color=#008000 size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//begin the animation on 
the width property of the expMenu control<FONT size=1><FONT color=#010001 
size=1><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expMenu</FONT><FONT 
size=1>.</FONT><FONT color=#010001 size=1>BeginAnimation</FONT><FONT 
size=1>(</FONT><FONT color=#2b91af size=1>Expander</FONT><FONT 
size=1>.</FONT><FONT color=#010001 size=1>WidthProperty</FONT><FONT size=1>, 
</FONT><FONT color=#010001 size=1>dblAnimation</FONT><FONT 
size=1>);</FONT></FONT></FONT></FONT><FONT size=1><FONT color=#008000 
size=1><FONT size=1><FONT size=1>}</FONT></FONT></FONT></FONT></CODE></P>
<P>You should place the same thing in your Expander.Expanded event handler, but 
change the DoubleAnimation’s “To” value to the fully expanded width. After that, 
compile &amp; run your application and&nbsp;your Expander should&nbsp;animate. 
You can also use this method to animate the Opacity of the Expander so that it’s 
less visible when collapsed. You can reuse the same DoubleAnimation 
by&nbsp;using the Expander.OpacityProperty in the Expander.BeginAnimation method 
and setting the the “To” property to the appropriate value.</P>
<P>So that’s programmatic animation. Next…I’ll blog about using 
Expression&nbsp;Blend to do the same thing.</P></DIV></DIV><!-- You can start editing here. -->
<H3 id=comments>3 Comments</H3>
<OL class=snap_preview id=commentlist>
  <LI id=comment-2>
  <H4 class=commentauthor>jaydev said,</H4>
  <P class=commentmeta>February 6, 2007 at <A 
  title="Permanent link to this comment" 
  href="http://ewilkerson.wordpress.com/2007/01/03/wpf-expander-control-cool-things-part-1-animation/#comment-2">3:24 
  am</A> </P>
  <P>I was able to animate the expansion of the Expander but the Collapse just 
  snaps back abruptly not showing any animated effect - could you pls advise on 
  what I might be missing out on. Thanks!!</P>
  <LI id=comment-3>
  <H4 class=commentauthor><A href="http://ewilkerson.wordpress.com/" 
  rel="external nofollow">Ernest Wilkerson</A> said,</H4>
  <P class=commentmeta>February 6, 2007 at <A 
  title="Permanent link to this comment" 
  href="http://ewilkerson.wordpress.com/2007/01/03/wpf-expander-control-cool-things-part-1-animation/#comment-3">7:58 
  am</A> </P>
  <P>Post your code for expanding/collapsing here so that I can see what you 
  did. One reason may be that you need to “declare” the “From” property of your 
  animation. Typically you don’t have to, but that may solve your problem.</P>
  <LI id=comment-21>
  <H4 class=commentauthor><A href="http://chakkaradeep.wordpress.com/" 
  rel="external nofollow">Chaks</A> said,</H4>
  <P class=commentmeta>October 3, 2007 at <A 
  title="Permanent link to this comment" 
  href="http://ewilkerson.wordpress.com/2007/01/03/wpf-expander-control-cool-things-part-1-animation/#comment-21">3:30 
  am</A> </P>
  <P>I get this error -<BR>{”Cannot animate the ‘Width’ property on a 
  ‘System.Windows.Controls.Expander’ using a 
  ‘System.Windows.Media.Animation.DoubleAnimation’. For details see the inner 
  exception.”}</P>
  <P>Can you please upload source code for your posts <IMG class=wp-smiley 
  alt=:) 
  src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/icon_smile.gif"> 
  . It will be really helpful <IMG class=wp-smiley alt=:) 
  src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/icon_smile.gif"></P></LI></OL>
<H3 id=postcomment>Post a Comment</H3>
<P>You must be <A 
href="http://ewilkerson.wordpress.com/wp-login.php?redirect_to=http://ewilkerson.wordpress.com/2007/01/03/wpf-expander-control-cool-things-part-1-animation/">logged 
in</A> to post a comment.</P></DIV>
<DIV id=sidebar>
<UL>
  <LI class=pagenav>
  <H2>Pages</H2>
  <UL>
    <LI class="page_item page-item-2"><A title=About 
    href="http://ewilkerson.wordpress.com/about/">About</A> </LI></UL>
  <LI>
  <H2>Archives</H2>
  <UL>
    <LI><A title="May 2007" href="http://ewilkerson.wordpress.com/2007/05/">May 
    2007</A> 
    <LI><A title="April 2007" 
    href="http://ewilkerson.wordpress.com/2007/04/">April 2007</A> 
    <LI><A title="February 2007" 
    href="http://ewilkerson.wordpress.com/2007/02/">February 2007</A> 
    <LI><A title="January 2007" 
    href="http://ewilkerson.wordpress.com/2007/01/">January 2007</A> </LI></UL>
  <LI>
  <H2>Categories</H2>
  <UL>
    <LI class="cat-item cat-item-342385"><A 
    title="View all posts filed under .Net 3.0" 
    href="http://ewilkerson.wordpress.com/category/net-30/">.Net 3.0</A> 
    <LI class="cat-item cat-item-2426"><A title="View all posts filed under C#" 
    href="http://ewilkerson.wordpress.com/category/c/">C#</A> 
    <LI class="cat-item cat-item-23638"><A 
    title="View all posts filed under Dreamcast" 
    href="http://ewilkerson.wordpress.com/category/dreamcast/">Dreamcast</A> 
    <LI class="cat-item cat-item-1754"><A 
    title="View all posts filed under My Life" 
    href="http://ewilkerson.wordpress.com/category/my-life/">My Life</A> 
    <LI class="cat-item cat-item-196"><A 
    title="View all posts filed under Programming" 
    href="http://ewilkerson.wordpress.com/category/programming/">Programming</A> 

    <UL class=children>
      <LI class="cat-item cat-item-447065"><A 
      title="My dreamcast emulator project…what can I say?" 
      href="http://ewilkerson.wordpress.com/category/programming/naomi/">Naomi</A> 

      <LI class="cat-item cat-item-46652"><A 
      title="View all posts filed under WPF" 
      href="http://ewilkerson.wordpress.com/category/programming/wpf/">WPF</A> 
      </LI></UL>
    <LI class="cat-item cat-item-1"><A 
    title="View all posts filed under Uncategorized" 
    href="http://ewilkerson.wordpress.com/category/uncategorized/">Uncategorized</A> 
    </LI></UL>
  <LI>
  <H2>Search</H2>
  <FORM action=http://ewilkerson.wordpress.com/ method=get>
  <P><INPUT name=s> <INPUT type=submit value=Go> </P></FORM>
  <LI>
  <H2>Meta</H2>
  <UL>
    <LI><A href="http://ewilkerson.wordpress.com/wp-login.php">Login</A> 
    <LI><A title="Syndicate this site using RSS" 
    href="http://ewilkerson.wordpress.com/feed/"><ABBR 
    title="Really Simple Syndication">RSS</ABBR> Feed</A> 
    <LI><A 
    title="Powered by WordPress, state-of-the-art semantic personal publishing platform." 
    href="http://wordpress.com/">WordPress.com</A> </LI></UL></LI></UL></DIV>
<DIV id=footer>
<P><A title="This page validates as XHTML 1.0 Transitional" 
href="http://validator.w3.org/check/referer"><ABBR 
title="eXtensible HyperText Markup Language">XHTML</ABBR></A> · <A 
title="This page validates as CSS" 
href="http://jigsaw.w3.org/css-validator/check/referer"><ABBR 
title="Cascading Style Sheets">CSS</ABBR></A> · Theme: Dusk by <A 
href="http://beccary.com/" rel=designer>Beccary</A>. <A 
href="http://wordpress.com/" rel=generator>Blog at WordPress.com</A>. 
</P></DIV></DIV>
<SCRIPT 
src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/quant.js" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>_qmeta="qc:adt=0;bti=Making+my+way+through+the+flotsam+that+is+life...;lan=en;dat=20070103;pti=WPF+Expander+Control+-+Cool+Things+Part+1+%28animation%29;own=ewilkerson";_qacct="p-18-mFEk4J448M";quantserve();</SCRIPT>
<NOSCRIPT>
<P><IMG style="DISPLAY: none" height=1 alt="" 
src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/p-18-mFEk4J448M.gif" 
width=1></P></NOSCRIPT>
<SCRIPT 
src="WPF Expander Control - Cool Things Part 1 (animation) « Making my way through the flotsam that is life…_files/w.js" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
st_go({blog:'699068',v:'wpcom',post:'4',subd:'ewilkerson'});
ex_go({x_theme:'dusk',x_lang:'en',x_dc:'dfw',x_adt:'0',x_public:'1',x_mapped:'0',x_loggedin:'0',x_noads:'seen,notsearch',x_ads:'no',x_plugin:'snap',x_pagetype:'permalink',x_postage:'30to365'});
addLoadEvent(function(){linktracker_init(699068,4);});
</SCRIPT>
</BODY></HTML>
