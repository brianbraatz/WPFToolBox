<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>Dante's blog : Variable Value Converters</title>
 




<meta name="description" content="I've been asked how to create a Value Converter that you can configure the behavior of. In my Total Training series I showed you how to create a Value Converter that would return a color, Red if the value was below a hard coded value, Yellow if it's between">
<meta name="GENERATOR" content="CommunityServer 2.1 SP1 (Build: 61025.2)">
<link rel="pingback" href="http://blogs.msdn.com/danteg/pingback.aspx">
<link rel="stylesheet" href="variable-value-converters.aspx_files/style.css" type="text/css" media="screen">
<link rel="stylesheet" href="variable-value-converters.aspx_files/print.htm" type="text/css" media="print">
<link rel="stylesheet" href="variable-value-converters.aspx_files/fire.css" type="text/css" media="screen">
<link rel="shortcut icon" type="image/ico" href="http://blogs.msdn.com/favicon.ico">
<link rel="alternate" type="application/rss+xml" title="Dante's blog (RSS 2.0)" href="http://blogs.msdn.com/danteg/rss.xml">
<link rel="alternate" type="application/atom+xml" title="Dante's blog (Atom 1.0)" href="http://blogs.msdn.com/danteg/atom.xml">
<link rel="alternate" type="application/rss+xml" title="Variable Value Converters Comment RSS (RSS 2.0)" href="http://blogs.msdn.com/danteg/commentrss.aspx?PostID=4088213">

	<script src="variable-value-converters.aspx_files/global.js" type="text/javascript"></script>
<style>
.DoNotDisplay { display: none; }
</style></head><body>
<form name="aspnetForm" method="post" action="/danteg/archive/2007/07/27/variable-value-converters.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="aspnetForm">
<div>
<input name="__EVENTTARGET" id="__EVENTTARGET" value="" type="hidden">
<input name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" type="hidden">
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFI2N0bDAwJF8kY3RsMDAkXyRidCRfJHdzJF8kU2VhcmNoQm94OF9SPxZcTrUZtH+KlInBIuHdXL8=" type="hidden">
</div>

<script type="text/javascript">
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script>


<script src="variable-value-converters.aspx_files/WebResource.js" type="text/javascript"></script>

<script language="javascript" type="text/javascript" src="variable-value-converters.aspx_files/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</script><script language="javascript" type="text/javascript">
var RatingControlAJAX = {
"SaveRating":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Blogs.Controls.BlogRatePost',id,'SaveRating',[p0],cb,0,0,0,1);}};
</script><script language="javascript" type="text/javascript">
var ThreadSubscribeLinkButton = {
"ToggleEmailReplies":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Controls.ThreadSubscribeLinkButton',id,'ToggleEmailReplies',[p0],cb,0,0,0,0);}};
</script><script type="text/javascript" src="variable-value-converters.aspx_files/ratingcontrol.js"></script><script language="JavaScript" type="text/javascript">var ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = false;var ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = false;function updateSubscriptionText() {if(ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus == true) {document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Stop sending me email alerts for this post';} else {document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Send me email alerts for new comments to this post';}}function toggleSubscription() {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = true;document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Updating email notifications...';ThreadSubscribeLinkButton.ToggleEmailReplies('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton',526771, toggleSubscriptionCallback);}function toggleSubscriptionCallback(response) {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = false;if((response.error == null) && (response.value == true)) {if(ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus == true) {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = false;} else {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = true;}updateSubscriptionText();} else {updateSubscriptionText();alert('An error happened while processing your request.  Please notify an administrator and try again later.');}}</script>
<script src="variable-value-converters.aspx_files/WebResource_002.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</script>

			
<div id="masthead">
	
		<div id="welcome" align="right">
			
					Signed in as <a href="http://blogs.msdn.com/user/EditProfile.aspx?ReturnUrl=/blogs/post.aspx?App=danteg&amp;y=2007&amp;m=07&amp;d=27&amp;PostName=variable-value-converters">bbraatz</a>
 | <a id="ctl00___ctl00___duw1_rc1___logout" href="http://blogs.msdn.com/logout.aspx">Sign out</a>



				
			 | 
			<a id="ctl00___ctl00___duw1_Faq1" href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</a>
		</div>
	
</div>
<div id="wrapper">
	<div id="container">
		<div id="header">
			
<div id="title">
	<div id="SearchSideBar">
		
<div id="search">
	<input name="ctl00$_$ctl00$_$bt$_$ws$_$SearchBox" id="ctl00___ctl00___bt___ws___SearchBox" class="searchBox" onkeydown="KeyDownHandlerctl00___ctl00___bt___ws___SearchButton(event);" type="text">
	<a id="ctl00___ctl00___bt___ws___SearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$bt$_$ws$_$SearchButton','')">Search</a>
</div>	
	</div>
	<h1><a id="ctl00___ctl00___bt___BlogTitle" class="headermaintitle" href="http://blogs.msdn.com/danteg/default.aspx">Dante's blog</a></h1>
	<p id="tagline"></p>
</div>
<div id="nav">
	<div id="SubscriptionsSideBar">
		
<div id="subscriptions">
<ul>
	<li><a id="ctl00___ctl00___bt___s___rss" href="http://blogs.msdn.com/danteg/rss.xml">RSS 2.0</a></li>
	<li><a id="ctl00___ctl00___bt___s___atom" href="http://blogs.msdn.com/danteg/atom.xml">Atom 1.0</a></li>
	<li><a id="ctl00___ctl00___bt___s___email" href="http://blogs.msdn.com/danteg/emailsubscriptions.aspx">Email alerts</a></li>
</ul></div>
	</div>
	<ul>
		<li><a id="ctl00___ctl00___bt___home" href="http://blogs.msdn.com/danteg/default.aspx">Home</a></li>
		<li><a id="ctl00___ctl00___bt___Aboutlink1" href="http://blogs.msdn.com/danteg/about.aspx">About</a></li>
		<li><a id="ctl00___ctl00___bt___Contactlink1" href="http://blogs.msdn.com/danteg/contact.aspx">Email</a></li>
	</ul>
</div></div>
		<div id="contentmargin"></div>
		<div id="contentwrapper">
			<div id="sidebar-a">
				

<div id="TasksSideBar">
	
</div>

<div id="TagSideBar">
	<h3>Tags</h3>
	<ul>
	<ul class="SidebarTagCloud">
<li class="Tag1"><a href="http://blogs.msdn.com/danteg/archive/tags/Blend/default.aspx" rel="tag">Blend</a></li>
<li class="Tag2"><a href="http://blogs.msdn.com/danteg/archive/tags/Code/default.aspx" rel="tag">Code</a></li>
<li class="Tag5"><a href="http://blogs.msdn.com/danteg/archive/tags/Databinding/default.aspx" rel="tag">Databinding</a></li>
<li class="Tag5"><a href="http://blogs.msdn.com/danteg/archive/tags/Gaming/default.aspx" rel="tag">Gaming</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/danteg/archive/tags/MyGame/default.aspx" rel="tag">MyGame</a></li>
<li class="Tag3"><a href="http://blogs.msdn.com/danteg/archive/tags/Personal/default.aspx" rel="tag">Personal</a></li>
</ul>

	</ul>
</div>

<div id="NewsSideBar">
	
</div>

<div id="ArchiveSideBar">
	

<h3>Archives</h3>
<ul>

	<li><a href="http://blogs.msdn.com/danteg/archive/2007/10.aspx">October 2007 (1)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2007/08.aspx">August 2007 (1)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2007/07.aspx">July 2007 (2)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2007/06.aspx">June 2007 (3)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2007/03.aspx">March 2007 (5)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2006/10.aspx">October 2006 (1)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2006/06.aspx">June 2006 (2)</a></li>

	<li><a href="http://blogs.msdn.com/danteg/archive/2006/03.aspx">March 2006 (2)</a></li>

</ul>
</div>

<div id="LinkSideBar">
	

</div>
			</div>
			<div id="content"><div id="content2">
				
			




<div class="post">
	<div class="posthead">
		<div class="postviewhead">
			Friday, July 27, 2007 10:52 PM
			by
			<a id="ctl00___ctl00___ctl01___Entry___AuthorLink" href="http://blogs.msdn.com/user/Profile.aspx?UserID=23987">DanteG</a> 
			<span class="CommonRateControl" id="ctl00___ctl00___ctl01___Entry___Ratings" title="Not yet rated"><img title="Poor" src="variable-value-converters.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Poor" src="variable-value-converters.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Fair" src="variable-value-converters.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Fair" src="variable-value-converters.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Average" src="variable-value-converters.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Average" src="variable-value-converters.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Good" src="variable-value-converters.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Good" src="variable-value-converters.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Excellent" src="variable-value-converters.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Excellent" src="variable-value-converters.aspx_files/star-right-off.gif" align="absmiddle" border="0"></span><input value="0" id="ctl00___ctl00___ctl01___Entry___Ratings_Value" type="hidden">
		</div>
		<h2>Variable Value Converters</h2>
	</div>
	<div class="postcontent">
I've been asked how to create a Value Converter that you can configure
the behavior of. In my Total Training series I showed you how to create
a Value Converter that would return a color, Red if the value was below
a hard coded value, Yellow if it's between the Red threshold and
another value, and Green otherwise. <p>But, in that case, the Red, Yellow and Green thresholds were hard
coded into the VC. What if I want a more generic Value Converter that I
can specify the thresholds, and even further, what if I want to specify
all the colors myself. (I.e. if the value is 100, turn Blue or
something). </p>
<p>This can be done in WPF by creating a parameterized Value Converter,
and Blend does support working with those kinds of VCs, so let's look
at how to do it.</p>
<p>First, create the simple "Rectangle, TextBlock, Slider" combination.
We're going to bring the Slider to the text of the TextBlock, and
change the Fill of the Rectangle based on the value.</p>
<p>Here's some XAML if you want to just use what I've got:</p>
<blockquote>
<p class="MsoNormal" style="line-height: normal;"><span style="font-family: 'Courier New';">&lt;Grid Margin="77,60,255,0" VerticalAlignment="Top" Height="34"&gt;<o:p></o:p></span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;Rectangle
HorizontalAlignment="Left" Margin="0,0,0,6" Width="49" Fill="#FFFFFFFF"
Stroke="#FF000000" RadiusX="7.5" RadiusY="7.5"/&gt;<o:p></o:p></span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;TextBlock
HorizontalAlignment="Left" Margin="53,6,0,0" Width="19" Text="{Binding
Path=Value, ElementName=Slider, Mode=OneWay}" TextWrapping="Wrap"/&gt;<o:p></o:p></span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;Slider Margin="76,0,0,6" x:Name="Slider" LargeChange="10" Maximum="100" SmallChange="1" IsSnapToTickEnabled="True"/&gt;<o:p></o:p></span></p>
<p class="MsoNormal" style="line-height: normal;"><span style="font-family: 'Courier New';">&lt;/Grid&gt;<o:p></o:p></span></p></blockquote>
<p mce_keep="true">&nbsp;</p>
<p>Ok, so now let's create the basic three-tier Value Converter. For
now, we're going to say a value of 80 or higher is Green, 50 or higher
is Yellow and anything else is Red. Here's the code:</p>
<div><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">using</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> System;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">using</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> System.Collections.Generic;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">using</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> System.Text;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">using</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> System.Windows.Data;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">using</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> System.Windows.Media;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">namespace</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> ValueConverters<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">class</span><font color="#000000"> </font><span style="color: rgb(43, 145, 175);">ThreeTierHardCodedVC</span><font color="#000000">: </font><span style="color: rgb(43, 145, 175);">IValueConverter<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#region</span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"> IValueConverter Members<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">public</span><font color="#000000"> </font><span style="color: blue;">object</span><font color="#000000"> Convert(</font><span style="color: blue;">object</span><font color="#000000"> value, </font><span style="color: rgb(43, 145, 175);">Type</span><font color="#000000"> targetType, </font><span style="color: blue;">object</span><font color="#000000"> parameter, System.Globalization.</font><span style="color: rgb(43, 145, 175);">CultureInfo</span><font color="#000000"> culture)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">try<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">double</span><font color="#000000"> inputValue = System.</font><span style="color: rgb(43, 145, 175);">Convert</span><font color="#000000">.ToDouble(value);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;</span><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></font><span style="color: blue;">if</span><font color="#000000"> (inputValue &gt;= 80)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">return</span><font color="#000000"> </font><span style="color: blue;">new</span><font color="#000000"> </font><span style="color: rgb(43, 145, 175);">SolidColorBrush</span><font color="#000000">(</font><span style="color: rgb(43, 145, 175);">Colors</span><font color="#000000">.Green);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">else</span><font color="#000000"> </font><span style="color: blue;">if</span><font color="#000000"> (inputValue &gt;= 50)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">return</span><font color="#000000"> </font><span style="color: blue;">new</span><font color="#000000"> </font><span style="color: rgb(43, 145, 175);">SolidColorBrush</span><font color="#000000">(</font><span style="color: rgb(43, 145, 175);">Colors</span><font color="#000000">.Yellow);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">else<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">return</span><font color="#000000"> </font><span style="color: blue;">new</span><font color="#000000"> </font><span style="color: rgb(43, 145, 175);">SolidColorBrush</span><font color="#000000">(</font><span style="color: rgb(43, 145, 175);">Colors</span><font color="#000000">.Red);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">catch</span><font color="#000000"> (</font><span style="color: rgb(43, 145, 175);">Exception</span><font color="#000000"> e)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">return</span><font color="#000000"> </font><span style="color: blue;">new</span><font color="#000000"> </font><span style="color: rgb(43, 145, 175);">SolidColorBrush</span><font color="#000000">(</font><span style="color: rgb(43, 145, 175);">Colors</span><font color="#000000">.White);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">public</span><font color="#000000"> </font><span style="color: blue;">object</span><font color="#000000"> ConvertBack(</font><span style="color: blue;">object</span><font color="#000000"> value, </font><span style="color: rgb(43, 145, 175);">Type</span><font color="#000000"> targetType, </font><span style="color: blue;">object</span><font color="#000000"> parameter, System.Globalization.</font><span style="color: rgb(43, 145, 175);">CultureInfo</span><font color="#000000"> culture)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;">throw</span><font color="#000000"> </font><span style="color: blue;">new</span><font color="#000000"> </font><span style="color: rgb(43, 145, 175);">Exception</span><font color="#000000">(</font><span style="color: rgb(163, 21, 21);">"The method or operation is not implemented."</span><font color="#000000">);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="">&nbsp;&nbsp;&nbsp;</span>#endregion<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000"><span style="">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><o:p><font color="#000000" face="Calibri" size="3">Ok,
so far so good. If you databind the fill of the Rectangle to the Text
of the TextBlock, and pass it through this VC, you'll see that the
Rectangle changes color as you move the slider. So, the next step is
how we're going to parameterize the VC. For now, I'm just going to
accept a two element string, seperated by semicolons. I use semicolons
instead of commas just so I don't need to worry about
internationalization right now.</font></o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><o:p><font color="#000000" face="Calibri" size="3">So,
in effect, if the user passes 80;50, I'm stating that when the value is
greater then 80, turn green, between 80 and 50, turn yellow, and below
50, turn red. The parameter will be passed to us (unsurprisingly) as
the parameter named "parameter". We'll take it, split it into an array,
and just parse those values out. To see how this works, try hooking up
one slider like this using 80;50 and another at 95;5.</font></o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><o:p><font color="#000000" face="Calibri" size="3">This
is better, except that you're forced into the red/yellow/green colors.
What if you want to expand on that? What if you want to be able to
configure those colors yourself. To do this, I wrote a quick function
that takes a string and converts it to a color. It's not too difficult
to write, but if you want to use it, here it is:</font></o:p></p><o:p><font color="#000000" face="Calibri" size="3">
</font></o:p><p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">private</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> <span style="color: rgb(43, 145, 175);">Color</span> GetColorFromString(<span style="color: blue;">string</span> input)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">Type</font></span><font color="#000000" face="Calibri" size="3"> colorClass = <span style="color: blue;">typeof</span>(<span style="color: rgb(43, 145, 175);">Colors</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">List</font></span><font color="#000000" face="Calibri" size="3">&lt;<span style="color: rgb(43, 145, 175);">MethodInfo</span>&gt; colorMethods = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">List</span>&lt;<span style="color: rgb(43, 145, 175);">MethodInfo</span>&gt;(colorClass.GetMethods());<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">foreach</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">MethodInfo</span> info <span style="color: blue;">in</span> colorMethods)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3"> methodName = info.Name;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">if</font></span><font color="#000000" face="Calibri" size="3"> (info.Name.StartsWith(<span style="color: rgb(163, 21, 21);">"get_"</span>))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3"> actualColor = info.Name.Split(<span style="color: rgb(163, 21, 21);">'_'</span>)[1];<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">if</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">String</span>.Compare(input, actualColor, <span style="color: blue;">true</span>) == 0)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: green;"><font color="#000000" face="Calibri" size="3">// We have a match!<o:p></o:p></font></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">Color</span>)info.Invoke(<span style="color: blue;">null</span>, <span style="color: blue;">null</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: rgb(43, 145, 175);">Colors</span>.Black;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">}</font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">This
method will take any color that is in the Colors object, and return the
appropriate color. (If someone knows an easier way to do this, I'd love
to hear it). You will need to add System.Windows.Media,
System.Windows.Data and System.Reflection to use my method. If you want
more info on the Colors class, take a look at: <a href="http://msdn2.microsoft.com/en-us/library/system.windows.media.colors.aspx">http://msdn2.microsoft.com/en-us/library/system.windows.media.colors.aspx</a></font></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">Ok,
so now with this, we're going to modify our VC one more time, to allow
it to take three arguments. My plan is to go through the arguments one
at a time, check to see if our input is greater then the first, if so,
return the color, if not, go on to the second. I'm actually going to
ignore the first piece of the final argument, since it will simply end
up as the default. I'm going to seperate the arguments with ';', and
individual pieces with a ':'. So, here's the new code:</font></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">public</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">object</span> Convert(<span style="color: blue;">object</span> value, <span style="color: rgb(43, 145, 175);">Type</span> targetType, <span style="color: blue;">object</span> parameter, System.Globalization.<span style="color: rgb(43, 145, 175);">CultureInfo</span> culture)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">try<o:p></o:p></font></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3"> paramAsString = parameter.ToString();<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3">[] splitParam = paramAsString.Split(<span style="color: rgb(163, 21, 21);">';'</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3">[] firstArgument = splitParam[0].Split(<span style="color: rgb(163, 21, 21);">':'</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3">[] secondArgument = splitParam[1].Split(<span style="color: rgb(163, 21, 21);">':'</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3">[] thirdArgument = splitParam[2].Split(<span style="color: rgb(163, 21, 21);">':'</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">double</font></span><font color="#000000" face="Calibri" size="3"> firstInterval = System.<span style="color: rgb(43, 145, 175);">Convert</span>.ToDouble(firstArgument[0]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">Color</font></span><font color="#000000" face="Calibri" size="3"> firstColor = <span style="color: blue;">this</span>.GetColorFromString(firstArgument[1]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">double</font></span><font color="#000000" face="Calibri" size="3"> secondInterval = System.<span style="color: rgb(43, 145, 175);">Convert</span>.ToDouble(secondArgument[0]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">Color</font></span><font color="#000000" face="Calibri" size="3"> secondColor = <span style="color: blue;">this</span>.GetColorFromString(secondArgument[1]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">Color</font></span><font color="#000000" face="Calibri" size="3"> thirdColor = <span style="color: blue;">this</span>.GetColorFromString(thirdArgument[1]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">double</font></span><font color="#000000" face="Calibri" size="3"> inputValue = System.<span style="color: rgb(43, 145, 175);">Convert</span>.ToDouble(value);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">if</font></span><font color="#000000" face="Calibri" size="3"> (inputValue &gt;= firstInterval)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(firstColor);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">else</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">if</span> (inputValue &gt;= secondInterval)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(secondColor);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">else<o:p></o:p></font></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(thirdColor);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">catch</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">Exception</span> e)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(<span style="color: rgb(43, 145, 175);">Colors</span>.White);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">}</font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">If
you give THIS one a try, set the parameter to something like:
95:Azure;10:Coral;0:SeaGreen. Now we've got a VC that you can configure
all three brackets, as well as the colors that go with them.</font></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">Of
course, this is hideously inelegant, so I want to make one last change.
Instead of hard coding and breaking the parameters apart this way, I'm
going to just create a loop. This will tighten up the code, and
actually allow us to go an arbitrary number of brackets. So, if you
need to have 15 different brackets of different colors from Indigo to
MintCream, you can do it. So, we'll pull those ugly "secondParameter"
lines out, and replace it with a foreach. (I've included the entire
class here, in case you want to cut and paste)</font></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">using</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> System;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">using</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> System.Collections.Generic;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">using</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> System.Text;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">using</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> System.Windows.Data;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">using</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> System.Windows.Media;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">using</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> System.Reflection;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">namespace</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> ValueConverters<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">class</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: rgb(43, 145, 175);">FullyVariableVC</span> : <span style="color: rgb(43, 145, 175);">IValueConverter<o:p></o:p></span></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">private</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: rgb(43, 145, 175);">Color</span> GetColorFromString(<span style="color: blue;">string</span> input)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">Type</font></span><font color="#000000" face="Calibri" size="3"> colorClass = <span style="color: blue;">typeof</span>(<span style="color: rgb(43, 145, 175);">Colors</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">List</font></span><font color="#000000" face="Calibri" size="3">&lt;<span style="color: rgb(43, 145, 175);">MethodInfo</span>&gt; colorMethods = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">List</span>&lt;<span style="color: rgb(43, 145, 175);">MethodInfo</span>&gt;(colorClass.GetMethods());<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">foreach</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">MethodInfo</span> info <span style="color: blue;">in</span> colorMethods)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3"> methodName = info.Name;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">if</font></span><font color="#000000" face="Calibri" size="3"> (info.Name.StartsWith(<span style="color: rgb(163, 21, 21);">"get_"</span>))<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3"> actualColor = info.Name.Split(<span style="color: rgb(163, 21, 21);">'_'</span>)[1];<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">if</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">String</span>.Compare(input, actualColor, <span style="color: blue;">true</span>) == 0)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: green;"><font color="#000000" face="Calibri" size="3">// We have a match!<o:p></o:p></font></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">Color</span>)info.Invoke(<span style="color: blue;">null</span>, <span style="color: blue;">null</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: rgb(43, 145, 175);">Colors</span>.Black;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">#region</font></span><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3"> IValueConverter Members<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">public</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">object</span> Convert(<span style="color: blue;">object</span> value, <span style="color: rgb(43, 145, 175);">Type</span> targetType, <span style="color: blue;">object</span> parameter, System.Globalization.<span style="color: rgb(43, 145, 175);">CultureInfo</span> culture)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">try<o:p></o:p></font></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3"> paramAsString = parameter.ToString();<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3">[] splitParam = paramAsString.Split(<span style="color: rgb(163, 21, 21);">';'</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">double</font></span><font color="#000000" face="Calibri" size="3"> inputValue = System.<span style="color: rgb(43, 145, 175);">Convert</span>.ToDouble(value);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">foreach</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: blue;">string</span> bracket <span style="color: blue;">in</span> splitParam)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">string</font></span><font color="#000000" face="Calibri" size="3">[] bracketParameters = bracket.Split(<span style="color: rgb(163, 21, 21);">':'</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: rgb(43, 145, 175);"><font color="#000000" face="Calibri" size="3">Double</font></span><font color="#000000" face="Calibri" size="3"> bracketLimit;<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">try<o:p></o:p></font></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">bracketLimit = System.<span style="color: rgb(43, 145, 175);">Convert</span>.ToDouble(bracketParameters[0]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">catch</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">InvalidCastException</span>)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">this</span>.GetColorFromString(bracketParameters[1]);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">if</font></span><font color="#000000" face="Calibri" size="3"> (inputValue &gt;= bracketLimit)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(<span style="color: blue;">this</span>.GetColorFromString(bracketParameters[1]));<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">catch</font></span><font color="#000000" face="Calibri" size="3"> (<span style="color: rgb(43, 145, 175);">Exception</span> e)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(<span style="color: rgb(43, 145, 175);">Colors</span>.White);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">return</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>(<span style="color: rgb(43, 145, 175);">Colors</span>.White);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p><font color="#000000" face="Calibri" size="3">&nbsp;</font></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">public</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">object</span> ConvertBack(<span style="color: blue;">object</span> value, <span style="color: rgb(43, 145, 175);">Type</span> targetType, <span style="color: blue;">object</span> parameter, System.Globalization.<span style="color: rgb(43, 145, 175);">CultureInfo</span> culture)<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">{<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><span style="color: blue;"><font color="#000000" face="Calibri" size="3">throw</font></span><font color="#000000" face="Calibri" size="3"> <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Exception</span>(<span style="color: rgb(163, 21, 21);">"The method or operation is not implemented."</span>);<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">#endregion<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style=""><font color="#000000" face="Calibri" size="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><font color="#000000" face="Calibri" size="3">}<o:p></o:p></font></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;" mce_keep="true"><font color="#000000" face="Calibri" size="3">&nbsp;</font></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">Give this one a fly, and set the parameter to: 95:Azure;75:HotPink;40:Blue;10:Coral;-9999:Orange.</font></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">Enjoy :).</font></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font color="#000000" face="Calibri" size="3">(As always, code here is provided "As-is" with no warranty, implied or otherwise. Use at your own risk)</font></p></span></div>
	</div>
	<div><span id="ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel"></span><input name="ctl00$_$ctl00$_$ctl01$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel_State" value="nochange" type="hidden"></div>
							
</div>            


<div id="postToolbar">
<h2 class="CommonSubTitle">Comment Notification</h2>
<p>
	
	<a href="javascript:toggleSubscription();" id="ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton" trackingresourcename="Weblogs_UnTrack" nottrackingresourcename="Weblogs_Track" workingresourcename="Weblogs_TrackWorking">Send me email alerts for new comments to this post</a>
</p>
<p>
	Subscribe to this post's comments using
	<a id="ctl00___ctl00___ctl01___DetailedSubBar___CommentRssLink" href="http://blogs.msdn.com/danteg/commentrss.aspx?PostID=4088213">RSS</a>
</p>
</div>


	<h3>
	Comments
</h3>
	<div id="comments">

	<div class="comment">
	<h4>
		<a id="ctl00___ctl00___ctl01___Comments___Comments_ctl01_PermaLink" title="permalink" href="http://blogs.msdn.com/danteg/archive/2007/07/27/variable-value-converters.aspx#4184480">#</a>
		re: Variable Value Converters<a name="4184480"></a>
	</h4>
	<div class="commentssubhead">
		Thursday, August 02, 2007 4:16 AM 
		by <a id="ctl00___ctl00___ctl01___Comments___Comments_ctl01_NameLink" title="xicoloko" href="http://blogs.msdn.com/user/Profile.aspx?UserID=93564" target="_blank">xicoloko</a>
		<span class="commentspan"></span>
	</div>
	<div class="commentsbody">
		<p>Hi Dante,</p>
<p>I am wondering why you didn't use ColorConverter to do the trick with the colors...</p>
<p>Like: </p>
<p>Color color = (Color)System.Windows.Media.ColorConverter.ConvertFromString("Blue");</p>

	</div>
	</div>

	<div class="commentowner">
	<h4>
		<a id="ctl00___ctl00___ctl01___Comments___Comments_ctl02_PermaLink" title="permalink" href="http://blogs.msdn.com/danteg/archive/2007/07/27/variable-value-converters.aspx#4190807">#</a>
		re: Variable Value Converters<a name="4190807"></a>
	</h4>
	<div class="commentssubhead">
		Thursday, August 02, 2007 12:34 PM 
		by <a id="ctl00___ctl00___ctl01___Comments___Comments_ctl02_NameLink" title="DanteG" href="http://blogs.msdn.com/user/Profile.aspx?UserID=23987" target="_blank">DanteG</a>
		<span class="commentspan"></span>
	</div>
	<div class="commentsbody">
		<p>Well... that would have made things a lot easier.</p>
<p>I didn't use it, primarily because I didn't know about it. But, that
would make things much easier. I'll have to try to incorporate that.</p>
<p>Thanks for the tip!</p>
<p>--D</p>

	</div>
	</div>

	</div>





<div id="commentform">
<h3>Leave a Comment</h3>
<dl>
	
	<dt><label for="ctl00___ctl00___ctl01___form___tbUrl">Your URL</label> <em>(optional</em>)</dt>
	<dd><input name="ctl00$_$ctl00$_$ctl01$_$form$_$tbUrl" id="ctl00___ctl00___ctl01___form___tbUrl" class="smallbox" type="text"></dd>
	<dt><label for="ctl00___ctl00___ctl01___form___tbComment">Comments</label> <em>(required)</em><span id="ctl00___ctl00___ctl01___form___Requiredfieldvalidator3" style="color: Red; visibility: hidden;">*</span></dt>
	<dd><textarea name="ctl00$_$ctl00$_$ctl01$_$form$_$tbComment" rows="5" cols="25" id="ctl00___ctl00___ctl01___form___tbComment"></textarea></dd>
	<dt></dt>
	<dt><input name="ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit" value="Submit" onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit", "", true, "", "", false, false))' id="ctl00___ctl00___ctl01___form___btnSubmit" type="submit"></dt>
</dl>
</div>



	
<h2 class="CommonSubTitle">About DanteG</h2>
Well, I've been in the industry in one form or another since about
1997, when I graduated from Oakland University in Rochester, Michigan.
I worked with Cimlinc as an intern on the now defunct Envelop project
when I got laid off and spent some time as a furniture salesman (Yeah,
I know...)
Before I finished my degree, I started working for Thedra, writing UI
in Tcl/Tk primarily for Sun Solaric and some ancient little Unix boxes
that I can't even remember the names.
I moved to tech support for Altair Engineering, where I stayed until
they discovered that I knew how to code. I was there as a developer for
a couple years until the auto industry led to rounds of layoffs at
Altair, and I was one of them.
Then, after 3 months, Microsoft decided that they wanted to give me a
shot, so in November of 2002, I went out to be one of the few testers
on the newly built "Code Name: Sparkle" project. Sparkle eventually
became the Expression Interactive Designer, and finally Expression
Blend. Now, almost 5 years later, I'm still a tester with Microsoft on
Expression Blend, but my 'reach' is extended through my Total Training
series and here on my blog.
Personally, I'm married (2007 was 10 years), and I have one son who is
a Viva Pinata addict. </div></div>
			<div id="contentfooter">&nbsp;</div>
		</div>
		<div id="footer">
			
		</div>
	</div>
</div>

<script type="text/javascript">
<!--
var Page_Validators =  new Array(document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"));
// -->
</script>

<script type="text/javascript">
<!--
var ctl00___ctl00___ctl01___form___Requiredfieldvalidator3 = document.all ? document.all["ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"] : document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3");
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.controltovalidate = "ctl00___ctl00___ctl01___form___tbComment";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.errormessage = "*";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.initialvalue = "";
// -->
</script>

<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___bt___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$bt$_$ws$_$SearchButton','')	}
}

//-->
</script>
<script language="javascript">var ctl00___ctl00___ctl01___Entry___Ratings=new RateControl('ctl00___ctl00___ctl01___Entry___Ratings','ctl00___ctl00___ctl01___Entry___Ratings','ctl00___ctl00___ctl01___Entry___Ratings_Value', 5, '/Themes/default/images/common/', false, 'CommonRateControl','CommonRateControlActive','CommonRateControlReadOnly',['Terrible','Poor','Fair','Average','Good','Excellent'],false,true);</script>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/danteg/archive/2007/07/27/variable-value-converters.aspx"
dc:identifier="http://blogs.msdn.com/danteg/archive/2007/07/27/variable-value-converters.aspx"
dc:title="Variable Value Converters"
trackback:ping="http://blogs.msdn.com/danteg/trackback.aspx?PostID=4088213" />
</rdf:RDF>
-->

<script type="text/javascript">
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</script>
        </form>
</body></html>