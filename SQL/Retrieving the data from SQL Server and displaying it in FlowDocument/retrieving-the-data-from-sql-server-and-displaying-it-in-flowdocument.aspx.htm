<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>Ashish Thapliyal's Blog : Retrieving the data from SQL Server and displaying it in FlowDocument</title>
 




<meta name="description" content="I did this small demonstration in one of my presentations and thought I’ll post this very simple code snippet. I’m reading the data from Address table in AdventureWorks database and displaying it in a flow document here goes the code public partial class">
<meta name="keywords" content="WPF, Silverlight XAML">
<meta name="GENERATOR" content="CommunityServer 2.1 SP1 (Build: 61025.2)">
<link rel="pingback" href="http://blogs.msdn.com/ashish/pingback.aspx">
<link rel="stylesheet" href="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/style.css" type="text/css" media="screen">
<link rel="stylesheet" href="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/print.css" type="text/css" media="print">
<link rel="stylesheet" href="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/fall.css" type="text/css" media="screen">
<link rel="stylesheet" href="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/customcss.css" type="text/css" media="screen">
<link rel="shortcut icon" type="image/ico" href="http://blogs.msdn.com/favicon.ico">
<link rel="alternate" type="application/rss+xml" title="Ashish Thapliyal's Blog (RSS 2.0)" href="http://blogs.msdn.com/ashish/rss.xml">
<link rel="alternate" type="application/atom+xml" title="Ashish Thapliyal's Blog (Atom 1.0)" href="http://blogs.msdn.com/ashish/atom.xml">
<link rel="alternate" type="application/rss+xml" title="Retrieving the data from SQL Server and displaying it in FlowDocument Comment RSS (RSS 2.0)" href="http://blogs.msdn.com/ashish/commentrss.aspx?PostID=3464821">

	<script src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/global.js" type="text/javascript"></script></head><body>
<form name="aspnetForm" method="post" action="/ashish/archive/2007/06/22/retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="aspnetForm">
<div>
<input name="__EVENTTARGET" id="__EVENTTARGET" value="" type="hidden">
<input name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" type="hidden">
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFHmN0bDAwJF8kY3RsMDAkXyR3cyRfJFNlYXJjaEJveF0RlpzcH1+/MkXXJXQs3Ibd4GgM" type="hidden">
</div>

<script type="text/javascript">
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script>


<script src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/WebResource.js" type="text/javascript"></script>

<script language="javascript" type="text/javascript" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</script><script language="javascript" type="text/javascript">
var RatingControlAJAX = {
"SaveRating":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Blogs.Controls.BlogRatePost',id,'SaveRating',[p0],cb,0,0,0,1);}};
</script><script language="javascript" type="text/javascript">
var ThreadSubscribeLinkButton = {
"ToggleEmailReplies":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Controls.ThreadSubscribeLinkButton',id,'ToggleEmailReplies',[p0],cb,0,0,0,0);}};
</script><script type="text/javascript" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/ratingcontrol.js"></script>
<script src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/WebResource_002.js" type="text/javascript"></script><script language="JavaScript" type="text/javascript">var ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackWorking = false;var ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackStatus = false;function updateSubscriptionText() {if(ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackStatus == true) {document.getElementById('ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton').innerHTML = 'Stop sending me email alerts for this post';} else {document.getElementById('ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton').innerHTML = 'Send me email alerts for new comments to this post';}}function toggleSubscription() {ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackWorking = true;document.getElementById('ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton').innerHTML = 'Updating email notifications...';ThreadSubscribeLinkButton.ToggleEmailReplies('ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton',521062, toggleSubscriptionCallback);}function toggleSubscriptionCallback(response) {ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackWorking = false;if((response.error == null) && (response.value == true)) {if(ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackStatus == true) {ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackStatus = false;} else {ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton_trackStatus = true;}updateSubscriptionText();} else {updateSubscriptionText();alert('An error happened while processing your request.  Please notify an administrator and try again later.');}}</script>
<script type="text/javascript">
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</script>


        			
   
<div id="masthead">
	<div id="userArea">
		
			<div id="welcome" align="right">
				
						Signed in as <a href="http://blogs.msdn.com/user/EditProfile.aspx?ReturnUrl=/blogs/post.aspx?App=ashish&amp;y=2007&amp;m=06&amp;d=22&amp;PostName=retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument">bbraatz</a>
 | <a id="ctl00___ctl00___duw1_rc1___logout" href="http://blogs.msdn.com/logout.aspx">Sign out</a>



					
				 |  <a id="ctl00___ctl00___duw1_Faq1" href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</a>
			</div>
		
		
		<div id="SearchSideBar">
			
	
<div id="Search" align="right">
	<table border="0" cellpadding="0" cellspacing="0">
	<tbody><tr><td>
		<input name="ctl00$_$ctl00$_$ws$_$SearchBox" id="ctl00___ctl00___ws___SearchBox" class="searchBox" onkeydown="KeyDownHandlerctl00___ctl00___ws___SearchButton(event);" type="text"> 
	</td><td>
		<span class="SearchButtonOuter"><a id="ctl00___ctl00___ws___SearchButton" class="SearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$ws$_$SearchButton','')">Search</a></span>
	</td></tr>
	</tbody></table>
</div>
	
		</div>
	</div>
	<div id="title">
		

<h1><a id="ctl00___ctl00___bt___BlogTitle" class="headermaintitle" href="http://blogs.msdn.com/ashish/default.aspx">Ashish Thapliyal's Blog</a></h1>
<div></div>


	</div>
</div>
<div id="nav">
	<div id="navbar">
		<ul>
			<li><a id="ctl00___ctl00___Homelink1" href="http://blogs.msdn.com/ashish/default.aspx">Home</a></li>
			<li><a id="ctl00___ctl00___Contactlink1" href="http://blogs.msdn.com/ashish/contact.aspx">Email</a></li>
			
			<li><a id="ctl00___ctl00___rss" href="http://blogs.msdn.com/ashish/rss.xml">RSS 2.0</a></li>
			<li><a id="ctl00___ctl00___atom" href="http://blogs.msdn.com/ashish/atom.xml">Atom 1.0</a></li>
			
		</ul>
	</div>
</div>
<div id="content">
	<div id="leftmenu">
		

<div id="TasksSideBar">
	
</div>

<div id="RecentPostsSideBar">
	
	
<h3>Recent Posts</h3>	
<ul>
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl01_Link" href="http://blogs.msdn.com/ashish/archive/2007/09/02/navigation-window.aspx">Navigation Window</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl02_Link" href="http://blogs.msdn.com/ashish/archive/2007/08/14/dynamically-loading-xaml.aspx">Dynamically Loading XAML</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl03_Link" href="http://blogs.msdn.com/ashish/archive/2007/07/27/saas-wpf.aspx">SAAS+WPF</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl04_Link" href="http://blogs.msdn.com/ashish/archive/2007/07/05/acropolis-july-ctp-release-available-now.aspx">Acropolis July CTP Release available now</a></li>
    
        <li><a id="ctl00___ctl00___bs___rp___PostList_ctl05_Link" href="http://blogs.msdn.com/ashish/archive/2007/06/27/how-moonlight-silverlight-for-linux-was-developed-in-21-days.aspx">How Moonlight (Silverlight for Linux) was Developed in 21 days</a></li>
    </ul>
    
	

</div>

<div id="TagSideBar">
	<h3>Tags</h3>
	<ul class="SidebarTagCloud">
<li class="Tag6"><a href="http://blogs.msdn.com/ashish/archive/tags/SAAS/default.aspx" rel="tag">SAAS</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/ashish/archive/tags/Silverlight/default.aspx" rel="tag">Silverlight</a></li>
<li class="Tag1"><a href="http://blogs.msdn.com/ashish/archive/tags/WPF/default.aspx" rel="tag">WPF</a></li>
</ul>

</div>

<div id="NewsSideBar">
	
<div id="NewsSidebar">
<h3>News</h3>
<ul>
<li>These postings are provided "AS IS" with no warranties, and confers
no rights. Use of included script samples are subject to the terms
specified at <a href="http://www.microsoft.com/info/cpyright.htm"> Microsoft</a></li>
</ul>
</div>
</div>

<div id="LinkSideBar">
	
        <h3>Blogger's in my team</h3>
        <ul>
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl01_Link" rel="co-worker" title="C#3.0, LINQ" href="http://blogs.msdn.com/wriju/">Wriju's Blog</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl02_Link" href="http://blogs.msdn.com/Azazr/">azaz's Blog</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl03_Link" href="http://blogs.msdn.com/alving/">Alvin Gendrano's WebLog</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl04_Link" href="http://blogs.msdn.com/rahul/">Patterns for Great Architecture</a></li>
            </ul>
    

	
</div>

<div id="ArchiveSideBar">
	
	
<h3>Archives</h3>
<ul>

        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/09.aspx">September 2007 (1)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/08.aspx">August 2007 (1)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/07.aspx">July 2007 (2)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/06.aspx">June 2007 (8)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/05.aspx">May 2007 (5)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/04.aspx">April 2007 (1)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/03.aspx">March 2007 (2)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2007/02.aspx">February 2007 (2)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2006/12.aspx">December 2006 (1)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/ashish/archive/2006/09.aspx">September 2006 (2)</a>
        </li>
    
</ul>
	
</div>
	</div>
	<div id="main">
		
			

<div class="post">
	<h5 class="posthead pageTitle">Retrieving the data from SQL Server and displaying it in FlowDocument <span class="CommonRateControl" id="ctl00___ctl00___ctl02___Entry___Ratings" title="Not yet rated"><img title="Poor" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Poor" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Fair" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Fair" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Average" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Average" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Good" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Good" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-right-off.gif" align="absmiddle" border="0"><img title="Excellent" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-left-off.gif" align="absmiddle" border="0"><img title="Excellent" src="retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx_files/star-right-off.gif" align="absmiddle" border="0"></span><input value="0" id="ctl00___ctl00___ctl02___Entry___Ratings_Value" type="hidden"></h5>
	<p class="MsoNormal" style="margin: 0in 0in 10pt;"><font face="Calibri" size="3">I
did this small demonstration in one of my presentations and thought
I’ll post this very simple code snippet. I’m reading the data from
Address table in AdventureWorks database and displaying it in a flow
document here goes the code</font></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><o:p><font face="Calibri" size="3">&nbsp;</font></o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; color: blue; font-family: 'Courier New';">public</span><span style="font-size: 10pt; font-family: 'Courier New';"> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">Window1</span> : <span style="color: rgb(43, 145, 175);">Window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">public</span> Window1()<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InitializeComponent();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CreateFlowDocument(); <o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">public</span> <span style="color: blue;">void</span> CreateFlowDocument()<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">SqlConnection</span> con = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SqlConnection</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>con.ConnectionString = <span style="color: rgb(163, 21, 21);">"Data Source=SQLDB;Initial Catalog=AdventureWorks;Integrated Security=True"</span>;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>con.Open();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">SqlCommand</span> cmd = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SqlCommand</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cmd.CommandText = <span style="color: rgb(163, 21, 21);">"Select<span style="">&nbsp; </span>AddressLine1,City<span style="">&nbsp; </span>from Person.Address"</span>;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cmd.Connection = con;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">SqlDataReader</span> rdr=cmd.ExecuteReader()<span style="">&nbsp;&nbsp; </span>;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">StringBuilder</span> strbldr = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">StringBuilder</span>(); <o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">while</span> (rdr.Read())<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>strbldr.AppendLine(rdr[0].ToString() + rdr[1].ToString()+<span style="color: rgb(163, 21, 21);">"nICE"</span>); ;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">Paragraph</span> myParagraph = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Paragraph</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>myParagraph.Inlines.Add(<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Bold</span>(<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Run</span>(<span style="color: rgb(163, 21, 21);">"Some bold text in the paragraph."</span>)));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>myParagraph.Inlines.Add(<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Run</span>(strbldr.ToString() ));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">FlowDocument</span> myFlowDocument = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">FlowDocument</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>myFlowDocument.Blocks.Add(myParagraph);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">SolidColorBrush</span> objBrush=<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">SolidColorBrush</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>objBrush.Color =<span style="color: rgb(43, 145, 175);">Colors</span>.Blue ;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>myFlowDocument.Background = objBrush; <o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">FlowDocumentReader</span> myFlowDocumentReader = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">FlowDocumentReader</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>myFlowDocumentReader.Document = myFlowDocument;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">this</span>.Content = myFlowDocumentReader;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal;"><span style="font-size: 10pt; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 10pt;"><span style="font-size: 10pt; line-height: 115%; font-family: 'Courier New';"><span style="">&nbsp;</span>}</span></p>
	<div class="postfoot">
		<span class="em">Posted:</span> Friday, June 22, 2007 5:22 PM
		by
		<a id="ctl00___ctl00___ctl02___Entry___AuthorLink" href="http://blogs.msdn.com/user/Profile.aspx?UserID=7571">ashish</a>
		
		<div><span id="ctl00___ctl00___ctl02___Entry___InlineTagEditorPanel"></span><input name="ctl00$_$ctl00$_$ctl02$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl02___Entry___InlineTagEditorPanel_State" value="nochange" type="hidden"></div>
		
	</div>
</div>            


<div id="comments">
	<h2>
	Comments
</h2>
	
		<p>No Comments</p>
	
</div>

	


	
<fieldset id="commentform">
<legend>Leave a Comment</legend>

	<p>
    </p><div><label for="ctl00___ctl00___ctl02___form___tbTitle">Title</label> <em>(required)</em><span id="ctl00___ctl00___ctl02___form___Requiredfieldvalidator1" style="color: Red; visibility: hidden;">*</span></div>
	<div><input name="ctl00$_$ctl00$_$ctl02$_$form$_$tbTitle" value="re: Retrieving the data from SQL Server and displaying it in FlowDocument" id="ctl00___ctl00___ctl02___form___tbTitle" class="smallbox" type="text"></div>
	
	<p>
    
    </p>
    <p>
    </p><div><label for="ctl00___ctl00___ctl02___form___tbUrl">Your URL</label> <em>(optional</em>)</div>
    <div><input name="ctl00$_$ctl00$_$ctl02$_$form$_$tbUrl" id="ctl00___ctl00___ctl02___form___tbUrl" class="smallbox" type="text"></div>
    
    <p>
    </p><div><label for="ctl00___ctl00___ctl02___form___tbComment">Comments</label> <em>(required)</em><span id="ctl00___ctl00___ctl02___form___Requiredfieldvalidator3" style="color: Red; visibility: hidden;">*</span></div>
    <div><textarea name="ctl00$_$ctl00$_$ctl02$_$form$_$tbComment" rows="5" cols="25" id="ctl00___ctl00___ctl02___form___tbComment"></textarea></div>
	
	<p>
    </p><div></div>
    
	<p>
    <input name="ctl00$_$ctl00$_$ctl02$_$form$_$btnSubmit" value="Submit" onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$_$ctl00$_$ctl02$_$form$_$btnSubmit", "", true, "", "", false, false))' id="ctl00___ctl00___ctl02___form___btnSubmit" type="submit">
	</p>

</fieldset>



	

<fieldset id="postnotification">
	<legend>Comment Notification</legend>
	<p>
	
	<a href="javascript:toggleSubscription();" id="ctl00___ctl00___ctl02___DetailedSubBar___BlogThreadButton" trackingresourcename="Weblogs_UnTrack" nottrackingresourcename="Weblogs_Track" workingresourcename="Weblogs_TrackWorking">Send me email alerts for new comments to this post</a>
	</p>
	<p>
	Subscribe to this post's comments using
	<a id="ctl00___ctl00___ctl02___DetailedSubBar___CommentRssLink" href="http://blogs.msdn.com/ashish/commentrss.aspx?PostID=3464821">RSS</a>
	</p>
</fieldset>
   
    
	</div>
	<div id="footer">
		
	</div>
</div>

<script type="text/javascript">
<!--
var Page_Validators =  new Array(document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator1"), document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator3"));
// -->
</script>

<script type="text/javascript">
<!--
var ctl00___ctl00___ctl02___form___Requiredfieldvalidator1 = document.all ? document.all["ctl00___ctl00___ctl02___form___Requiredfieldvalidator1"] : document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator1");
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.controltovalidate = "ctl00___ctl00___ctl02___form___tbTitle";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.errormessage = "*";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator1.initialvalue = "";
var ctl00___ctl00___ctl02___form___Requiredfieldvalidator3 = document.all ? document.all["ctl00___ctl00___ctl02___form___Requiredfieldvalidator3"] : document.getElementById("ctl00___ctl00___ctl02___form___Requiredfieldvalidator3");
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.controltovalidate = "ctl00___ctl00___ctl02___form___tbComment";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.errormessage = "*";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl02___form___Requiredfieldvalidator3.initialvalue = "";
// -->
</script>

<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$ws$_$SearchButton','')	}
}

//-->
</script>
<script language="javascript">var ctl00___ctl00___ctl02___Entry___Ratings=new RateControl('ctl00___ctl00___ctl02___Entry___Ratings','ctl00___ctl00___ctl02___Entry___Ratings','ctl00___ctl00___ctl02___Entry___Ratings_Value', 5, '/Themes/default/images/common/', false, 'CommonRateControl','CommonRateControlActive','CommonRateControlReadOnly',['Terrible','Poor','Fair','Average','Good','Excellent'],false,true);</script>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/ashish/archive/2007/06/22/retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx"
dc:identifier="http://blogs.msdn.com/ashish/archive/2007/06/22/retrieving-the-data-from-sql-server-and-displaying-it-in-flowdocument.aspx"
dc:title="Retrieving the data from SQL Server and displaying it in FlowDocument"
trackback:ping="http://blogs.msdn.com/ashish/trackback.aspx?PostID=3464821" />
</rdf:RDF>
-->

<script type="text/javascript">
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</script>
        </form>
</body></html>