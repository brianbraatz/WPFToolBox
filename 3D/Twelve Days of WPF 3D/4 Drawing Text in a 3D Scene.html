<html><head><title>4: Drawing Text in a 3D Scene</title>





<script type="text/javascript" src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/ericsinksoftware.js"> </script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://software.ericsink.com/rss.xml">
<style type="text/css">
.SiteTitle {font-family: Arial, Helvetica, sans-serif; font-size:36pt}
.Tagline {font-family: Arial, Helvetica, sans-serif}
.ArticleTitle {text-decoration: none; color: black; font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:16pt}
.ArticleTitleGreen {text-decoration: none; color: #669900; font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:16pt}
.DayPageArticleTitle {text-decoration: none; color: black; font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:12pt}
.ArticleDate {color:black; font-family: Arial, Helvetica, sans-serif; font-size:7pt;font-weight:normal}
.LeftSide {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
.Copyright { font-family: Arial, Helvetica, sans-serif; font-size:7pt }
BLOCKQUOTE {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
P {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
OL {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
UL {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
LI {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
H2 {font-family:Arial,Helvetica,sans-serif}
H3 {font-family:Arial,Helvetica,sans-serif}
H4 {font-family:Arial,Helvetica,sans-serif}
H5 {font-family:Arial,Helvetica,sans-serif}
</style></head><body bgcolor="#000000">

<table align="center" bgcolor="#99cc33" border="0" cellpadding="0" cellspacing="0" width="870">
<tbody><tr><td colspan="3"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/EricWeblogHeader1.jpg"></td></tr>
<tr>
<td colspan="3">&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td align="left" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_upper_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_upper_right.png"></td>
<td>&nbsp;</td>
<td align="left" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_upper_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_upper_right.png"></td>
</tr>
<tr>
<td bgcolor="white">&nbsp;</td>
<td bgcolor="white" valign="top" width="180">
<table border="0" cellpadding="0">
<tbody><tr><td class="LeftSide">
<a href="http://software.ericsink.com/index.html">Home</a><br>
<br>
<a href="http://software.ericsink.com/about_author.html">About Eric</a><br>
<br>
<a href="http://software.ericsink.com/rss.xml">RSS <img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/xml.gif" border="0"></a><br>
<br>
<a href="http://software.ericsink.com/archive_index.html">Complete Archive</a><br>
<br>
<br>
<center><a href="http://www.amazon.com/exec/obidos/ASIN/1590596234/sawdust08-20"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/ew-bos.png" border="0"></a></center>
<br>
<br>
<b>Series:</b><br>
<br>
<a href="http://software.ericsink.com/scm/source_control.html">Source Control HOWTO</a><br>
<br>
<a href="http://software.ericsink.com/Marketing_for_Geeks.html">Marketing for Geeks</a><br>
<br>
<a href="http://software.ericsink.com/laws/Immutable_Laws_Marketing.html">The 22 Immutable Laws of Marketing</a><br>
<br>
<a href="http://software.ericsink.com/bos/Business_of_Software.html">The Business of Software</a><br>
<br>
<a href="http://software.ericsink.com/wpf3d/index.html">WPF 3D</a><br>
<br>
<b>Topics:</b><br>
<br>
<a href="http://software.ericsink.com/tocs/Software_Development.html">Software Development</a><br>
<br>
<a href="http://software.ericsink.com/tocs/WPF.html">WPF</a><br>
<br>
<a href="http://software.ericsink.com/tocs/Business.html">Business</a><br>
<br>
<a href="http://software.ericsink.com/tocs/Laughs.html">Laughs</a><br>
<br>
<a href="http://software.ericsink.com/tocs/SourceGear_Products.html">SourceGear</a><br>
<br>
<br>
<b>Related Sites:</b><br>
<br>
<a href="http://notalegend.com/">www.NotALegend.com</a><br>
<br>
<a href="http://www.sourcegear.com/">www.SourceGear.com</a><br>
<br>
<a href="http://www.teamprise.com/">www.Teamprise.com</a><br>
<br>

</td></tr>
</tbody></table></td>
<td bgcolor="white">&nbsp;</td>
<td>&nbsp;</td>
<td bgcolor="white">&nbsp;</td>
<td bgcolor="white" valign="top" width="590">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr><td>

<p class="ArticleDate" align="right">Monday, July 16, 2007</p>
<p class="ArticleTitle">4: Drawing Text in a 3D Scene</p>

<p>This entry is part 4 of a <a href="http://software.ericsink.com/wpf3d/index.html">12-part series</a> on WPF
3D.</p>

<h3>Drawing Text in a 3D Scene</h3>

<p><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/1688_image001.jpg" align="right" height="267" hspace="12" width="300">This piece of oak is 4 inches wide, 8 inches long, and 1
inch thick.&nbsp; But that's obvious from the picture, right?</p>

<p><br clear="all">
As I was learning WPF, it took me a long time to add annotations to Sawdust. &nbsp;I
procrastinated because I assumed it would be difficult to get text into my 3D
scene.&nbsp; Silly me.</p>

<p>In WPF 3D, drawing text is remarkably simple.&nbsp; Basically you
just make a VisualBrush from a TextBlock.&nbsp; Use that Brush in a Material and set
the TextureCoordinates properly.</p>

<p>Today I'll let the code speak for itself.</p>

<p>&nbsp;</p>

<p style=""><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;"> </span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;summary&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
Creates a ModelVisual3D containing a text label.<br>
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;"> </span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/summary&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="text"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">The string</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="textColor"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">The color of the text.</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="bDoubleSided"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">Visible from both sides?</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="height"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">Height of the characters</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="center"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">The center of the label</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="over"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">Horizontal direction of the label</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;param
name="up"&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">Vertical direction of the label</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/param&gt;<br>
///</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;returns&gt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: green;">Suitable for
adding to your Viewport3D</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: gray;">&lt;/returns&gt;<br>
</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: blue;">public</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"> <span style="color: blue;">static</span>
<span style="color: teal;">ModelVisual3D</span> CreateTextLabel3D(<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">string</span> text, <br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Brush</span> textColor, <br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">bool</span> bDoubleSided, <br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">double</span> height, <br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Point3D</span> center, <br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Vector3D</span> over, <br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Vector3D</span> up)<br>
{<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// First we need a textblock containing the text
of our label<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: teal;">TextBlock</span> tb = <span style="color: blue;">new</span> <span style="color: teal;">TextBlock</span>(<span style="color: blue;">new</span> <span style="color: teal;">Run</span>(text));<br>
&nbsp;&nbsp;&nbsp; tb.Foreground = textColor;<br>
&nbsp;&nbsp;&nbsp; tb.FontFamily = <span style="color: blue;">new</span> <span style="color: teal;">FontFamily</span>(<span style="color: maroon;">"Arial"</span>);<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// Now use that TextBlock as the brush for a
material<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: teal;">DiffuseMaterial</span> mat = <span style="color: blue;">new</span> <span style="color: teal;">DiffuseMaterial</span>();<br>
&nbsp;&nbsp;&nbsp; mat.Brush = <span style="color: blue;">new</span> <span style="color: teal;">VisualBrush</span>(tb);<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// We just assume the characters are square<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: blue;">double</span> width = text.Length * height;<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// Since the parameter coming in was the center
of the label,<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// we need to find the four corners<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// p0 is the lower left corner<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// p1 is the upper left<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// p2 is the lower right<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// p3 is the upper right<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: teal;">Point3D</span> p0 = center - width / 2 *
over - height / 2 * up;<br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Point3D</span> p1 = p0 + up * 1 * height;<br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Point3D</span> p2 = p0 + over * width;<br>
&nbsp;&nbsp;&nbsp; <span style="color: teal;">Point3D</span> p3 = p0 + up * 1 * height + over *
width;<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// Now build the geometry for the sign.&nbsp; It's
just a<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// rectangle made of two triangles, on
each side.<br>
<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: teal;">MeshGeometry3D</span> mg = <span style="color: blue;">new</span> <span style="color: teal;">MeshGeometry3D</span>();<br>
&nbsp;&nbsp;&nbsp; mg.Positions = <span style="color: blue;">new</span> <span style="color: teal;">Point3DCollection</span>();<br>
&nbsp;&nbsp;&nbsp; mg.Positions.Add(p0);&nbsp; &nbsp;&nbsp;<span style="color: green;">// 0<br>
</span>&nbsp;&nbsp;&nbsp; mg.Positions.Add(p1);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 1<br>
</span>&nbsp;&nbsp;&nbsp; mg.Positions.Add(p2);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 2<br>
</span>&nbsp;&nbsp;&nbsp; mg.Positions.Add(p3);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 3<br>
<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (bDoubleSided)<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.Positions.Add(p0);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 4<br>
</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.Positions.Add(p1);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 5<br>
</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.Positions.Add(p2);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 6<br>
</span>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;mg.Positions.Add(p3);&nbsp;&nbsp;&nbsp; <span style="color: green;">// 7<br>
</span>&nbsp;&nbsp;&nbsp; }<br>
<br>
&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(0);<br>
&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(3);<br>
&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(1);<br>
&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(0);<br>
&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(2);<br>
&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(3);<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (bDoubleSided)<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(4);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(5);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(7);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(4);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(7);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TriangleIndices.Add(6);<br>
&nbsp;&nbsp;&nbsp; }<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// These texture coordinates basically stretch
the<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: green;">// TextBox brush to cover the full side of
the label.<br>
<br>
</span>&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(0, 1));<br>
&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(0, 0));<br>
&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(1, 1));<br>
&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(1, 0));<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">if</span> (bDoubleSided)<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(1, 1));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(1, 0));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(0, 1));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mg.TextureCoordinates.Add(<span style="color: blue;">new</span> <span style="color: teal;">Point</span>(0, 0));<br>
&nbsp;&nbsp;&nbsp; }<br>
<br>
&nbsp;&nbsp;&nbsp; <span style="color: green;">// And that's all.&nbsp; Return the result.<br>
<br>
</span>&nbsp;&nbsp;&nbsp; <span style="color: teal;">ModelVisual3D</span> mv3d = <span style="color: blue;">new</span> <span style="color: teal;">ModelVisual3D</span>();<br>
&nbsp;&nbsp;&nbsp; mv3d.Content = <span style="color: blue;">new</span> <span style="color: teal;">GeometryModel3D</span>(mg,
mat);;<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">return</span> mv3d;<br>
}</span></p>

<p></p><hr>
<a href="javascript:HaloScan('1688');" target="_self"><script type="text/javascript">postCount('1688');</script>Comments (5)</a><p>
</p>
</td></tr>
</tbody></table>
</td>
<td bgcolor="white">&nbsp;</td>
</tr>
<tr valign="bottom">
<td align="left" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_lower_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_lower_right.png"></td>
<td>&nbsp;</td>
<td align="left" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_lower_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_inside_lower_right.png"></td>
</tr>
<tr><td colspan="7" class="Copyright">Copyright 2001-2007 Eric Sink. All Rights Reserved</td>
<td align="right">&nbsp;</td>
</tr>
</tbody></table>
</td>
<td>&nbsp;</td>
</tr>
<tr valign="bottom">
<td align="left"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_main_lower_left.png"></td>
<td>&nbsp;</td>
<td align="right"><img src="4%20Drawing%20Text%20in%20a%203D%20Scene_files/corner_main_lower_right.png"></td>
</tr>
</tbody></table></body></html>