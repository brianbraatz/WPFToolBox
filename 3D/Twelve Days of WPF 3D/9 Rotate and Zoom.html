<html><head><title>9: Rotate and Zoom</title>





<script type="text/javascript" src="9%20Rotate%20and%20Zoom_files/ericsinksoftware.js"> </script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://software.ericsink.com/rss.xml">
<style type="text/css">
.SiteTitle {font-family: Arial, Helvetica, sans-serif; font-size:36pt}
.Tagline {font-family: Arial, Helvetica, sans-serif}
.ArticleTitle {text-decoration: none; color: black; font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:16pt}
.ArticleTitleGreen {text-decoration: none; color: #669900; font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:16pt}
.DayPageArticleTitle {text-decoration: none; color: black; font-family: Arial, Helvetica, sans-serif; font-weight:bold; font-size:12pt}
.ArticleDate {color:black; font-family: Arial, Helvetica, sans-serif; font-size:7pt;font-weight:normal}
.LeftSide {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
.Copyright { font-family: Arial, Helvetica, sans-serif; font-size:7pt }
BLOCKQUOTE {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
P {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
OL {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
UL {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
LI {font-family: Arial, Helvetica, sans-serif; font-size:10pt}
H2 {font-family:Arial,Helvetica,sans-serif}
H3 {font-family:Arial,Helvetica,sans-serif}
H4 {font-family:Arial,Helvetica,sans-serif}
H5 {font-family:Arial,Helvetica,sans-serif}
</style></head><body bgcolor="#000000">

<table align="center" bgcolor="#99cc33" border="0" cellpadding="0" cellspacing="0" width="870">
<tbody><tr><td colspan="3"><img src="9%20Rotate%20and%20Zoom_files/EricWeblogHeader1.jpg"></td></tr>
<tr>
<td colspan="3">&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td align="left" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_upper_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_upper_right.png"></td>
<td>&nbsp;</td>
<td align="left" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_upper_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_upper_right.png"></td>
</tr>
<tr>
<td bgcolor="white">&nbsp;</td>
<td bgcolor="white" valign="top" width="180">
<table border="0" cellpadding="0">
<tbody><tr><td class="LeftSide">
<a href="http://software.ericsink.com/index.html">Home</a><br>
<br>
<a href="http://software.ericsink.com/about_author.html">About Eric</a><br>
<br>
<a href="http://software.ericsink.com/rss.xml">RSS <img src="9%20Rotate%20and%20Zoom_files/xml.gif" border="0"></a><br>
<br>
<a href="http://software.ericsink.com/archive_index.html">Complete Archive</a><br>
<br>
<br>
<center><a href="http://www.amazon.com/exec/obidos/ASIN/1590596234/sawdust08-20"><img src="9%20Rotate%20and%20Zoom_files/ew-bos.png" border="0"></a></center>
<br>
<br>
<b>Series:</b><br>
<br>
<a href="http://software.ericsink.com/scm/source_control.html">Source Control HOWTO</a><br>
<br>
<a href="http://software.ericsink.com/Marketing_for_Geeks.html">Marketing for Geeks</a><br>
<br>
<a href="http://software.ericsink.com/laws/Immutable_Laws_Marketing.html">The 22 Immutable Laws of Marketing</a><br>
<br>
<a href="http://software.ericsink.com/bos/Business_of_Software.html">The Business of Software</a><br>
<br>
<a href="http://software.ericsink.com/wpf3d/index.html">WPF 3D</a><br>
<br>
<b>Topics:</b><br>
<br>
<a href="http://software.ericsink.com/tocs/Software_Development.html">Software Development</a><br>
<br>
<a href="http://software.ericsink.com/tocs/WPF.html">WPF</a><br>
<br>
<a href="http://software.ericsink.com/tocs/Business.html">Business</a><br>
<br>
<a href="http://software.ericsink.com/tocs/Laughs.html">Laughs</a><br>
<br>
<a href="http://software.ericsink.com/tocs/SourceGear_Products.html">SourceGear</a><br>
<br>
<br>
<b>Related Sites:</b><br>
<br>
<a href="http://notalegend.com/">www.NotALegend.com</a><br>
<br>
<a href="http://www.sourcegear.com/">www.SourceGear.com</a><br>
<br>
<a href="http://www.teamprise.com/">www.Teamprise.com</a><br>
<br>

</td></tr>
</tbody></table></td>
<td bgcolor="white">&nbsp;</td>
<td>&nbsp;</td>
<td bgcolor="white">&nbsp;</td>
<td bgcolor="white" valign="top" width="590">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr><td>

<p class="ArticleDate" align="right">Saturday, July 21, 2007</p>
<p class="ArticleTitle">9: Rotate and Zoom</p>

<p>This entry is part 9 of a <a href="http://software.ericsink.com/wpf3d/index.html">12-part series</a> on WPF
3D.</p>

<h3>Interactive Views</h3>

<p>Sawdust allows the user to interactively rotate and zoom a
3D model.&nbsp; Like any other CAD-like program, understanding how something is put
together can be much easier if you can look at it in just the right way.</p>

<p>I've tried two different ways of presenting this interactive
feature to the user.&nbsp; Both of them involve setting the Transform property on
the Camera and then using the mouse or UI controls to modify that transform
object.</p>

<h3>Trackball</h3>

<p>The easiest way is to use the Trackball object in the <a href="http://www.codeplex.com/3DTools">3D Tools</a> library.&nbsp; All you have to
do is create a Trackball, set your camera's Transform property to its Transform
property, and set its EventSource property to an overlay like the one I
described in <a href="http://software.ericsink.com/wpf3d/8_Mouse.html">part 8</a>.</p>

<p style="margin-left: 0.5in;"><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: rgb(43, 145, 175);">Trackball</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"> tb = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Trackball</span>();<br>
myViewport3D.Camera.Transform = tb.Transform;<br>
tb.EventSource = myOverlay;</span></p>

<p>I shall not try to explain all the details of this class
works.&nbsp; Suffice it to say that it works very well and it is very easy it is to
use.</p>

<h3>Four Sliders</h3>

<p>I mostly like the Trackball, but sometimes its rotation
feature doesn't feel quite right.&nbsp; I occasionally find myself fighting with the
mouse to get the rotation just how I want it to be.</p>

<p>Lately I've been experimenting with another way of handling
rotation and zoom.&nbsp; Instead of a trackball, I've got four sliders.&nbsp; Three of
them control the rotation around the three primary axes.&nbsp; The fourth one is the
zoom.&nbsp; In my UI they look like this:</p>

<p><img src="9%20Rotate%20and%20Zoom_files/1694_image001.jpg" border="0" height="330" width="378"></p>

<p>The Camera in my Viewport3D is setup like this:</p>

<p style="margin-left: 0.5in;"><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: rgb(43, 145, 175);">Point3D</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"> c = myObject.GetCenter();<br>
center = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">TranslateTransform3D</span>(c.x,
c.y, c.z);<br>
rot_x = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">AxisAngleRotation3D</span>(<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Vector3D</span>(1,
0, 0), <br>
&nbsp;&nbsp;&nbsp; myObject.ViewRotX);<br>
rot_y = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">AxisAngleRotation3D</span>(<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Vector3D</span>(0,
1, 0), <br>
&nbsp;&nbsp;&nbsp; myObject.ViewRotY);<br>
rot_z = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">AxisAngleRotation3D</span>(<br>
&nbsp;&nbsp;&nbsp; <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Vector3D</span>(0,
0, 1), <br>
&nbsp;&nbsp;&nbsp; myObject.ViewRotZ);<br>
zoom = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">ScaleTransform3D</span>(<br>
&nbsp;&nbsp;&nbsp; myObject.ViewZoom, <br>
&nbsp;&nbsp;&nbsp; myObject.ViewZoom, <br>
&nbsp;&nbsp;&nbsp; myObject.ViewZoom);<br>
<br>
<span style="color: rgb(43, 145, 175);">Transform3DGroup</span> t = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Transform3DGroup</span>();<br>
<br>
t.Children.Add(zoom);<br>
<br>
<span style="color: green;">// the order of the following three is significant<br>
</span>t.Children.Add(<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">RotateTransform3D</span>(rot_y));<br>
t.Children.Add(<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">RotateTransform3D</span>(rot_x));<br>
t.Children.Add(<span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">RotateTransform3D</span>(rot_z));<br>
<br>
t.Children.Add(center);<br>
<br>
myViewport3D.Camera.Transform = t;</span></p>

<p>Note that I've actually got five transforms in my
Transform3DGroup.&nbsp; The TranslateTransform3D ensures that I am rotating around
the center of my 3D object.&nbsp; Then I've got one AxisAngleRotation3D for each of
the three primary axes and a ScaleTransform3D for the zoom feature.</p>

<p>Now the four sliders:</p>

<p style="margin-left: 0.5in;"><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: blue;">&lt;</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: rgb(163, 21, 21);">Slider</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: blue;"> </span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: red;">Name</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: blue;">=</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;">"<span style="color: blue;">slider_zoom</span>"<br>
<span style="color: blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Orientation</span><span style="color: blue;">=</span>"<span style="color: blue;">Vertical</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Minimum</span><span style="color: blue;">=</span>"<span style="color: blue;">0.2</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Maximum</span><span style="color: blue;">=</span>"<span style="color: blue;">10</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">ValueChanged</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_zoom_changed</span>"<span style="color: blue;"> /&gt;<br>
&lt;</span><span style="color: rgb(163, 21, 21);">Slider</span><span style="color: blue;"> </span><span style="color: red;">Name</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_x</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">DockPanel.Dock</span><span style="color: blue;">=</span>"<span style="color: blue;">Right</span>"<br>
<span style="color: blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Orientation</span><span style="color: blue;">=</span>"<span style="color: blue;">Vertical</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Minimum</span><span style="color: blue;">=</span>"<span style="color: blue;">-180</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Maximum</span><span style="color: blue;">=</span>"<span style="color: blue;">180</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">ValueChanged</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_x_changed</span>"<span style="color: blue;"> /&gt;<br>
&lt;</span><span style="color: rgb(163, 21, 21);">Slider</span><span style="color: blue;"> </span><span style="color: red;">Name</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_z</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">DockPanel.Dock</span><span style="color: blue;">=</span>"<span style="color: blue;">Top</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Orientation</span><span style="color: blue;">=</span>"<span style="color: blue;">Horizontal</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Minimum</span><span style="color: blue;">=</span>"<span style="color: blue;">-180</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Maximum</span><span style="color: blue;">=</span>"<span style="color: blue;">180</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">ValueChanged</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_z_changed</span>"<span style="color: blue;"> /&gt;<br>
&lt;</span><span style="color: rgb(163, 21, 21);">Slider</span><span style="color: blue;"> </span><span style="color: red;">Name</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_y</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">DockPanel.Dock</span><span style="color: blue;">=</span>"<span style="color: blue;">Bottom</span>"<br>
<span style="color: blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Orientation</span><span style="color: blue;">=</span>"<span style="color: blue;">Horizontal</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Minimum</span><span style="color: blue;">=</span>"<span style="color: blue;">-180</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">Maximum</span><span style="color: blue;">=</span>"<span style="color: blue;">180</span>"<span style="color: blue;"> <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: red;">ValueChanged</span><span style="color: blue;">=</span>"<span style="color: blue;">slider_y_changed</span>"<span style="color: blue;"> /&gt;</span></span></p>

<p>Finally, in the event handlers for each slider, I update the
corresponding piece of the transform.&nbsp; For example, to update the rotation
around the X axis, I do something like this:</p>

<p style="margin-left: 0.5in;"><span style="font-size: 10pt; font-family: &quot;Courier New&quot;; color: blue;">void</span><span style="font-size: 10pt; font-family: &quot;Courier New&quot;;"> slider_x_changed(<span style="color: blue;">object</span> sender, <span style="color: rgb(43, 145, 175);">RoutedEventArgs</span>
args)<br>
{<br>
&nbsp;&nbsp;&nbsp; rot_x.Angle = slider_x.Value;<br>
}</span></p>

<p>At the moment, my four sliders are serving me well, but I'll
probably put something like the Trackball back into the app eventually.</p>

<p></p><hr>
<a href="javascript:HaloScan('1694');" target="_self"><script type="text/javascript">postCount('1694');</script>Comments (5)</a><p>
</p>
</td></tr>
</tbody></table>
</td>
<td bgcolor="white">&nbsp;</td>
</tr>
<tr valign="bottom">
<td align="left" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_lower_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_lower_right.png"></td>
<td>&nbsp;</td>
<td align="left" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_lower_left.png"></td>
<td bgcolor="white">&nbsp;</td>
<td align="right" bgcolor="white"><img src="9%20Rotate%20and%20Zoom_files/corner_inside_lower_right.png"></td>
</tr>
<tr><td colspan="7" class="Copyright">Copyright 2001-2007 Eric Sink. All Rights Reserved</td>
<td align="right">&nbsp;</td>
</tr>
</tbody></table>
</td>
<td>&nbsp;</td>
</tr>
<tr valign="bottom">
<td align="left"><img src="9%20Rotate%20and%20Zoom_files/corner_main_lower_left.png"></td>
<td>&nbsp;</td>
<td align="right"><img src="9%20Rotate%20and%20Zoom_files/corner_main_lower_right.png"></td>
</tr>
</tbody></table></body></html>