<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0104)http://blogs.microsoft.co.il/blogs/tamir/archive/2007/10/18/how-to-build-dynamic-menus-and-toolbars.aspx -->
<HTML lang=en xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><HEAD 
id=ctl00_ctl00><TITLE>How to build dynamic menus and toolbars - Just code - Tamir Khason</TITLE>
<META 
content="Technology blog about new Microsoft technologies. E.g. WPF, crossbow, .NET framework 3, Live etc. It includes code sources and samples" 
name=description>
<META 
content=".NET Framework, Example, Internals, Microsoft, Programming, Source Code, technology, tutorial, wpf." 
name=keywords>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blogs.microsoft.co.il/blogs/tamir/pingback.aspx" rel=pingback><LINK 
href="/favicon.ico" type=image/ico rel="shortcut icon"><LINK 
title="Just code - Tamir Khason (RSS 2.0)" 
href="http://feeds.feedburner.com/microsft" type=application/rss+xml 
rel=alternate><LINK title="Just code - Tamir Khason - All Comments (RSS 2.0)" 
href="http://blogs.microsoft.co.il/blogs/tamir/rsscomments.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="How to build dynamic menus and toolbars - Comments for this post (RSS 2.0)" 
href="http://blogs.microsoft.co.il/blogs/tamir/rsscomments.aspx?PostID=28152" 
type=application/rss+xml rel=alternate>
<META http-equiv=Content-Type content="text/html; charset=UTF-8"><LINK 
media=screen 
href="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/style.css" 
type=text/css rel=stylesheet><LINK media=print 
href="/Themes/Blogs/luxinterior/style/print.css?SectionID=181" type=text/css 
rel=stylesheet><LINK media=screen 
href="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/light_sidebar_left_wide.css" 
type=text/css rel=stylesheet><LINK media=screen 
href="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/DynamicStyle.css" 
type=text/css rel=stylesheet>
<SCRIPT 
src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-486526-1";
urchinTracker();
</SCRIPT>
</HEAD>
<BODY>
<FORM id=aspnetForm name=aspnetForm 
onsubmit="javascript:return WebForm_OnSubmit();" 
action=/blogs/tamir/archive/2007/10/18/how-to-build-dynamic-menus-and-toolbars.aspx 
method=post>
<DIV><INPUT id=__EVENTTARGET type=hidden name=__EVENTTARGET> <INPUT 
id=__EVENTARGUMENT type=hidden name=__EVENTARGUMENT> <INPUT id=__VIEWSTATE 
type=hidden 
value=/wEPDwULLTIwMjk4NDE1MzdkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBS5jdGwwMCRNYWluJGN0bDA4JGN0bDAyJGN0bDAyJGN0bDAyJGNoa1JlbWVtYmVyNnOa7G3ox0C7N39AE+DRj1GRFAw= 
name=__VIEWSTATE> </DIV>
<SCRIPT type=text/javascript>
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</SCRIPT>

<SCRIPT 
src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/WebResource.axd" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="J:\_Oct 19 2007\WPF Xaml Expression\WPF\Dynamic Creation\build dynamic menus and toolbars\How to build dynamic menus and toolbars - Just code - Tamir Khason_files\WebResource(1).axd" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="J:\_Oct 19 2007\WPF Xaml Expression\WPF\Dynamic Creation\build dynamic menus and toolbars\How to build dynamic menus and toolbars - Just code - Tamir Khason_files\WebResource(2).axd" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="J:\_Oct 19 2007\WPF Xaml Expression\WPF\Dynamic Creation\build dynamic menus and toolbars\How to build dynamic menus and toolbars - Just code - Tamir Khason_files\WebResource(3).axd" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="J:\_Oct 19 2007\WPF Xaml Expression\WPF\Dynamic Creation\build dynamic menus and toolbars\How to build dynamic menus and toolbars - Just code - Tamir Khason_files\WebResource(4).axd" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
<!--   
    function ValidateCaptcha(val, args) {
      
        var value = args.Value;
        var nameEQ = "CAPTCHA=";
        var captchaNumbers;        	
        var ca = document.cookie.split(';');
        
        for(var i=0;i < ca.length;i++) {
    	    var c = ca[i];
    	    while (c.charAt(0)==' ') c = c.substring(1,c.length);
    	    if (c.indexOf(nameEQ) == 0) captchaNumbers =  c.substring(nameEQ.length,c.length);
	    }

        args.IsValid = captchaNumbers == value;

    }
-->
</SCRIPT>

<SCRIPT 
src="J:\_Oct 19 2007\WPF Xaml Expression\WPF\Dynamic Creation\build dynamic menus and toolbars\How to build dynamic menus and toolbars - Just code - Tamir Khason_files\WebResource(5).axd" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</SCRIPT>

<DIV id=masthead>
<DIV id=welcome align=right><A 
href="http://blogs.microsoft.co.il/login.aspx?ReturnUrl=%2fblogs%2ftamir%2farchive%2f2007%2f10%2f18%2fhow-to-build-dynamic-menus-and-toolbars.aspx">Sign 
in </A>| <A 
href="http://blogs.microsoft.co.il/user/CreateUser.aspx?ReturnUrl=">Join</A> | 
<A href="http://communityserver.org/r.ashx?K">Help</A> </DIV></DIV>
<DIV id=wrapper>
<DIV id=container>
<DIV id=header>
<DIV id=title>
<H1 class=headermaintitle><A 
href="http://blogs.microsoft.co.il/blogs/tamir/">Just code - Tamir 
Khason</A></H1>
<P id=tagline>Take care of the sense, and the sounds will take care of 
themselves.</P></DIV>
<DIV id=SubscriptionsSideBar>
<DIV id=subscriptions>
<UL>
  <LI><A href="http://feeds.feedburner.com/microsft">RSS</A> 
  <LI><A href="http://feeds.feedburner.com/microsft">Atom</A> 
  <LI id=RssComments><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/rsscomments.aspx">Comments 
  RSS</A> </LI></UL></DIV></DIV>
<DIV id=nav>
<UL>
  <LI><A href="http://blogs.microsoft.co.il/blogs/tamir/">Home</A> 
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/contact.aspx">Contact</A> 
</LI></UL></DIV></DIV>
<DIV id=contentwrapper>
<DIV id=sidebar-a>
<DIV id=TasksSideBar></DIV>
<DIV id=SearchSideBar>
<DIV id=Search>
<H3>Search</H3>
<UL>
  <LI><INPUT class=searchBox id=ctl00_SideBar_ctl01_ctl00_SearchBox 
  onblur="if(this.value=='') this.value=this.defaultValue;" 
  onclick="if(this.defaultValue==this.value) this.value='';" 
  name=ctl00$SideBar$ctl01$ctl00$SearchBox Button="SearchButton"> <A 
  class=SearchButton id=ctl00_SideBar_ctl01_ctl00_SearchButton 
  href="javascript:__doPostBack('ctl00$SideBar$ctl01$ctl00$SearchButton','')">Go</A> 
  </LI></UL></DIV></DIV>
<DIV id=TagSideBar>
<H3>Tags</H3>
<UL class=SidebarTagCloud>
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Accessibility/default.aspx" 
  rel=tag>Accessibility</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/blogging+general/default.aspx" 
  rel=tag>blogging general</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Blogging+rules/default.aspx" 
  rel=tag>Blogging rules</A> 
  <LI class=Tag3><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/blogging+tools/default.aspx" 
  rel=tag>blogging tools</A> 
  <LI class=Tag2><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/C_2300_/default.aspx" 
  rel=tag>C#</A> 
  <LI class=Tag5><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/demos/default.aspx" 
  rel=tag>demos</A> 
  <LI class=Tag2><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/download/default.aspx" 
  rel=tag>download</A> 
  <LI class=Tag5><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/events/default.aspx" 
  rel=tag>events</A> 
  <LI class=Tag4><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/fun/default.aspx" 
  rel=tag>fun</A> 
  <LI class=Tag4><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/help/default.aspx" 
  rel=tag>help</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/jobs/default.aspx" 
  rel=tag>jobs</A> 
  <LI class=Tag4><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Mobile/default.aspx" 
  rel=tag>Mobile</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Performance/default.aspx" 
  rel=tag>Performance</A> 
  <LI class=Tag1><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/promo/default.aspx" 
  rel=tag>promo</A> 
  <LI class=Tag3><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Silverlight/default.aspx" 
  rel=tag>Silverlight</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/SkyDrive/default.aspx" 
  rel=tag>SkyDrive</A> 
  <LI class=Tag1><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/soft/default.aspx" 
  rel=tag>soft</A> 
  <LI class=Tag1><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/source/default.aspx" 
  rel=tag>source</A> 
  <LI class=Tag2><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/thoughts/default.aspx" 
  rel=tag>thoughts</A> 
  <LI class=Tag1><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Tips+and+Tricks/default.aspx" 
  rel=tag>Tips and Tricks</A> 
  <LI class=Tag2><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/tools/default.aspx" 
  rel=tag>tools</A> 
  <LI class=Tag1><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/tutorial/default.aspx" 
  rel=tag>tutorial</A> 
  <LI class=Tag2><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Vista/default.aspx" 
  rel=tag>Vista</A> 
  <LI class=Tag3><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Vista+Battery+Saver/default.aspx" 
  rel=tag>Vista Battery Saver</A> 
  <LI class=Tag3><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Visual+Studio/default.aspx" 
  rel=tag>Visual Studio</A> 
  <LI class=Tag5><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/VSTS/default.aspx" 
  rel=tag>VSTS</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/WCF/default.aspx" 
  rel=tag>WCF</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Web/default.aspx" 
  rel=tag>Web</A> 
  <LI class=Tag4><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Windows+Gadgets/default.aspx" 
  rel=tag>Windows Gadgets</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Windows+Live/default.aspx" 
  rel=tag>Windows Live</A> 
  <LI class=Tag6><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Windows+Live+Writer/default.aspx" 
  rel=tag>Windows Live Writer</A> 
  <LI class=Tag1><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/WPF/default.aspx" 
  rel=tag>WPF</A> 
  <LI class=Tag5><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/WPF+crossbow/default.aspx" 
  rel=tag>WPF crossbow</A> 
  <LI class=Tag5><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/WPF_2F00_E/default.aspx" 
  rel=tag>WPF/E</A> </LI></UL></DIV>
<DIV id=NewsSidebar>
<H3>News</H3>
<UL><A href="http://www.linkedin.com/in/tamirk"><IMG height=15 
  alt="View Tamir Khason's profile on LinkedIn" 
  src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/btn_profile_bluetxt_80x15.gif" 
  width=80 border=0></A> </UL></DIV>
<DIV id=NavSideBar>
<H3>Navigation</H3>
<UL>
  <LI><A href="http://blogs.microsoft.co.il/">Home</A>
  <LI><A href="http://blogs.microsoft.co.il/blogs/">Blogs</A>
  <LI><A href="http://blogs.microsoft.co.il/blogs/MainFeed.aspx">RSS</A> 
</LI></UL></DIV>
<DIV id=ArchiveSideBar>
<H3>Archives</H3>
<UL>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/10.aspx">October 
  2007 (19)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/09.aspx">September 
  2007 (14)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/08.aspx">August 
  2007 (21)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/07.aspx">July 2007 
  (32)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/06.aspx">June 2007 
  (10)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/05.aspx">May 2007 
  (22)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/04.aspx">April 
  2007 (21)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/03.aspx">March 
  2007 (20)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/02.aspx">February 
  2007 (9)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/01.aspx">January 
  2007 (10)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2006/12.aspx">December 
  2006 (11)</A>
  <LI><A 
  href="http://blogs.microsoft.co.il/blogs/tamir/archive/2006/11.aspx">November 
  2006 (4)</A> </LI></UL></DIV></DIV>
<DIV id=content>
<DIV id=content2>
<DIV class=post>
<DIV class=posthead>Thursday, October 18, 2007 12:27 PM <A 
href="http://blogs.microsoft.co.il/members/tamir.aspx">Tamir Khason</A> 
<H2>How to build dynamic menus and toolbars </H2></DIV>
<P>The challenge is as following:</P>
<UL>
  <LI>I want to have external XAML files with menus and toolbars 
  <LI>I do not want to recompile project if I want to change something in those 
  menus and toolbars 
  <LI>I want to provide commands for those menus and toolbars without 
  recompiling 
  <LI>I want to write least amount of code to provide such functionality</LI></UL>
<P>What's the problem? The answer is XamlReader. First let's create menus and 
toolbars in external loose XAML files and put them into our BIN directory. </P>
<P><U>Menu1.xaml</U></P>
<P>&lt;Menu xmlns="<A 
href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</A> 
<BR>&nbsp;&nbsp;&nbsp; xmlns:x="<A 
href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</A>&gt; 
<BR>&nbsp; &lt;MenuItem Header="Edit"&gt; <BR>&nbsp;&nbsp;&nbsp; &lt;MenuItem 
Command="ApplicationCommands.Cut"/&gt; <BR>&nbsp;&nbsp;&nbsp; &lt;MenuItem 
Command="ApplicationCommands.Copy"/&gt; <BR>&nbsp;&nbsp;&nbsp; &lt;MenuItem 
Command="ApplicationCommands.Paste"/&gt; <BR>&nbsp; &lt;/MenuItem&gt; 
<BR>&lt;/Menu&gt;</P>
<P><U>ToolBar1.xaml</U></P>
<P>&lt;ToolBar xmlns="<A 
href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</A> 
<BR>&nbsp;&nbsp;&nbsp; xmlns:x="<A 
href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</A>&gt; 
<BR>&nbsp; &lt;Button Command="ApplicationCommands.Cut"&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;Image Source="pack://siteoforigin:,,,/cut.png"/&gt; 
<BR>&nbsp; &lt;/Button&gt; <BR>&nbsp;&nbsp;&nbsp; &lt;Button 
Command="ApplicationCommands.Copy"&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;Image Source="pack://siteoforigin:,,,/copy.png"/&gt; <BR>&nbsp;&nbsp;&nbsp; 
&lt;/Button&gt; <BR>&nbsp;&nbsp;&nbsp; &lt;Button 
Command="ApplicationCommands.Paste"&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;Image Source="pack://siteoforigin:,,,/paste.png"/&gt; <BR>&nbsp;&nbsp;&nbsp; 
&lt;/Button&gt; <BR>&lt;/ToolBar&gt;</P>
<P>Now let's create out window</P>
<P><U>Window1.xaml</U></P>
<P>&lt;Window x:Class="DynamicMenu.Window1" <BR>&nbsp;&nbsp;&nbsp; xmlns="<A 
href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</A> 
<BR>&nbsp;&nbsp;&nbsp; xmlns:x="<A 
href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</A> 
<BR>&nbsp;&nbsp;&nbsp; Title="DynamicMenu" Height="300" Width="300" 
<BR>&nbsp;&nbsp;&nbsp; &gt; <BR>&nbsp; &lt;Window.Resources&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;Style TargetType="Image"&gt; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Style.Triggers&gt; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Trigger Property="IsEnabled" 
Value="False"&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;Setter Property="Opacity" Value="0.5"/&gt; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Trigger&gt; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Style.Triggers&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;/Style&gt; <BR>&nbsp; &lt;/Window.Resources&gt; 
<BR>&nbsp;&nbsp;&nbsp; &lt;StackPanel Name="main"&gt; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBox/&gt; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBox/&gt; <BR>&nbsp;&nbsp;&nbsp; 
&lt;/StackPanel&gt; <BR>&lt;/Window&gt;</P>
<P>Now, the only thing we should do it to read Menu1.xaml and TooBar1.xaml from 
our BIN directory and add Menu and ToolBar controls dynamically to the page</P>
<P>public Window1() <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
InitializeComponent(); 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using 
(FileStream s = new FileStream("Menu1.xaml", FileMode.Open)) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
Menu menu = XamlReader.Load(s, new ParserContext()) as Menu; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
if (menu != null) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{ 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
main.Children.Insert(0, menu); 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
} <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using 
(FileStream s = new FileStream("ToolBar1.xaml", FileMode.Open)) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
ToolBar tool = XamlReader.Load(s, new ParserContext()) as ToolBar; 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
if (tool != null) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{ 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
main.Children.Insert(1, tool); 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
} <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </P>
<P><IMG height=158 alt=image 
src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/image_5f784c5f-1228-4859-a907-e308a481105d.png" 
width=225 border=0> </P>
<P>We done. Have a nice day :)</P>
<P><A class="" 
href="http://blogs.microsoft.co.il/blogs/tamir/attachment/28152.ashx">Source 
code for this article</A></P><SPAN id=ctl00_Main_ctl07_ctl01>Filed under: <A 
href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/WPF/default.aspx" 
rel=tag>WPF</A>, <A 
href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/tutorial/default.aspx" 
rel=tag>tutorial</A>, <A 
href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/Tips+and+Tricks/default.aspx" 
rel=tag>Tips and Tricks</A>, <A 
href="http://blogs.microsoft.co.il/blogs/tamir/archive/tags/source/default.aspx" 
rel=tag>source</A></SPAN><INPUT id=ctl00_Main_ctl07_ctl01_State type=hidden 
value=nochange name=ctl00$Main$ctl07$ctl01> </DIV>
<DIV class=postfoot>
<DIV><SPAN class=em>Attachment:</SPAN> <A 
href="http://blogs.microsoft.co.il/blogs/tamir/attachment/28152.ashx">DynamicMenu.zip</A></DIV></DIV><A 
name=Comments>
<H3>Comments</H3>
<DIV id=comments>
<DIV class=comment>
<H4><A 
href="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/10/18/how-to-build-dynamic-menus-and-toolbars.aspx#29472">#</A> 
<SPAN>How to build dynamic menus and toolbars</SPAN> </H4>
<DIV class=commentssubhead><SPAN class=commentspan></SPAN>Thursday, October 25, 
2007 2:28 AM by <A title=TrackBack 
href="http://geeks.ms/blogs/roller/archive/2007/10/18/how-to-build-dynamic-menus-and-toolbars.aspx" 
rel=nofollow>Noticias externas</A> </DIV>
<DIV class=commentsbody>
<P>
<P>The challenge is as following: I want to have external XAML files with menus 
and toolbars I do not want</P>
<P></P></DIV></DIV></DIV>
<DIV id=commentform>
<H3>Leave a Comment</H3>
<DL>
  <DT><LABEL for=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbTitle>Title</LABEL> 
  <EM>(required)</EM><SPAN id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02 
  style="VISIBILITY: hidden; COLOR: red">*</SPAN> 
  <DD><INPUT class=smallbox id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbTitle 
  value="re: How to build dynamic menus and toolbars" 
  name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$tbTitle> 
  <DT id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_NameTitle><LABEL 
  for=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbName>Name</LABEL> 
  <EM>(required)</EM><SPAN id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10 
  style="VISIBILITY: hidden; COLOR: red">*</SPAN> 
  <DD id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_NameDesc><INPUT class=smallbox 
  id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbName 
  name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$tbName> 
  <DT><LABEL for=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbUrl>Your URL</LABEL> 
  <EM>(optional</EM>) 
  <DD><INPUT class=smallbox id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbUrl 
  name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$tbUrl> 
  <DT><LABEL for=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbComment>Comments</LABEL> 
  <EM>(required)</EM><SPAN id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07 
  style="VISIBILITY: hidden; COLOR: red">*</SPAN> 
  <DD><TEXTAREA id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbComment name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$tbComment rows=5 cols=25></TEXTAREA> 

  <DT><INPUT id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_chkRemember type=checkbox 
  name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$chkRemember><LABEL 
  for=ctl00_Main_ctl08_ctl02_ctl02_ctl02_chkRemember>Remember Me?</LABEL> 
  <DT>
  <DIV class=Captcha_Div id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_CaptchaPanel><IMG 
  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
  src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/captcha.jpg"><BR><SPAN>Enter 
  the numbers above: </SPAN><INPUT 
  id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_CaptchaTextBox size=3 
  name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$CaptchaTextBox><SPAN 
  id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13 
  style="DISPLAY: none; COLOR: red">*</SPAN> </DIV><INPUT id=ctl00_Main_ctl08_ctl02_ctl02_ctl02_btnSubmit onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$Main$ctl08$ctl02$ctl02$ctl02$btnSubmit", "", true, "CreateCommentForm", "", false, false))' type=submit value=Submit name=ctl00$Main$ctl08$ctl02$ctl02$ctl02$btnSubmit> 
  </DT></DL></DIV></DIV></DIV>
<DIV id=contentfooter>&nbsp;</DIV></DIV>
<DIV id=footer>
<DIV class=Copyright>
<DIV align=center>‎©2006 Microsoft Corporation. All rights reserved.‎ <SPAN><A 
href="http://www.microsoft.com/israel/info/cpyright.asp">תנאי שימוש</A> 
|</SPAN><SPAN><A 
href="http://www.microsoft.com/library/toolbar/3.0/trademarks/he-il.mspx">סימנים 
מסחריים</A> |</SPAN><SPAN><A 
href="http://www.microsoft.com/info/iw/privacy.mspx">הצהרת 
פרטיות</A></SPAN></DIV></DIV><A href="http://communityserver.org/r.ashx?j" 
target=_blank><IMG id=ctl00_BodyFooterRegion_ctl02_ctl03_ctl00 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
alt="Powered by Community Server (Commercial Edition), by Telligent Systems " 
src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/PoweredByCS_commercial.gif"></A> 
</DIV></DIV></DIV>
<SCRIPT type=text/javascript>
<!--
var Page_Validators =  new Array(document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02"), document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10"), document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07"), document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13"));
// -->
</SCRIPT>

<SCRIPT type=text/javascript>
<!--
var ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02 = document.all ? document.all["ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02"] : document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02");
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02.controltovalidate = "ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbTitle";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02.errormessage = "*";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02.validationGroup = "CreateCommentForm";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl02.initialvalue = "";
var ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10 = document.all ? document.all["ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10"] : document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10");
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10.controltovalidate = "ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbName";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10.errormessage = "*";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10.validationGroup = "CreateCommentForm";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl10.initialvalue = "";
var ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07 = document.all ? document.all["ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07"] : document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07");
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07.controltovalidate = "ctl00_Main_ctl08_ctl02_ctl02_ctl02_tbComment";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07.errormessage = "*";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07.validationGroup = "CreateCommentForm";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl07.initialvalue = "";
var ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13 = document.all ? document.all["ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13"] : document.getElementById("ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13");
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.controltovalidate = "ctl00_Main_ctl08_ctl02_ctl02_ctl02_CaptchaTextBox";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.errormessage = "*";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.display = "Dynamic";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.validationGroup = "CreateCommentForm";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.evaluationfunction = "CustomValidatorEvaluateIsValid";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.clientvalidationfunction = "ValidateCaptcha";
ctl00_Main_ctl08_ctl02_ctl02_ctl02_ctl13.validateemptytext = "true";
// -->
</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/10/18/how-to-build-dynamic-menus-and-toolbars.aspx"
dc:identifier="http://blogs.microsoft.co.il/blogs/tamir/archive/2007/10/18/how-to-build-dynamic-menus-and-toolbars.aspx"
dc:title="How to build dynamic menus and toolbars"
trackback:ping="http://blogs.microsoft.co.il/blogs/tamir/trackback.ashx?PostID=28152" />
</rdf:RDF>
-->
<SCRIPT 
src="How to build dynamic menus and toolbars - Just code - Tamir Khason_files/microsft.aspx" 
type=text/javascript charset=utf-8></SCRIPT>

<SCRIPT type=text/javascript>
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</SCRIPT>

<SCRIPT type=text/javascript>
// <![CDATA[
window.ctl00_Main_ctl07_ctl01 = new Telligent_InlineEditorPanel('ctl00_Main_ctl07_ctl01','ctl00_Main_ctl07_ctl01','ctl00_Main_ctl07_ctl01_State','ctl00_Main_ctl07_ctl00',false,null,null,null);
// ]]>
</SCRIPT>

<SCRIPT type=text/javascript>
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</SCRIPT>
</FORM></BODY></HTML>
