<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0067)http://blog.rioterdecker.net/blogs/chaz/archive/2006/03/06/100.aspx -->
<HTML><HEAD><TITLE>Chaz : Create and apply custom themes</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META content=WPF name=keywords>
<META 
content="Introduction &#13;&#10;&#13;&#10;&#13;&#10;With WPF, Microsoft introduces one of the most famous mechanism until now reserved almost exclusively for web applications, available for any types of application: UI composed by themes. Indeed, all visual elements can be defined by" 
name=description>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blog.rioterdecker.net/blogs/pingback.aspx" rel=pingback><LINK 
media=screen href="Chaz  Create and apply custom themes_files/style.css" 
type=text/css rel=stylesheet><LINK media=print 
href="Chaz  Create and apply custom themes_files/print.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="Chaz  Create and apply custom themes_files/right%20sidebar.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel="shortcut icon"><LINK title="Chaz (RSS 2.0)" 
href="http://blog.rioterdecker.net/blogs/chaz/rss.aspx" type=application/rss+xml 
rel=alternate><LINK title="Chaz (Atom 1.0)" 
href="http://blog.rioterdecker.net/blogs/chaz/atom.aspx" 
type=application/atom+xml rel=alternate><LINK 
title="Create and apply custom themes Comment RSS (RSS 2.0)" 
href="http://blog.rioterdecker.net/blogs/chaz/commentrss.aspx?PostID=100" 
type=application/rss+xml rel=alternate>
<SCRIPT src="Chaz  Create and apply custom themes_files/global.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<FORM id=__aspnetForm name=__aspnetForm 
action=/blogs/chaz/archive/2006/03/06/100.aspx method=post><INPUT type=hidden 
name=__EVENTTARGET> <INPUT type=hidden name=__EVENTARGUMENT> <INPUT type=hidden 
value=dDwxOTEyODEyMTQ3OztsPF9jdGwwOl86X2N0bDA6XzpCbG9nU2lkZUJhcjE6Xzp3czpfOlNlYXJjaEJveDs+PgUL+f/GgIJK9otucOax//Q380gO 
name=__VIEWSTATE>
<SCRIPT language=javascript type=text/javascript>
<!--
	function __doPostBack(eventTarget, eventArgument) {
		var theform;
		if (window.navigator.appName.toLowerCase().indexOf("microsoft") > -1) {
			theform = document.__aspnetForm;
		}
		else {
			theform = document.forms["__aspnetForm"];
		}
		theform.__EVENTTARGET.value = eventTarget.split("$").join(":");
		theform.__EVENTARGUMENT.value = eventArgument;
		theform.submit();
	}
// -->
</SCRIPT>

<SCRIPT language=javascript type=text/javascript>
var RatingControlAJAX = {

"SaveRating": function(id, rating, clientCallBack) {
	return Ajax_CallBack('CommunityServer.Blogs.Controls.BlogRatePost', id, 'SaveRating', [rating], clientCallBack, false, false, false, true,'/blogs/chaz/archive/2006/03/06/100.aspx?Ajax_CallBack=true');
}

};
</SCRIPT>
 
<DIV id=masthead>
<DIV id=welcome align=right>Welcome to RioterDeckers' HeadQuarter <A 
id=_ctl0____ctl0___duw1_ac1___Login 
href="http://blog.rioterdecker.net/login.aspx?ReturnUrl=/blogs/chaz/archive/2006/03/06/100.aspx">Sign 
in</A> | <A id=_ctl0____ctl0___duw1_ac1___Register 
href="http://blog.rioterdecker.net/user/CreateUser.aspx?ReturnUrl=/blogs/chaz/archive/2006/03/06/100.aspx">Join</A> 
| <A id=_ctl0____ctl0___duw1_Faq1 
href="http://blog.rioterdecker.net/languages/en-US/docs/faq.aspx">Help</A> 
</DIV></DIV>
<DIV id=wrapper>
<DIV id=container>
<DIV id=header>
<DIV id=title>
<H1><A class=headermaintitle id=_ctl0____ctl0___BlogTitleHeader1___BlogTitle 
href="http://blog.rioterdecker.net/blogs/chaz/default.aspx">Chaz</A></H1>
<P id=tagline>WPF underground</P></DIV></DIV>
<DIV id=contentwrapper>
<DIV id=sidebar-a>
<DIV id=WeblogLinks>
<H3>This Blog</H3>
<UL>
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/about.aspx">About</A> 
  </LI></UL></DIV>
<H3>Calendar</H3>
<DIV id=Cal align=center>
<UL>
  <LI>
  <TABLE class=Calendar id=PostCalendar cellSpacing=0 cellPadding=2 border=0>
    <TBODY>
    <TR>
      <TD colSpan=7>
        <TABLE class=CalendarTitle cellSpacing=0 border=0>
          <TBODY>
          <TR>
            <TD class=CalendarNextPrev align=middle><A style="COLOR: black" 
              href="javascript:__doPostBack('_ctl0$_$_ctl0$_$BlogSideBar1$_$Cal$_$PostCalendar','V2223')">Feb</A></TD>
            <TD align=middle>March 2006</TD>
            <TD class=CalendarNextPrev align=right><A style="COLOR: black" 
              href="javascript:__doPostBack('_ctl0$_$_ctl0$_$BlogSideBar1$_$Cal$_$PostCalendar','V2282')">Apr</A></TD></TR></TBODY></TABLE></TD></TR>
    <TR>
      <TD class=CalendarDayHeader align=middle>S</TD>
      <TD class=CalendarDayHeader align=middle>M</TD>
      <TD class=CalendarDayHeader align=middle>T</TD>
      <TD class=CalendarDayHeader align=middle>W</TD>
      <TD class=CalendarDayHeader align=middle>T</TD>
      <TD class=CalendarDayHeader align=middle>F</TD>
      <TD class=CalendarDayHeader align=middle>S</TD></TR>
    <TR>
      <TD class=CalendarOtherMonth align=middle>26</TD>
      <TD class=CalendarOtherMonth align=middle>27</TD>
      <TD class=CalendarOtherMonth align=middle>28</TD>
      <TD align=middle>1</TD>
      <TD align=middle>2</TD>
      <TD align=middle>3</TD>
      <TD class=CalendarWeekend align=middle>4</TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>5</TD>
      <TD align=middle><A title="1 Post" 
        href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/3/6.aspx">6</A></TD>
      <TD align=middle>7</TD>
      <TD align=middle>8</TD>
      <TD align=middle>9</TD>
      <TD align=middle>10</TD>
      <TD class=CalendarWeekend align=middle>11</TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>12</TD>
      <TD align=middle>13</TD>
      <TD align=middle>14</TD>
      <TD align=middle>15</TD>
      <TD align=middle>16</TD>
      <TD align=middle>17</TD>
      <TD class=CalendarWeekend align=middle><A title="1 Post" 
        href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/3/18.aspx">18</A></TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>19</TD>
      <TD align=middle>20</TD>
      <TD align=middle>21</TD>
      <TD align=middle>22</TD>
      <TD align=middle>23</TD>
      <TD align=middle>24</TD>
      <TD class=CalendarWeekend align=middle>25</TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>26</TD>
      <TD align=middle>27</TD>
      <TD align=middle>28</TD>
      <TD align=middle>29</TD>
      <TD align=middle>30</TD>
      <TD align=middle>31</TD>
      <TD class=CalendarOtherMonth align=middle>1</TD></TR>
    <TR>
      <TD class=CalendarOtherMonth align=middle>2</TD>
      <TD class=CalendarOtherMonth align=middle>3</TD>
      <TD class=CalendarOtherMonth align=middle>4</TD>
      <TD class=CalendarOtherMonth align=middle>5</TD>
      <TD class=CalendarOtherMonth align=middle>6</TD>
      <TD class=CalendarOtherMonth align=middle>7</TD>
      <TD class=CalendarOtherMonth 
align=middle>8</TD></TR></TBODY></TABLE></LI></UL></DIV>
<H3>Search</H3>
<DIV id=Search>
<UL>
  <LI><INPUT class=searchBox id=_ctl0____ctl0___BlogSideBar1___ws___SearchBox 
  onkeydown=KeyDownHandler_ctl0____ctl0___BlogSideBar1___ws___SearchButton(event); 
  name=_ctl0:_:_ctl0:_:BlogSideBar1:_:ws:_:SearchBox> <A 
  id=_ctl0____ctl0___BlogSideBar1___ws___SearchButton 
  href="javascript:__doPostBack('_ctl0$_$_ctl0$_$BlogSideBar1$_$ws$_$SearchButton','')">Go</A> 
  </LI></UL></DIV>
<DIV id=Subscriptions>
<H3>Syndication</H3>
<UL>
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/rss.aspx">RSS 2.0</A> 
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/atom.aspx">Atom 1.0</A> 
  </LI></UL></DIV>
<H3>Archives</H3>
<UL>
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2007/04.aspx">April 2007 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/11.aspx">November 
  2006 (1)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/10.aspx">October 
  2006 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/06.aspx">June 2006 
  (1)</A> 
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/05.aspx">May 
  2006 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/04.aspx">April 2006 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03.aspx">March 2006 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/02.aspx">February 
  2006 (3)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/01.aspx">January 
  2006 (3)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2005/11.aspx">November 
  2005 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2005/10.aspx">October 
  2005 (1)</A> </LI></UL>
<H3>Navigation</H3>
<DIV id=headertab>
<UL>
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl0_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl0_MenuItem 
  href="http://blog.rioterdecker.net/">Home</A> 
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl1_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl1_MenuItem 
  href="http://blog.rioterdecker.net/blogs/default.aspx">Blogs</A> 
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl2_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl2_MenuItem 
  href="http://blog.rioterdecker.net/photos/default.aspx">Photos</A> 
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl3_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl3_MenuItem 
  href="http://blog.rioterdecker.net/files/default.aspx">Files</A> 
</LI></UL></DIV>
<H3>Post Categories</H3>
<UL>
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1000.aspx">.Net 
  Framework 2.0 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1033.aspx">SilverLight 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1002.aspx">Windows 
  Vista (4)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1001.aspx">WPF 
  (14)</A> </LI></UL>
<H3>Useful links</H3>
<UL>
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl1_Link 
  href="http://blogs.msdn.com/tims/archive/2005/06/10/427565.aspx">WPF 
  Bloggers</A> 
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl2_Link 
  href="http://spaces.msn.com/rrelyea/">Rob Relyea's blog</A> 
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl3_Link 
  href="http://weblogs.asp.net/bleroy/">One of my buddies' blog</A> 
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl4_Link 
  href="http://www.netfxfactory.org/">The NetFxFactory community</A> </LI></UL>
<H3>The Massai project</H3>
<UL>
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl1_Links__ctl1_Link 
  href="http://blog.rioterdecker.net/photos/chaz_blog_pictures/category1031.aspx">Screenshots</A> 
  </LI></UL></DIV>
<DIV id=content>
<DIV class=post>
<DIV class=postview>
<H2>Create and apply custom themes</H2><SPAN>Introduction</SPAN> 
<HR>

<P>With WPF, Microsoft introduces one of the most famous mechanism until now 
reserved almost exclusively for web applications, available for any types of 
application: UI composed by themes. Indeed, all visual elements can be defined 
by style and all styles can be regrouped into a specific theme. With 
extrapolations several themes can also be applied on the same 
application.</P><SPAN><BR>The sample</SPAN> 
<HR>

<P>The sample I provide with this post try to explain how to create several 
external themes for an application. Why themes are externals ? Because I could 
integrate my themes in the same assembly but today many profiles participate in 
the creation of an application. Therefor I would like you to keep in mind that 
an application is often designed following an industrial process (this is 
nevertheless the way where we try to go). A development team might create the 
logic of the application whereas designers imagine the UI by creating several 
themes to be applied.<BR>Because I didn't want to imagine a complex application 
to explain the theme concept, I reused the logon application provided by 
Microsoft with the WinFX SDK. So the sample is composed with 3 parts: an 
assembly with custom controls and the default theme, another containing the 
Window application and another one with custom themes.</P>
<P><A 
href="http://blog.rioterdecker.net/photos/chaz/images/194/original.aspx"></A>&nbsp;<A 
href="http://blog.rioterdecker.net/photos/chaz_blog_pictures/images/99/original.aspx" 
target=_blank><IMG src="Chaz  Create and apply custom themes_files/640x140.jpg" 
border=0></A> 
<P><STRONG>Figure1. Custom themes</STRONG></P><SPAN><BR>Create a generic 
theme</SPAN> 
<HR>

<P>In the first assembly, I define custom controls for the application. It's not 
a constraint but it facilitates the design and the theme to be applied. The only 
thing to do is to override the eventual initial visual styles defined for the 
base controls:<FONT color=#0000ff size=2></P>
<P><FONT face="Courier New">public</FONT></FONT><FONT face="Courier New"><FONT 
size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT 
color=#008080 size=2>LogonButton</FONT><FONT size=2> : </FONT></FONT><FONT 
face="Courier New" color=#008080 size=2>Button<BR></FONT><FONT 
face="Courier New"><FONT size=2>{<BR>&nbsp; </FONT><FONT color=#0000ff 
size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> 
LogonButton()<BR>&nbsp; {<BR>&nbsp; }<BR>&nbsp; </FONT><FONT color=#0000ff 
size=2>static</FONT></FONT><FONT face="Courier New"><FONT size=2> 
LogonButton()<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; 
DefaultStyleKeyProperty.OverrideMetadata(</FONT><FONT color=#0000ff 
size=2>typeof</FONT><FONT size=2>(</FONT><FONT color=#008080 
size=2>LogonButton</FONT><FONT size=2>), </FONT><FONT color=#0000ff 
size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 
size=2>FrameworkPropertyMetadata</FONT><FONT size=2>(</FONT><FONT color=#0000ff 
size=2>typeof</FONT><FONT size=2>(</FONT><FONT color=#008080 
size=2>LogonButton</FONT></FONT><FONT face="Courier New"><FONT 
size=2>)));<BR>&nbsp; }<BR></FONT><FONT size=2>}</FONT></FONT></P>
<P>Assuming a WPF application considers a <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref28/html/T_System_Windows_ResourceDictionary.asp">ResourceDictionary</A> 
to be the default theme, I add a ResourceDictionary named 
<STRONG>generic.xaml</STRONG>. With this name, the dictionary will be 
automatically applied whether no specific dictionary is set. However considering 
that the theme is designed in an independent manner, I choose to use the type of 
the styled object as key instead of a string:</P><FONT color=#0000ff size=2>
<P><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>ResourceDictionary</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>xmlns</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>http://schemas.microsoft.com/winfx/2006/xaml/presentation</FONT></FONT><FONT 
face="Courier New"><FONT size=2>"<BR>&nbsp; </FONT><FONT color=#ff0000 
size=2>xmlns:x</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff 
size=2>http://schemas.microsoft.com/winfx/2006/xaml</FONT></FONT><FONT 
face="Courier New"><FONT size=2>"<BR>&nbsp; </FONT><FONT color=#ff0000 
size=2>xmlns:cc</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff 
size=2>clr-namespace:RD.CustomThemes.Controls</FONT></FONT><FONT 
face="Courier New" size=2>"<BR></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp; &lt;</FONT><FONT color=#800000 
size=2>Style</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>x:Key</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT 
color=#0000ff size=2>{x:Type cc:BackgroundControl}</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>TargetType</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2>{x:Type 
cc:BackgroundControl}</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Setter</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Property</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>Grid.ColumnSpan</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>4</FONT><FONT 
size=2>"</FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 
size=2>Setter</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Property</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2>Grid.RowSpan</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Value</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT 
color=#0000ff size=2>3</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2> /&gt;<BR>&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Setter</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Property</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>Template</FONT><FONT size=2>"</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</FONT><FONT 
color=#800000 size=2>Setter.Value</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>ControlTemplate</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>TargetType</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>{x:Type 
cc:BackgroundControl}</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Grid</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Rectangle</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Grid</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>ControlTemplate</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Setter.Value</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Setter</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp; &lt;/</FONT><FONT color=#800000 
size=2>Style</FONT></FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp; ...<BR>&nbsp; <FONT color=#0000ff 
size=2>&lt;</FONT><FONT color=#800000 size=2>Style</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>x:Key</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>{x:Type cc:LogonButton}</FONT><FONT color=#000000 size=2>"</FONT><FONT 
color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>BasedOn</FONT><FONT 
color=#0000ff size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT 
color=#0000ff size=2>{StaticResource {x:Type Button}}</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>TargetType</FONT><FONT color=#0000ff size=2>=</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2>{x:Type cc:LogonButton}</FONT><FONT 
color=#000000 size=2>"</FONT></FONT><FONT face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;</FONT><FONT color=#800000 
size=2>Setter</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Property</FONT><FONT color=#0000ff size=2>=</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2>Width</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Value</FONT><FONT color=#0000ff size=2>=</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2>150</FONT><FONT color=#000000 
size=2>"</FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;</FONT><FONT color=#800000 
size=2>Setter</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Property</FONT><FONT color=#0000ff size=2>=</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2>Grid.Row</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Value</FONT><FONT color=#0000ff size=2>=</FONT><FONT color=#000000 
size=2>"</FONT><FONT color=#0000ff size=2>2</FONT><FONT color=#000000 
size=2>"</FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp; &lt;/</FONT><FONT color=#800000 size=2>Style</FONT></FONT><FONT 
color=#0000ff size=2><FONT face="Courier New">&gt;<BR><FONT color=#0000ff 
size=2>&lt;/</FONT><FONT color=#800000 size=2>ResourceDictionary</FONT><FONT 
color=#0000ff size=2>&gt;</P></FONT></FONT></FONT></FONT>
<P>A last thing to do is to verify that a generic theme can be properly applied. 
Add the <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref28/html/T_System_Windows_ThemeInfoAttribute.asp">ThemeInfo</A> 
attribute into the AssemblyInfo.cs. Note that with the february CTP, this 
attribute is added for you in the file.</P><FONT size=2>
<P><FONT face="Courier New">[assembly: </FONT></FONT><FONT 
face="Courier New"><FONT color=#008080 size=2>ThemeInfo</FONT><FONT 
size=2>(</FONT><FONT color=#008080 size=2>ResourceDictionaryLocation</FONT><FONT 
size=2>.None, </FONT><FONT size=2></FONT><FONT color=#008080 
size=2>ResourceDictionaryLocation</FONT><FONT size=2>.SourceAssembly</FONT><FONT 
size=2>)]</FONT></FONT></P><SPAN><BR>Create other specific themes</SPAN> 
<HR>

<P>In another assembly I just create a 'themes' folder, add a reference to the 
first assembly and define 3 other themes with no constraint naming convention. 
In each xaml file, I just define the style of each control. The code below comes 
from one of the 3 resource dictionaries:</P><FONT color=#0000ff size=2>
<P><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>ResourceDictionary</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>xmlns</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>http://schemas.microsoft.com/winfx/2006/xaml/presentation</FONT></FONT><FONT 
face="Courier New"><FONT size=2>"<BR>&nbsp; </FONT><FONT color=#ff0000 
size=2>xmlns:x</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff 
size=2>http://schemas.microsoft.com/winfx/2006/xaml</FONT></FONT><FONT 
face="Courier New"><FONT size=2>"<BR>&nbsp; </FONT><FONT color=#ff0000 
size=2>xmlns:cc</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff 
size=2>clr-namespace:RD.CustomThemes.Controls;assembly=RD.CustomThemes.Controls</FONT></FONT><FONT 
face="Courier New" size=2>"<BR></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp; &lt;</FONT><FONT color=#800000 
size=2>Style</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>x:Key</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT 
color=#0000ff size=2>{x:Type cc:BackgroundControl}</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>TargetType</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2>{x:Type 
cc:BackgroundControl}</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Setter</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Property</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>Grid.ColumnSpan</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>4</FONT><FONT 
size=2>"</FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;</FONT><FONT color=#800000 
size=2>Setter</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Property</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2>Grid.RowSpan</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Value</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT 
color=#0000ff size=2>3</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2> /&gt;<BR>&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Setter</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Property</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>Template</FONT><FONT size=2>"</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</FONT><FONT 
color=#800000 size=2>Setter.Value</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>ControlTemplate</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>TargetType</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>{x:Type 
cc:BackgroundControl}</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Grid</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Rectangle</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>Rectangle.Fill</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>LinearGradientBrush</FONT><FONT 
color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>StartPoint</FONT><FONT 
color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff 
size=2>0,0</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT 
color=#ff0000 size=2>EndPoint</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2>0,1</FONT><FONT 
size=2>"</FONT></FONT><FONT face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 
size=2>LinearGradientBrush.GradientStops</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>GradientStop</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Offset</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>0</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Color</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT 
color=#0000ff size=2>White</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;</FONT><FONT color=#800000 size=2>GradientStop</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Offset</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>1</FONT><FONT 
size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>Color</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT 
color=#0000ff size=2>#cc99ccff</FONT><FONT size=2>"</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff size=2> 
/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>LinearGradientBrush.GradientStops</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>LinearGradientBrush</FONT></FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Rectangle.Fill</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Rectangle</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Grid</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>ControlTemplate</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff 
size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Setter.Value</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT><FONT 
color=#800000 size=2>Setter</FONT></FONT><FONT face="Courier New"><FONT 
color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&lt;/</FONT><FONT color=#800000 
size=2>Style</FONT></FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp; ...<BR><FONT color=#0000ff 
size=2>&lt;/</FONT><FONT color=#800000 size=2>ResourceDictionary</FONT><FONT 
color=#0000ff size=2>&gt;</P></FONT></FONT></FONT><SPAN><BR>The Windows 
application</SPAN> 
<HR>

<P>To apply themes from the external assembly, I just deploy it into the windows 
application directory and I choose to load the dictionaries when the application 
starts.<BR>Because I do not want to reference this assembly, I use an Uri to 
load dictionaries. Why I don't want to use a reference ? The reason is very 
simple, I just suppose that during the life of my application, the design team 
could create another theme that could be applied in deploying this new assembly 
into the application directory. I just want the themes to be applied 
dynamically.<BR>The code below doesn't fully implement this concept but the base 
mechanisms are here:</P><FONT color=#0000ff size=2>
<P><FONT face="Courier New">public</FONT></FONT><FONT face="Courier New"><FONT 
size=2> </FONT><FONT color=#0000ff size=2>partial</FONT><FONT size=2> 
</FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT 
color=#008080 size=2>MyApp</FONT><FONT size=2> : </FONT></FONT><FONT 
face="Courier New" color=#008080 size=2>Application<BR></FONT><FONT 
face="Courier New"><FONT size=2>{<BR>&nbsp; </FONT><FONT color=#0000ff 
size=2>private</FONT><FONT size=2> </FONT><FONT color=#008080 
size=2>List</FONT><FONT size=2>&lt;</FONT><FONT color=#008080 
size=2>ResourceDictionary</FONT></FONT><FONT face="Courier New"><FONT 
size=2>&gt; _themeList;<BR><BR>&nbsp; </FONT><FONT color=#0000ff 
size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> 
MyApp()<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; _themeList = </FONT><FONT 
color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 
size=2>List</FONT><FONT size=2>&lt;</FONT><FONT color=#008080 
size=2>ResourceDictionary</FONT></FONT><FONT size=2><FONT 
face="Courier New">&gt;(4);<BR>&nbsp; }</FONT></P></FONT><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>&nbsp; 
internal</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>List</FONT><FONT 
size=2>&lt;</FONT><FONT color=#008080 
size=2>ResourceDictionary</FONT></FONT><FONT face="Courier New"><FONT 
size=2>&gt; AvailableThemes<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT 
color=#0000ff size=2>get</FONT><FONT size=2> { </FONT><FONT color=#0000ff 
size=2>return</FONT></FONT><FONT size=2><FONT face="Courier New"> _themeList; 
}<BR>&nbsp; }</FONT></P></FONT><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>&nbsp; 
private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT 
size=2> ApplicationStartUp(</FONT><FONT color=#0000ff size=2>object</FONT><FONT 
size=2> sender, </FONT><FONT color=#008080 
size=2>StartupEventArgs</FONT></FONT><FONT face="Courier New"><FONT size=2> 
e)<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; _themeList.Add((</FONT><FONT color=#008080 
size=2>ResourceDictionary</FONT><FONT size=2>)</FONT><FONT color=#008080 
size=2>Application</FONT><FONT size=2>.LoadComponent(</FONT><FONT color=#0000ff 
size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>Uri</FONT><FONT 
size=2>(</FONT><FONT color=#800000 
size=2>@"RD.CustomThemes;;;component\themes/customthemes.luna.baml"</FONT><FONT 
size=2>, </FONT><FONT color=#008080 size=2>UriKind</FONT></FONT><FONT 
face="Courier New"><FONT size=2>.Relative)));<BR>&nbsp;&nbsp;&nbsp; 
_themeList.Add((</FONT><FONT color=#008080 size=2>ResourceDictionary</FONT><FONT 
size=2>)</FONT><FONT color=#008080 size=2>Application</FONT><FONT 
size=2>.LoadComponent(</FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> 
</FONT><FONT color=#008080 size=2>Uri</FONT><FONT size=2>(</FONT><FONT 
color=#800000 
size=2>@"RD.CustomThemes;;;component\themes/customthemes.xbox.baml"</FONT><FONT 
size=2>, </FONT><FONT color=#008080 size=2>UriKind</FONT></FONT><FONT 
face="Courier New"><FONT size=2>.Relative)));<BR>&nbsp;&nbsp;&nbsp; 
_themeList.Add((</FONT><FONT color=#008080 size=2>ResourceDictionary</FONT><FONT 
size=2>)</FONT><FONT color=#008080 size=2>Application</FONT><FONT 
size=2>.LoadComponent(</FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> 
</FONT><FONT color=#008080 size=2>Uri</FONT><FONT size=2>(</FONT><FONT 
color=#800000 
size=2>@"RD.CustomThemes;;;component\themes/customthemes.toon.baml"</FONT><FONT 
size=2>, </FONT><FONT color=#008080 size=2>UriKind</FONT></FONT><FONT 
face="Courier New"><FONT size=2>.Relative)));<BR>&nbsp; }<BR></FONT><FONT 
size=2>}</FONT></FONT></P>
<P>The Uri must use a particular format: 
<EM>AssemblyName</EM>;v<EM>Version</EM>;<EM>PublicKeyToken</EM>;component\<EM>ThemeResourceName</EM></P>
<P>The code below enables to switch from one theme to another without forgetting 
the default one:</P><FONT color=#0000ff size=2>
<P><FONT face="Courier New">protected</FONT></FONT><FONT 
face="Courier New"><FONT size=2> </FONT><FONT color=#0000ff 
size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff 
size=2>void</FONT><FONT size=2> OnKeyDown(</FONT><FONT color=#008080 
size=2>KeyEventArgs</FONT></FONT><FONT face="Courier New"><FONT size=2> 
e)<BR>{<BR>&nbsp; </FONT><FONT color=#0000ff size=2>base</FONT></FONT><FONT 
face="Courier New"><FONT size=2>.OnKeyDown(e);<BR>&nbsp; </FONT><FONT 
color=#0000ff size=2>if</FONT><FONT size=2> (e.Key == </FONT><FONT color=#008080 
size=2>Key</FONT></FONT><FONT face="Courier New"><FONT size=2>.F5)<BR>&nbsp; 
{<BR>&nbsp;&nbsp;&nbsp; ++_themeIndex;<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT 
color=#0000ff size=2>if</FONT><FONT size=2> (_themeIndex &gt; </FONT><FONT 
color=#0000ff size=2>this</FONT></FONT><FONT face="Courier New"><FONT 
size=2>.MyApplication.AvailableThemes.Count - 1)<BR>&nbsp;&nbsp; 
{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _themeIndex = 
-1;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008080 
size=2>Application</FONT><FONT size=2>.Current.Resources = </FONT><FONT 
color=#0000ff size=2>null</FONT></FONT><FONT face="Courier New" 
size=2>;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT 
face="Courier New"><FONT color=#0000ff 
size=2>else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008080 
size=2>Application</FONT><FONT size=2>.Current.Resources = </FONT><FONT 
color=#0000ff size=2>this</FONT></FONT><FONT face="Courier New" 
size=2>.MyApplication.AvailableThemes[_themeIndex];<BR>&nbsp; 
}<BR>}</FONT></P><SPAN><BR>Conclusion</SPAN> 
<HR>

<P>As you was able to see, with WPF, Microsoft introduces a new business for 
windows applications e.g. in the industrial application design process, the UI 
can be externalized and can be in charge by a different team from the 
development. I think that in a near future, we will see companies propose skins 
and themes for many types of application. Furthermore the rioterdeckers are 
integrating these concepts in&nbsp;an&nbsp;evolved UI engine. Stay tuned...</P>
<P><A 
href="http://esnips.com/doc/91634e9d-e09d-4e76-b937-351981bca87f/RD.CustomThemes.Sample.Sources.zip">Download 
the sources</A><BR><A 
href="http://esnips.com/doc/1f50ef1a-a284-4a62-be4d-b3027529133b/RD.CustomThemes.Sample.Binaries.zip">Download 
the binaries</A></P>
<P>(WinFX February CTP)</P>
<DIV class=postfoot>Published Monday, March 06, 2006 7:54 AM by <A 
id=_ctl0____ctl0____ctl1___Entry___AuthorLink 
href="http://blog.rioterdecker.net/user/Profile.aspx?UserID=2104">Chaz</A> 
<BR>Filed Under: <A 
id=_ctl0____ctl0____ctl1___Entry___Tags___Categories__ctl1_Link 
href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1001.aspx" 
rel=tag>WPF</A> </DIV></DIV></DIV>
<H3>Comments </H3>
<DIV id=comments>
<DIV class=comment>
<H4><A id=_ctl0____ctl0____ctl1___Comments___Comments__ctl0_PermaLink 
title=permalink 
href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03/06/100.aspx#155">#</A> 
<SPAN>[WPF] D&amp;#233;velopper un jeux en WPF ?<A name=155></A></SPAN> </H4>
<DIV class=commentsbody>L'id&amp;#233;e peut paraitre surprenante mais c'est 
pourtant bien ce que Chaz , connu du monde WPF ( Windows </DIV>
<DIV class=commentssubhead><SPAN class=commentspan></SPAN>Friday, November 10, 
2006 2:50 AM by <A id=_ctl0____ctl0____ctl1___Comments___Comments__ctl0_NameLink 
title=TrackBack 
href="http://blog.rioterdecker.net/utility/Redirect.aspx?U=http%3a%2f%2fblogs.developpeur.org%2ftom%2farchive%2f2006%2f11%2f10%2fwpf-d-velopper-un-jeux-en-wpf.aspx" 
target=_blank rel=nofollow>Thomas Lebrun</A> </DIV></DIV>
<DIV class=altcomment>
<H4><A id=_ctl0____ctl0____ctl1___Comments___Comments__ctl1_PermaLink 
title=permalink 
href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03/06/100.aspx#216">#</A> 
<SPAN>Themes/generic.xaml &amp;laquo; Martin&amp;#8217;s 10<A 
name=216></A></SPAN> </H4>
<DIV class=commentsbody>PingBack from <A 
href="http://wangmo.wordpress.com/2007/09/27/themesgenericxaml/" target=_new 
rel=nofollow>http://wangmo.wordpress.com/2007/09/27/themesgenericxaml/</A> 
</DIV>
<DIV class=commentssubhead><SPAN class=commentspan></SPAN>Thursday, September 
27, 2007 4:09 PM by <A 
id=_ctl0____ctl0____ctl1___Comments___Comments__ctl1_NameLink title=TrackBack 
href="http://blog.rioterdecker.net/utility/Redirect.aspx?U=http%3a%2f%2fwangmo.wordpress.com%2f2007%2f09%2f27%2fthemesgenericxaml%2f" 
target=_blank rel=nofollow>Themes/generic.xaml « Martin’s 10</A> </DIV></DIV>
<DIV class=comment>
<H4><A id=_ctl0____ctl0____ctl1___Comments___Comments__ctl2_PermaLink 
title=permalink 
href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03/06/100.aspx#217">#</A> 
<SPAN>Make a theme-changable application &amp;laquo; Martin&amp;#8217;s 10<A 
name=217></A></SPAN> </H4>
<DIV class=commentsbody>PingBack from <A 
href="http://wangmo.wordpress.com/2007/09/28/make-a-theme-changable-application/" 
target=_new 
rel=nofollow>http://wangmo.wordpress.com/2007/09/28/make-a-theme-changable-application/</A> 
</DIV>
<DIV class=commentssubhead><SPAN class=commentspan></SPAN>Friday, September 28, 
2007 3:32 PM by <A id=_ctl0____ctl0____ctl1___Comments___Comments__ctl2_NameLink 
title=TrackBack 
href="http://blog.rioterdecker.net/utility/Redirect.aspx?U=http%3a%2f%2fwangmo.wordpress.com%2f2007%2f09%2f28%2fmake-a-theme-changable-application%2f" 
target=_blank rel=nofollow>Make a theme-changable application « Martin’s 10</A> 
</DIV></DIV></ASP:REPEATER></DIV><EM>Anonymous comments are disabled</EM> </DIV>
<DIV id=contentfooter>&nbsp;</DIV></DIV>
<DIV id=footer>
<DIV class=Copyright>rioterdecker - 2006</DIV><A 
href="http://communityserver.org/r.ashx?1" target=_blank><IMG 
alt="Powered by Community Server, by Telligent Systems " 
src="Chaz  Create and apply custom themes_files/EULA.gif" border=0></A> 
</DIV></DIV></DIV>
<SCRIPT language=javascript type=text/javascript>
<!--
function KeyDownHandler_ctl0____ctl0___BlogSideBar1___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('_ctl0:_:_ctl0:_:BlogSideBar1:_:ws:_:SearchButton','')	}
}

//-->
</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03/06/100.aspx"
dc:identifier="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03/06/100.aspx"
dc:title="Create and apply custom themes"
trackback:ping="http://blog.rioterdecker.net/blogs/trackback.aspx?PostID=100" />
</rdf:RDF>
--></FORM></BODY></HTML>
