<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0066)http://blog.rioterdecker.net/blogs/chaz/archive/2006/01/20/91.aspx -->
<HTML><HEAD><TITLE>Chaz : 3D Visual Effect in 2D</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META content=WPF name=keywords>
<META 
content="Introduction &#13;&#10;&#13;&#10;&#13;&#10;Since Avalon&amp;nbsp;is available, I am impressive by the power of the visual effects such as animations and transformations, orchestrated by storyboards. But the integration of 3-D models in our business applications fascinate myself." 
name=description>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blog.rioterdecker.net/blogs/pingback.aspx" rel=pingback><LINK 
media=screen href="Chaz  3D Visual Effect in 2D_files/style.css" type=text/css 
rel=stylesheet><LINK media=print 
href="Chaz  3D Visual Effect in 2D_files/print.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="Chaz  3D Visual Effect in 2D_files/right%20sidebar.css" type=text/css 
rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel="shortcut icon"><LINK title="Chaz (RSS 2.0)" 
href="http://blog.rioterdecker.net/blogs/chaz/rss.aspx" type=application/rss+xml 
rel=alternate><LINK title="Chaz (Atom 1.0)" 
href="http://blog.rioterdecker.net/blogs/chaz/atom.aspx" 
type=application/atom+xml rel=alternate><LINK 
title="3D Visual Effect in 2D Comment RSS (RSS 2.0)" 
href="http://blog.rioterdecker.net/blogs/chaz/commentrss.aspx?PostID=91" 
type=application/rss+xml rel=alternate>
<SCRIPT src="Chaz  3D Visual Effect in 2D_files/global.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<FORM id=__aspnetForm name=__aspnetForm 
action=/blogs/chaz/archive/2006/01/20/91.aspx method=post><INPUT type=hidden 
name=__EVENTTARGET> <INPUT type=hidden name=__EVENTARGUMENT> <INPUT type=hidden 
value=dDwxOTEyODEyMTQ3OztsPF9jdGwwOl86X2N0bDA6XzpCbG9nU2lkZUJhcjE6Xzp3czpfOlNlYXJjaEJveDs+PgUL+f/GgIJK9otucOax//Q380gO 
name=__VIEWSTATE>
<SCRIPT language=javascript type=text/javascript>
<!--
	function __doPostBack(eventTarget, eventArgument) {
		var theform;
		if (window.navigator.appName.toLowerCase().indexOf("microsoft") > -1) {
			theform = document.__aspnetForm;
		}
		else {
			theform = document.forms["__aspnetForm"];
		}
		theform.__EVENTTARGET.value = eventTarget.split("$").join(":");
		theform.__EVENTARGUMENT.value = eventArgument;
		theform.submit();
	}
// -->
</SCRIPT>

<SCRIPT language=javascript type=text/javascript>
var RatingControlAJAX = {

"SaveRating": function(id, rating, clientCallBack) {
	return Ajax_CallBack('CommunityServer.Blogs.Controls.BlogRatePost', id, 'SaveRating', [rating], clientCallBack, false, false, false, true,'/blogs/chaz/archive/2006/01/20/91.aspx?Ajax_CallBack=true');
}

};
</SCRIPT>
 
<DIV id=masthead>
<DIV id=welcome align=right>Welcome to RioterDeckers' HeadQuarter <A 
id=_ctl0____ctl0___duw1_ac1___Login 
href="http://blog.rioterdecker.net/login.aspx?ReturnUrl=/blogs/chaz/archive/2006/01/20/91.aspx">Sign 
in</A> | <A id=_ctl0____ctl0___duw1_ac1___Register 
href="http://blog.rioterdecker.net/user/CreateUser.aspx?ReturnUrl=/blogs/chaz/archive/2006/01/20/91.aspx">Join</A> 
| <A id=_ctl0____ctl0___duw1_Faq1 
href="http://blog.rioterdecker.net/languages/en-US/docs/faq.aspx">Help</A> 
</DIV></DIV>
<DIV id=wrapper>
<DIV id=container>
<DIV id=header>
<DIV id=title>
<H1><A class=headermaintitle id=_ctl0____ctl0___BlogTitleHeader1___BlogTitle 
href="http://blog.rioterdecker.net/blogs/chaz/default.aspx">Chaz</A></H1>
<P id=tagline>WPF underground</P></DIV></DIV>
<DIV id=contentwrapper>
<DIV id=sidebar-a>
<DIV id=WeblogLinks>
<H3>This Blog</H3>
<UL>
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/about.aspx">About</A> 
  </LI></UL></DIV>
<H3>Calendar</H3>
<DIV id=Cal align=center>
<UL>
  <LI>
  <TABLE class=Calendar id=PostCalendar cellSpacing=0 cellPadding=2 border=0>
    <TBODY>
    <TR>
      <TD colSpan=7>
        <TABLE class=CalendarTitle cellSpacing=0 border=0>
          <TBODY>
          <TR>
            <TD class=CalendarNextPrev align=middle><A style="COLOR: black" 
              href="javascript:__doPostBack('_ctl0$_$_ctl0$_$BlogSideBar1$_$Cal$_$PostCalendar','V2161')">Dec</A></TD>
            <TD align=middle>January 2006</TD>
            <TD class=CalendarNextPrev align=right><A style="COLOR: black" 
              href="javascript:__doPostBack('_ctl0$_$_ctl0$_$BlogSideBar1$_$Cal$_$PostCalendar','V2223')">Feb</A></TD></TR></TBODY></TABLE></TD></TR>
    <TR>
      <TD class=CalendarDayHeader align=middle>S</TD>
      <TD class=CalendarDayHeader align=middle>M</TD>
      <TD class=CalendarDayHeader align=middle>T</TD>
      <TD class=CalendarDayHeader align=middle>W</TD>
      <TD class=CalendarDayHeader align=middle>T</TD>
      <TD class=CalendarDayHeader align=middle>F</TD>
      <TD class=CalendarDayHeader align=middle>S</TD></TR>
    <TR>
      <TD class=CalendarOtherMonth align=middle>25</TD>
      <TD class=CalendarOtherMonth align=middle>26</TD>
      <TD class=CalendarOtherMonth align=middle>27</TD>
      <TD class=CalendarOtherMonth align=middle>28</TD>
      <TD class=CalendarOtherMonth align=middle>29</TD>
      <TD class=CalendarOtherMonth align=middle>30</TD>
      <TD class=CalendarOtherMonth align=middle>31</TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>1</TD>
      <TD align=middle>2</TD>
      <TD align=middle>3</TD>
      <TD align=middle>4</TD>
      <TD align=middle>5</TD>
      <TD align=middle>6</TD>
      <TD class=CalendarWeekend align=middle>7</TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>8</TD>
      <TD align=middle>9</TD>
      <TD align=middle>10</TD>
      <TD align=middle>11</TD>
      <TD align=middle>12</TD>
      <TD align=middle>13</TD>
      <TD class=CalendarWeekend align=middle><A title="1 Post" 
        href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/1/14.aspx">14</A></TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>15</TD>
      <TD align=middle>16</TD>
      <TD align=middle>17</TD>
      <TD align=middle>18</TD>
      <TD align=middle>19</TD>
      <TD align=middle>20</TD>
      <TD class=CalendarWeekend align=middle><A title="1 Post" 
        href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/1/21.aspx">21</A></TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>22</TD>
      <TD align=middle><A title="1 Post" 
        href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/1/23.aspx">23</A></TD>
      <TD align=middle>24</TD>
      <TD align=middle>25</TD>
      <TD align=middle>26</TD>
      <TD align=middle>27</TD>
      <TD class=CalendarWeekend align=middle>28</TD></TR>
    <TR>
      <TD class=CalendarWeekend align=middle>29</TD>
      <TD align=middle>30</TD>
      <TD align=middle>31</TD>
      <TD class=CalendarOtherMonth align=middle>1</TD>
      <TD class=CalendarOtherMonth align=middle>2</TD>
      <TD class=CalendarOtherMonth align=middle>3</TD>
      <TD class=CalendarOtherMonth 
align=middle>4</TD></TR></TBODY></TABLE></LI></UL></DIV>
<H3>Search</H3>
<DIV id=Search>
<UL>
  <LI><INPUT class=searchBox id=_ctl0____ctl0___BlogSideBar1___ws___SearchBox 
  onkeydown=KeyDownHandler_ctl0____ctl0___BlogSideBar1___ws___SearchButton(event); 
  name=_ctl0:_:_ctl0:_:BlogSideBar1:_:ws:_:SearchBox> <A 
  id=_ctl0____ctl0___BlogSideBar1___ws___SearchButton 
  href="javascript:__doPostBack('_ctl0$_$_ctl0$_$BlogSideBar1$_$ws$_$SearchButton','')">Go</A> 
  </LI></UL></DIV>
<DIV id=Subscriptions>
<H3>Syndication</H3>
<UL>
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/rss.aspx">RSS 2.0</A> 
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/atom.aspx">Atom 1.0</A> 
  </LI></UL></DIV>
<H3>Archives</H3>
<UL>
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2007/04.aspx">April 2007 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/11.aspx">November 
  2006 (1)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/10.aspx">October 
  2006 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/06.aspx">June 2006 
  (1)</A> 
  <LI><A href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/05.aspx">May 
  2006 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/04.aspx">April 2006 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/03.aspx">March 2006 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/02.aspx">February 
  2006 (3)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2006/01.aspx">January 
  2006 (3)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2005/11.aspx">November 
  2005 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/2005/10.aspx">October 
  2005 (1)</A> </LI></UL>
<H3>Navigation</H3>
<DIV id=headertab>
<UL>
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl0_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl0_MenuItem 
  href="http://blog.rioterdecker.net/">Home</A> 
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl1_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl1_MenuItem 
  href="http://blog.rioterdecker.net/blogs/default.aspx">Blogs</A> 
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl2_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl2_MenuItem 
  href="http://blog.rioterdecker.net/photos/default.aspx">Photos</A> 
  <LI id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl3_listItem><A 
  id=_ctl0____ctl0___BlogSideBar1____ctl2___Menu__ctl3_MenuItem 
  href="http://blog.rioterdecker.net/files/default.aspx">Files</A> 
</LI></UL></DIV>
<H3>Post Categories</H3>
<UL>
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1000.aspx">.Net 
  Framework 2.0 (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1033.aspx">SilverLight 
  (2)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1002.aspx">Windows 
  Vista (4)</A> 
  <LI><A 
  href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1001.aspx">WPF 
  (14)</A> </LI></UL>
<H3>Useful links</H3>
<UL>
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl1_Link 
  href="http://blogs.msdn.com/tims/archive/2005/06/10/427565.aspx">WPF 
  Bloggers</A> 
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl2_Link 
  href="http://spaces.msn.com/rrelyea/">Rob Relyea's blog</A> 
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl3_Link 
  href="http://weblogs.asp.net/bleroy/">One of my buddies' blog</A> 
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl0_Links__ctl4_Link 
  href="http://www.netfxfactory.org/">The NetFxFactory community</A> </LI></UL>
<H3>The Massai project</H3>
<UL>
  <LI><A 
  id=_ctl0____ctl0___BlogSideBar1___lcl___Categories__ctl1_Links__ctl1_Link 
  href="http://blog.rioterdecker.net/photos/chaz_blog_pictures/category1031.aspx">Screenshots</A> 
  </LI></UL></DIV>
<DIV id=content>
<DIV class=post>
<DIV class=postview>
<H2>3D Visual Effect in 2D</H2><SPAN>Introduction</SPAN> 
<HR>

<P>Since Avalon&nbsp;is available, I am impressive by the power of the visual 
effects such as animations and transformations, orchestrated by storyboards. But 
the integration of 3-D models in our business applications fascinate myself. 
Until now it's often a privilege of the video games, the 3-D effects make UI 
more rich and provide a user experience completely inovative.<BR>However 3-D 
modelisations, animations, such as rotation transformations for example, 
need&nbsp;more specific skills. I also noticed a clear increase in the 
ressources when I apply a visual element on a 3-D model. I think that this 
powerful feature cannot be used to design real and rich applications with this 
actual version (I'm coding with the CTP Nov. 2005). Did you see the Healthcare 
application ? It's awesome! If not, you'd better go to Channel9 right now!</P>
<P>I also noticed that with a few of tricks, it's possible to design controls 
presenting items with a 3-D appearance by leaning on optical effects.<BR>To 
illustrate this concept, I will consider items which turn&nbsp;following the 
path of an ellipse. The item in the first plan is the current selected item.</P>
<P><IMG src="Chaz  3D Visual Effect in 2D_files/Figure-1.png" border=0></P>
<P>The illusion of 3-D depth is realized by the translation of the items on the 
ellipse and by the scale transformation of the items during the animation.<BR>I 
enjoyed developing a control where elements are ellipse objects with a different 
color which move according to the path of an ellipse (not visible in the 
case).</P>
<P><IMG src="Chaz  3D Visual Effect in 2D_files/Figure-2.png" border=0></P>
<P>Let's see the code.</P>
<H2><SPAN>Defining items</SPAN> 
<HR>
</H2>
<P>First I define each element, placed on a canvas. In order to simplify 
the&nbsp;code, I decided to use simple Ellipse object to represent items on the 
path.</P>
<P><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>&lt;</FONT><FONT 
color=#a52a2a>Canvas</FONT> <FONT color=#ff0000>Name</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>_itemsContainer</FONT>"<FONT 
color=#0000ff>&gt;</FONT><BR><FONT color=#0000ff>&nbsp; &lt;</FONT><FONT 
color=#a52a2a>Ellipse</FONT> <FONT color=#ff0000>Name</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>_item1</FONT>" <FONT 
color=#ff0000>Width</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>10</FONT>" <FONT color=#ff0000>Height</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>10</FONT>" <FONT 
color=#ff0000>Fill</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>Yellow</FONT>" <FONT color=#0000ff>/&gt;</FONT><BR>&nbsp; 
...<BR><FONT color=#0000ff>&lt;/</FONT><FONT color=#a52a2a>Canvas</FONT><FONT 
color=#0000ff>&gt;</FONT></FONT></FONT></P>
<P>You can already notice that I don't set the initial absolute position of each 
element because it needs to be&nbsp;determined according to the number of 
elements with an equal distance between them.</P>
<H2><SPAN>Defining the animation using the path of the ellipse</SPAN> 
<HR>
</H2>
<P>Each element is moved by following the path of the ellipse and is animated by 
a storyboard. WPF provides the timeline <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref34/html/T_System_Windows_Media_Animation_DoubleAnimationUsingPath.asp">DoubleAnimationUsingPath</A> 
that enables to set an object of <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref34/html/T_System_Windows_Media_PathGeometry.asp">PathGeometry</A> 
type. I set the FillBehavior property to HoldEnd in order to be able to control 
the execution of the storyboard, as descibes further.</P>
<P><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>&lt;</FONT><FONT 
color=#a52a2a>Storyboard</FONT></FONT></FONT><FONT face="Courier New"><FONT 
size=2><FONT color=#0000ff>&gt;<BR></FONT>&nbsp; <FONT 
color=#0000ff>&lt;</FONT><FONT 
color=#a52a2a>ParalleleTimeline</FONT></FONT></FONT><FONT 
face="Courier New"><FONT size=2><FONT 
color=#0000ff>&gt;<BR></FONT>&nbsp;&nbsp;&nbsp; <FONT 
color=#0000ff>&lt;</FONT><FONT color=#a52a2a>DoubleAnimationUsingPath</FONT> 
<FONT color=#ff0000>Duration</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>0:0:4</FONT>" <FONT color=#ff0000>FillBehavior</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>HoldEnd</FONT>" <FONT 
color=#ff0000>RepeatBehavior</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>Forever</FONT>" <FONT 
color=#ff0000>Storyboard.TargetProperty</FONT><FONT color=#0000ff>=</FONT><FONT 
color=#000000>"</FONT><FONT color=#0000ff>(Canvas.Left)</FONT>" <FONT 
color=#ff0000>Source</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>X</FONT>" <FONT color=#0000ff>/&gt;</FONT><BR>&nbsp;&nbsp;&nbsp; 
<FONT color=#0000ff>&lt;</FONT><FONT 
color=#a52a2a>DoubleAnimationUsingPath</FONT> <FONT 
color=#ff0000>Duration</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>0:0:4</FONT>" <FONT color=#ff0000>FillBehavior</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>HoldEnd</FONT>" <FONT 
color=#ff0000>RepeatBehavior</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>Forever</FONT>" <FONT 
color=#ff0000>Storyboard.TargetProperty</FONT><FONT color=#0000ff>=</FONT><FONT 
color=#000000>"</FONT><FONT color=#0000ff>(Canvas.Top)</FONT>" <FONT 
color=#ff0000>Source</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>Y</FONT>" <FONT color=#0000ff>/&gt;</FONT><BR>&nbsp; <FONT 
color=#0000ff>&lt;/</FONT><FONT color=#a52a2a>ParalleleTimeline</FONT><FONT 
color=#0000ff>&gt;</FONT><BR><FONT color=#0000ff>&lt;/</FONT><FONT 
color=#a52a2a>Storyboard</FONT><FONT color=#0000ff>&gt;</FONT></FONT></FONT></P>
<P><FONT color=#000000>The first difficulty is that DoubleAnimationUsingPath 
provides the PathGeometry DependencyProperty which can be set with a SVG 
instruction corresponding to the attended shape. Unfortunatly, my memories of 
math are so far and&nbsp;I don't remember&nbsp;the formula to create an ellipse 
:)! The only solution consists in setting data to create an ellipse either using 
two beziers segments&nbsp;or two arcs (i.e. PathGeometry="M0,0 C...". 
Furthermore, I posted another suggestion on the Microsoft Product Feedback 
website,&nbsp;<A 
href="http://lab.msdn.microsoft.com/productfeedback/viewfeedback.aspx?feedbackid=d04e2f7d-2fa2-47e3-a155-5fc424c26031">just 
right here</A>.<BR>Another solution consists in creating an <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref34/html/T_System_Windows_Media_EllipseGeometry.asp">EllipseGeometry</A> 
object (for example in a ResourceDictionary) and applying it to the Timeline by 
code.</FONT></P>
<P><FONT face="Courier New"><FONT size=2>[Xaml]<BR><FONT 
color=#0000ff>&lt;</FONT><FONT color=#a52a2a>EllipseGeometry</FONT> <FONT 
color=#ff0000>x:Key</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>Ellipse_Template</FONT>" <FONT color=#ff0000>RadiusX</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>125</FONT>" <FONT 
color=#ff0000>RadiusY</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>20</FONT>" <FONT color=#0000ff>/&gt;</FONT></FONT></FONT></P>
<P><FONT face="Courier New" size=2>[C#]<BR><FONT 
color=teal>DoubleAnimationUsingPath</FONT> __animX = (<FONT 
color=teal>DoubleAnimationUsingPath</FONT>)(__storyboard.Children[0] <FONT 
color=#0000ff>as</FONT> <FONT 
color=teal>ParallelTimeline</FONT>).Children[0];<BR><FONT 
color=teal>DoubleAnimationUsingPath</FONT> __animY = (<FONT 
color=teal>DoubleAnimationUsingPath</FONT>)(__storyboard.Children[0] <FONT 
color=#0000ff>as</FONT> <FONT 
color=teal>ParallelTimeline</FONT>).Children[1];<BR>__animX.PathGeometry = <FONT 
color=#0000ff>new</FONT> <FONT 
color=teal>PathGeometry</FONT>();<BR>__animY.PathGeometry = <FONT 
color=#0000ff>new</FONT> <FONT color=teal>PathGeometry</FONT>();</FONT></P>
<P><FONT face="Courier New" size=2>__animX.PathGeometry.AddGeometry((<FONT 
color=teal>EllipseGeometry</FONT>)<FONT 
color=#0000ff>this</FONT>.Resources[<FONT 
color=#a52a2a>"Ellipse_Template"</FONT>]);<BR>__animY.PathGeometry.AddGeometry((<FONT 
color=teal>EllipseGeometry</FONT>)<FONT 
color=#0000ff>this</FONT>.Resources[<FONT 
color=#a52a2a>"Ellipse_Template"</FONT>]);</FONT></P>
<P>Bonus: it's easy to add a <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref34/html/T_System_Windows_Media_RotateTransform.asp">RotateTransform</A> 
to the ellipse rendering. It's more fun...</P>
<P><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>&lt;</FONT><FONT 
color=#a52a2a>EllipseGeometry</FONT> <FONT color=#ff0000>x:Key</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>Ellipse_Template</FONT>" <FONT 
color=#ff0000>RadiusX</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>125</FONT>" <FONT color=#ff0000>RadiusY</FONT><FONT 
color=#0000ff>=</FONT>"<FONT color=#0000ff>20</FONT>"<FONT 
color=#0000ff>&gt;</FONT><BR>&nbsp; <FONT color=#0000ff>&lt;</FONT><FONT 
color=#a52a2a>EllipseGeometry.Transform</FONT><FONT 
color=#0000ff>&gt;</FONT><BR>&nbsp;&nbsp;&nbsp; <FONT 
color=#0000ff>&lt;</FONT><FONT color=#a52a2a>RotateTransform</FONT> <FONT 
color=#ff0000>Angle</FONT><FONT color=#0000ff>=</FONT>"<FONT 
color=#0000ff>25</FONT>" <FONT color=#0000ff>/&gt;</FONT><BR>&nbsp; <FONT 
color=#0000ff>&lt;/</FONT><FONT 
color=#a52a2a>EllipseGeometry.Transform</FONT><FONT 
color=#0000ff>&gt;</FONT><BR><FONT color=#0000ff>&lt;/</FONT><FONT 
color=#a52a2a>EllipseGeometry</FONT><FONT 
color=#0000ff>&gt;</FONT></FONT></FONT></P>
<P><IMG src="Chaz  3D Visual Effect in 2D_files/Figure-3.png" border=0></P>
<P><SPAN>Defining the scale transformation</SPAN> <BR>
<HR>

<P></P>
<P>The rendering and so the scale of the elements can be easily transformed by 
using the <A 
href="http://windowssdk.msdn.microsoft.com/library/en-us/cpref34/html/T_System_Windows_Media_Animation_DoubleAnimationUsingKeyFrames.asp">DoubleAnimationUsingKeyFrames</A> 
timeline object. Indeed, it enables to modify the value of a DependencyProperty 
by intercepting a position of time during the animation. Notice that the more 
number of positions will be important, the more transformation will be 
fluid.</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>Storyboard</FONT><FONT color=#0000ff 
size=2>&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>...<BR>&nbsp; 
</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&lt;</FONT></FONT><FONT face="Courier New" color=#800000 
size=2>ParalleleTimeline</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT 
face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>DoubleAnimationUsingKeyFrames</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Duration</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>0:0:4</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Storyboard.TargetProperty</FONT><FONT 
color=#0000ff size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT 
color=#0000ff size=2>Width</FONT><FONT color=#000000 size=2>"</FONT><FONT 
color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>RepeatBehavior</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
color=#000000 size=2>"</FONT><FONT color=#0000ff size=2>Forever</FONT><FONT 
color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT 
face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>6.25%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>11.25</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>12.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>12.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>25%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>20</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>37.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>12.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>43.75%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>11.25</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>50%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>10</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>56.25%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>8.75</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>62.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>7.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>75%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>87.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>7.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>93.75%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>8.75</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>100%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>10</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT 
face="Courier New">&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 
size=2>DoubleAnimationUsingKeyFrames</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp; </FONT><FONT 
face="Courier New">&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 
size=2>ParalleleTimeline</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp; </FONT><FONT 
face="Courier New">&lt;</FONT></FONT><FONT face="Courier New" color=#800000 
size=2>ParalleleTimeline</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT 
face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>DoubleAnimationUsingKeyFrames</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Duration</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>0:0:4</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Storyboard.TargetProperty</FONT><FONT 
color=#0000ff size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT 
color=#0000ff size=2>Height</FONT><FONT color=#000000 size=2>"</FONT><FONT 
color=#0000ff size=2> </FONT><FONT color=#ff0000 
size=2>RepeatBehavior</FONT><FONT color=#0000ff size=2>=</FONT><FONT 
color=#000000 size=2>"</FONT><FONT color=#0000ff size=2>Forever</FONT><FONT 
color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT 
face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>6.25%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>11.25</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>12.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>12.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>25%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>20</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>37.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>12.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>43.75%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>11.25</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>50%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>10</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>56.25%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>8.75</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>62.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>7.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>75%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>87.5%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>7.5</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>93.75%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2> </FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>8.75</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>LinearDoubleKeyFrame</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>KeyTime</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>100%</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff size=2> 
</FONT><FONT color=#ff0000 size=2>Value</FONT><FONT color=#0000ff 
size=2>=</FONT><FONT color=#000000 size=2>"</FONT><FONT color=#0000ff 
size=2>10</FONT><FONT color=#000000 size=2>"</FONT></FONT><FONT color=#0000ff 
size=2><FONT face="Courier New"> /&gt;<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT 
face="Courier New">&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 
size=2>DoubleAnimationUsingKeyFrames</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR>&nbsp; </FONT><FONT 
face="Courier New">&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 
size=2>ParalleleTimeline</FONT><FONT color=#0000ff size=2><FONT 
face="Courier New">&gt;<BR></FONT><FONT 
face="Courier New">&lt;/</FONT></FONT><FONT face="Courier New"><FONT 
color=#800000 size=2>Storyboard</FONT><FONT color=#0000ff 
size=2>&gt;</FONT></FONT></P></FONT>
<P>Another solution consists in using the RenderTransform.ScaleTransform 
property, however in this simple case, transform the size of elements uses less 
ressources.</P>
<H2><SPAN>Defining the initial position around the ellipse</SPAN> 
<HR>
</H2>
<P>Now it remains the position&nbsp;of each element to be defined&nbsp;along the 
path of the ellipse. I simply call the GetPointAtFractionLength method of the 
PathGeometry object. <STRONG>Thanks to Mark Grinols&nbsp;for this 
information</STRONG>. As you can see below, this method returns two Point 
objects as output parameter. The first Point will provide the x and y 
coordinates of the element.</P><FONT color=#0000ff size=2>
<P><FONT face="Courier New" color=#000000>[Metadata]<BR><FONT 
color=#0000ff>public</FONT> <FONT color=#0000ff>void</FONT> 
GetPointAtFractionLength (<BR>&nbsp;<FONT color=#0000ff>double</FONT> 
progress,<BR>&nbsp;<FONT color=#0000ff>out</FONT> <FONT color=#008080>Point 
</FONT>point,<BR>&nbsp;<FONT color=#0000ff>out <FONT 
color=#008080>Point</FONT></FONT>&nbsp;tangent<BR>)</FONT></P>
<P><FONT face="Courier New" color=#000000>[C#]<BR><FONT 
color=#0000ff>double</FONT> __ratio = 1.0 / 
_itemsContainer.Children.Count;</FONT></P><FONT face="Courier New" 
color=#000000><FONT color=#008080>
<P>Point </FONT>__point1 = <FONT color=#0000ff>new </FONT><FONT 
color=#008080>Point</FONT>();<BR><FONT color=#008080>Point </FONT>__point2 = 
<FONT color=#0000ff>new</FONT> <FONT color=#008080>Point</FONT>();<BR><FONT 
color=#008080>DoubleAnimationUsingPath </FONT>__timeline = 
(__storyboard.Children[0] <FONT color=#0000ff>as</FONT> <FONT 
color=#008080>ParallelTimeline</FONT>).Children[0] <FONT color=#0000ff>as</FONT> 
<FONT 
color=#008080>DoubleAnimationUsingPath</FONT>;<BR>__timeline.PathGeometry.GetPointAtFractionLength(__ratio, 
<FONT color=#0000ff>out</FONT> __point1, <FONT color=#0000ff>out</FONT> 
__point2);</FONT></P><FONT size=+0><FONT face="Courier New" color=#000000><FONT 
color=#008080>
<P><FONT size=2>Canvas</FONT></FONT><FONT size=2>.SetLeft(_item, 
__point1.X);<BR><FONT color=#008080>Canvas</FONT>.<FONT 
color=#000000>SetTop(_item, __point1.Y);</FONT></FONT></P></FONT></FONT></FONT>
<H2><SPAN>Refreshing the animation</SPAN> 
<HR>
</H2>
<P>To finish, I add the necessary code to start the animations when any item is 
clicked.<BR>So the position of each element must be refreshed 
but&nbsp;don't&nbsp;forget that the animations must be paused when an item 
become the current, and so the selected element. To control elements during the 
animation, I just need to intercept the CurrentTimeInvalidated event of the 
storyboards. To easily retrieve items and their associated storyboard, I've 
created an AnimElement class that contains the definition of each item (this 
class will be replaced by an embedded Definiton class).</P><FONT 
face="Courier New" color=#000000><FONT size=+0><FONT color=#0000ff size=2><FONT 
size=2>
<P><FONT color=#000000>__storyboard.CurrentTimeInvalidated +=</FONT> <FONT 
color=#0000ff>delegate</FONT><FONT color=#000000>(</FONT><FONT 
color=#0000ff>object</FONT> <FONT color=#000000>sender</FONT><FONT 
color=#000000>, </FONT><FONT color=#008080 size=2>EventArgs </FONT><FONT 
color=#000000>e)</FONT><BR><FONT color=#000000>{</FONT><BR>&nbsp; </FONT><FONT 
color=#0000ff size=2>if</FONT><FONT size=2> <FONT color=#000000>(_selectedItem 
==</FONT> </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2><FONT 
color=#000000>)</FONT><BR>&nbsp; <FONT 
color=#000000>{</FONT><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008080 
size=2>AnimElement</FONT><FONT size=2> <FONT color=#000000>__element = 
_transforms[((sender</FONT> </FONT><FONT color=#0000ff size=2>as</FONT><FONT 
size=2> </FONT><FONT color=#008080 size=2>ClockGroup</FONT><FONT size=2><FONT 
color=#000000>).Timeline</FONT> </FONT><FONT color=#0000ff size=2>as</FONT><FONT 
size=2> </FONT><FONT color=#008080 size=2>Storyboard</FONT><FONT size=2><FONT 
color=#000000>)];</FONT><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff 
size=2>if</FONT><FONT size=2> <FONT color=#000000>(_selectedIndex != 
__element.Index &amp;&amp;</FONT> </FONT><FONT color=#008080 
size=2>Math</FONT><FONT size=2><FONT 
color=#000000>.Round(__element.ObjectContext.Width) == 20 &amp;&amp;</FONT> 
</FONT><FONT color=#008080 size=2>Math</FONT><FONT size=2><FONT 
color=#000000>.Round(__element.ObjectContext.Height) == 
20)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _selectedIndex = 
__element.Index;<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT color=#008080 size=2>Dictionary</FONT><FONT color=#000000 
size=2>&lt;</FONT><FONT color=#008080 size=2>Storyboard</FONT><FONT size=2><FONT 
color=#000000>,</FONT> </FONT><FONT color=#008080 size=2>AnimElement</FONT><FONT 
color=#000000><FONT size=2>&gt;.</FONT><FONT size=2>ValueCollection</FONT><FONT 
size=2>.</FONT><FONT size=2>Enumerator</FONT></FONT><FONT size=2><FONT 
color=#000000> __enumerator = 
_transforms.Values.GetEnumerator();</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT color=#0000ff size=2>while</FONT><FONT size=2> <FONT 
color=#000000>(__enumerator.MoveNext())</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<FONT 
color=#000000>__enumerator.Current.Storyboard.Pause(__enumerator.Current.ObjectContext);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
}<BR>&nbsp;&nbsp;&nbsp; }<BR></FONT>&nbsp;&nbsp;&nbsp; </FONT><FONT 
color=#0000ff size=2>else</FONT><FONT size=2> </FONT><FONT color=#0000ff 
size=2>if</FONT><FONT size=2> <FONT color=#000000>(</FONT></FONT><FONT 
color=#008080 size=2>Math</FONT><FONT size=2><FONT 
color=#000000>.Round(_selectedItem.Width) == 20 &amp;&amp;</FONT> </FONT><FONT 
color=#008080 size=2>Math</FONT><FONT size=2><FONT 
color=#000000>.Round(_selectedItem.Height) == 20)</FONT><BR>&nbsp;&nbsp;&nbsp; 
<FONT color=#000000>{<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT 
color=#008080 size=2>Dictionary</FONT><FONT color=#000000 
size=2>&lt;</FONT><FONT color=#008080 size=2>Storyboard</FONT><FONT size=2><FONT 
color=#000000>,</FONT> </FONT><FONT color=#008080 size=2>AnimElement</FONT><FONT 
color=#000000><FONT size=2>&gt;.</FONT><FONT size=2>ValueCollection</FONT><FONT 
size=2>.</FONT><FONT size=2>Enumerator</FONT></FONT><FONT size=2><FONT 
color=#000000> __enumerator = 
_transforms.Values.GetEnumerator();</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</FONT><FONT color=#0000ff size=2>while</FONT><FONT size=2> <FONT 
color=#000000>(__enumerator.MoveNext())<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<FONT 
color=#000000>__enumerator.Current.Storyboard.Pause(__enumerator.Current.ObjectContext);<BR></FONT>&nbsp;&nbsp;&nbsp; 
<FONT color=#000000>}<BR>&nbsp; </FONT></FONT><FONT color=#000000 
size=2>}<BR>};</FONT></P></FONT></FONT></FONT>
<P>I would like to warn you that you can see an unattended visual effect during 
the animation. Indeed, it would seem that when an element is moving along the 
path and is arriving on one extremity, the animation is speeding up. However, 
the elements are placed according to an equal distance.<BR>In a next post, I 
will apply these principles to create a reusable and customizable control.</P>
<P><A 
href="http://esnips.com/doc/68dfcf32-e868-4838-a933-80bf00ea7bf4/RD.EllipseGeometrySample.zip">Download 
the source code</A> (WinFX CTP Nov. 2005)</P>
<DIV class=postfoot>Published Saturday, January 21, 2006 2:57 PM by <A 
id=_ctl0____ctl0____ctl1___Entry___AuthorLink 
href="http://blog.rioterdecker.net/user/Profile.aspx?UserID=2104">Chaz</A> 
<BR>Filed Under: <A 
id=_ctl0____ctl0____ctl1___Entry___Tags___Categories__ctl1_Link 
href="http://blog.rioterdecker.net/blogs/chaz/archive/category/1001.aspx" 
rel=tag>WPF</A> </DIV></DIV></DIV>
<H3>Comments </H3>
<DIV id=comments>
<DIV class=comment>No Comments </DIV></ASP:REPEATER></DIV><EM>Anonymous comments 
are disabled</EM> </DIV>
<DIV id=contentfooter>&nbsp;</DIV></DIV>
<DIV id=footer>
<DIV class=Copyright>rioterdecker - 2006</DIV><A 
href="http://communityserver.org/r.ashx?1" target=_blank><IMG 
alt="Powered by Community Server, by Telligent Systems " 
src="Chaz  3D Visual Effect in 2D_files/EULA.gif" border=0></A> 
</DIV></DIV></DIV>
<SCRIPT language=javascript type=text/javascript>
<!--
function KeyDownHandler_ctl0____ctl0___BlogSideBar1___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('_ctl0:_:_ctl0:_:BlogSideBar1:_:ws:_:SearchButton','')	}
}

//-->
</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blog.rioterdecker.net/blogs/chaz/archive/2006/01/21/91.aspx"
dc:identifier="http://blog.rioterdecker.net/blogs/chaz/archive/2006/01/21/91.aspx"
dc:title="3D Visual Effect in 2D"
trackback:ping="http://blog.rioterdecker.net/blogs/trackback.aspx?PostID=91" />
</rdf:RDF>
--></FORM></BODY></HTML>
