<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0053)http://blogs.msdn.com/expression/articles/525441.aspx -->
<HTML lang=en xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>Expression Blend and Design : ImageButtons</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Home &amp;gt; Samples and Tutorials Gallery - Expression Blend &amp;gt; ImageButtons: Customizing a WPF control type Download the sample project files for the RC build of Expression Blend ImageButtons.zip ImageButtons: Customizing a WPF Control Type Basing your" 
name=description>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blogs.msdn.com/expression/pingback.aspx" rel=pingback><LINK 
media=screen href="Expression Blend and Design  ImageButtons_files/style.css" 
type=text/css rel=stylesheet><LINK media=print 
href="/Themes/Blogs/poisonivy/style/print.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="Expression Blend and Design  ImageButtons_files/customcss.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel="shortcut icon"><LINK title="Expression Blend and Design (RSS 2.0)" 
href="http://blogs.msdn.com/expression/rss.xml" type=application/rss+xml 
rel=alternate><LINK title="Expression Blend and Design (Atom 1.0)" 
href="http://blogs.msdn.com/expression/atom.xml" type=application/atom+xml 
rel=alternate><LINK title="ImageButtons Comment RSS (RSS 2.0)" 
href="http://blogs.msdn.com/expression/commentrss.aspx?PostID=525441" 
type=application/rss+xml rel=alternate>
<SCRIPT src="Expression Blend and Design  ImageButtons_files/global.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<FORM id=aspnetForm name=aspnetForm 
onsubmit="javascript:return WebForm_OnSubmit();" 
action=/expression/articles/525441.aspx method=post>
<DIV><INPUT id=__EVENTTARGET type=hidden name=__EVENTTARGET> <INPUT 
id=__EVENTARGUMENT type=hidden name=__EVENTARGUMENT> <INPUT id=__VIEWSTATE 
type=hidden 
value=/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgIFI2N0bDAwJF8kY3RsMDAkXyRidCRfJHdzJF8kU2VhcmNoQm94BSpjdGwwMCRfJGN0bDAwJF8kY3RsMDEkXyRmb3JtJF8kY2hrUmVtZW1iZXKJzx8ahfovNM/xd3pkqTZJHbbj0A== 
name=__VIEWSTATE> </DIV>
<SCRIPT type=text/javascript>
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</SCRIPT>

<SCRIPT src="Expression Blend and Design  ImageButtons_files/WebResource.axd" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript 
src="Expression Blend and Design  ImageButtons_files/Telligent_Modal.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript type=text/javascript>
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</SCRIPT>

<SCRIPT 
src="C:\Code\Example\WPF Xaml Expression\ImageButtons\Expression Blend and Design  ImageButtons_files\WebResource(1).axd" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</SCRIPT>

<DIV id=masthead>
<DIV id=welcome align=right>Welcome to MSDN Blogs <A 
id=ctl00___ctl00___duw1_ac1___Login 
href="http://blogs.msdn.com/login.aspx?ReturnUrl=%2fexpression%2farticles%2f525441.aspx">Sign 
in</A> | <A id=ctl00___ctl00___duw1_ac1___Register 
href="http://blogs.msdn.com/user/CreateUser.aspx?ReturnUrl=/expression/articles/525441.aspx">Join</A> 
| <A id=ctl00___ctl00___duw1_Faq1 
href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</A> </DIV></DIV>
<DIV id=wrapper>
<DIV id=container>
<DIV id=header>
<DIV id=title>
<DIV id=SearchSideBar>
<DIV id=search><INPUT class=searchBox id=ctl00___ctl00___bt___ws___SearchBox 
onkeydown=KeyDownHandlerctl00___ctl00___bt___ws___SearchButton(event); 
name=ctl00$_$ctl00$_$bt$_$ws$_$SearchBox> <A 
id=ctl00___ctl00___bt___ws___SearchButton 
href="javascript:__doPostBack('ctl00$_$ctl00$_$bt$_$ws$_$SearchButton','')">Search</A> 
</DIV></DIV>
<H1><A class=headermaintitle id=ctl00___ctl00___bt___BlogTitle 
href="http://blogs.msdn.com/expression/default.aspx">Expression Blend and 
Design</A></H1>
<P id=tagline>The team blog of the Microsoft Expression Blend and Design 
products.</P></DIV>
<DIV id=nav>
<DIV id=SubscriptionsSideBar>
<DIV id=subscriptions>
<UL>
  <LI><A id=ctl00___ctl00___bt___s___rss 
  href="http://blogs.msdn.com/expression/rss.xml">RSS 2.0</A> 
  <LI><A id=ctl00___ctl00___bt___s___atom 
  href="http://blogs.msdn.com/expression/atom.xml">Atom 1.0</A> 
</LI></UL></DIV></DIV>
<UL>
  <LI><A id=ctl00___ctl00___bt___home 
  href="http://blogs.msdn.com/expression/default.aspx">Home</A> 
</LI></UL></DIV></DIV>
<DIV id=contentmargin></DIV>
<DIV id=contentwrapper>
<DIV id=sidebar-a>
<DIV id=TasksSideBar></DIV>
<DIV id=TagSideBar>
<H3>Tags</H3>
<UL>
  <UL class=SidebarTagCloud>
    <LI class=Tag2><A 
    href="http://blogs.msdn.com/expression/archive/tags/Designer+Tools/default.aspx" 
    rel=tag>Designer Tools</A> 
    <LI class=Tag2><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression/default.aspx" 
    rel=tag>Expression</A> 
    <LI class=Tag3><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression+Blend/default.aspx" 
    rel=tag>Expression Blend</A> 
    <LI class=Tag4><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression+Design/default.aspx" 
    rel=tag>Expression Design</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression+Graphic+Designer/default.aspx" 
    rel=tag>Expression Graphic Designer</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression+Interactive+Designer/default.aspx" 
    rel=tag>Expression Interactive Designer</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression+Web/default.aspx" 
    rel=tag>Expression Web</A> 
    <LI class=Tag4><A 
    href="http://blogs.msdn.com/expression/archive/tags/Expression+Web+Designer/default.aspx" 
    rel=tag>Expression Web Designer</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/expression/archive/tags/Microsoft+Silverlight/default.aspx" 
    rel=tag>Microsoft Silverlight</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/expression/archive/tags/MSDN/default.aspx" 
    rel=tag>MSDN</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/expression/archive/tags/survey/default.aspx" 
    rel=tag>survey</A> 
    <LI class=Tag3><A 
    href="http://blogs.msdn.com/expression/archive/tags/Windows+Presentation+Foundation/default.aspx" 
    rel=tag>Windows Presentation Foundation</A> </LI></UL></UL></DIV>
<DIV id=NewsSideBar></DIV>
<DIV id=ArchiveSideBar>
<H3>Archives</H3>
<UL>
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/10.aspx">October 
  2007 (3)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/09.aspx">September 
  2007 (2)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/08.aspx">August 
  2007 (1)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/07.aspx">July 2007 
  (2)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/06.aspx">June 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/05.aspx">May 2007 
  (3)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/04.aspx">April 2007 
  (2)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/03.aspx">March 2007 
  (3)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2007/01.aspx">January 
  2007 (4)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/12.aspx">December 
  2006 (7)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/09.aspx">September 
  2006 (1)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/08.aspx">August 
  2006 (1)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/07.aspx">July 2006 
  (2)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/06.aspx">June 2006 
  (2)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/05.aspx">May 2006 
  (3)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/04.aspx">April 2006 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/03.aspx">March 2006 
  (10)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/02.aspx">February 
  2006 (21)</A> 
  <LI><A href="http://blogs.msdn.com/expression/archive/2006/01.aspx">January 
  2006 (14)</A> </LI></UL></DIV>
<DIV id=LinkSideBar>
<H3>Additional links</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl03_Link 
  href="http://channel9.msdn.com/ShowPost.aspx?PostID=247419#247419">iView 
  MediaPro To Become Expression Media</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl04_Link 
  href="http://channel9.msdn.com/Showpost.aspx?postid=263365">Getting Started 
  with "WPF/E"</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl05_Link 
  href="http://channel9.msdn.com/tags/expression">Expression Videos on Channel 
  9</A> </LI></UL>
<H3>Article Categories</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl01_Link 
  href="http://blogs.msdn.com/expression/pages/samples-and-tutorials-gallery-expression-design.aspx">Samples 
  and Tutorials Gallery - Expression Design</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl02_Link 
  href="http://blogs.msdn.com/expression/articles/517022.aspx">Community Samples 
  Gallery - Expression Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl03_Link 
  href="http://blogs.msdn.com/expression/articles/543834.aspx">Samples and 
  Tutorials Gallery - Expression Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl04_Link 
  href="http://blogs.msdn.com/expression/pages/community-samples-gallery-expression-design.aspx">Community 
  Samples Gallery - Expression Design</A> </LI></UL>
<H3>Community</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl01_Link 
  href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.expression.discussion&amp;cat=en_US_717f231e-6256-4e36-975c-3a3ced16532b&amp;lang=en&amp;cr=US">Expression 
  Discussion</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl02_Link 
  href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.expression.interactivedesigner&amp;lang=en&amp;cr=US">Expression 
  Blend Discussion</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl03_Link 
  href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.expression.graphicdesigner&amp;lang=en&amp;cr=US">Expression 
  Design Discussion</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl02_Links_ctl04_Link 
  href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.expression.webdesigner&amp;cat=&amp;lang=en&amp;cr=US">Expression 
  Web Discussion</A> </LI></UL>
<H3>Great WPF and Blend bloggers</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl01_Link 
  href="http://blogs.msdn.com/okoboji">Kevin Moore, Program Manager, WPF</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl02_Link 
  href="http://blogs.msdn.com/atc_avalon_team">Advanced Technology Center WPF 
  team, Beijing</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl03_Link 
  href="http://notstatic.com/">Robert Ingebretsen, Program Manager, WPF</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl04_Link 
  href="http://www.beacosta.com/">Beatriz Costa, SDET, WPF</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl05_Link 
  href="http://www.simplegeek.com/">Chris Anderson, Architect</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl06_Link 
  href="http://blogs.msdn.com/henryh">Henry Hahn, Program Manager, WPF</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl07_Link 
  href="http://fortes.com/work">Filipe Fortes, Program Manager, WPF</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl03_Links_ctl08_Link 
  href="http://rrelyea.spaces.live.com/">Rob Relyea, Program Manager, WPF</A> 
  </LI></UL>
<H3>Team member blogs</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl01_Link 
  href="http://blogs.msdn.com/adamu/">Adam Ulrich, Test Manager, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl02_Link 
  href="http://blogs.msdn.com/alanga/">Alan Gasperini, Software Design Engineer, 
  Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl03_Link 
  href="http://www.scarynoises.com/blog">Brad Becker, Senior Product Manager, 
  Developer Marketing</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl04_Link 
  href="http://blogs.msdn.com/jeremykuhne/">Jeremy Kuhne, Software Design 
  Engineer in Test, Expression</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl05_Link 
  href="http://blogs.msdn.com/johngossman/">John Gossman, Architect, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl06_Link 
  href="http://www.aisto.com/roeder/frontier">Lutz Roeder, Software Design 
  Engineer, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl07_Link 
  href="http://blogs.msdn.com/micahel">Michael J Hunter, Software Design 
  Engineer in Test Tech Lead, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl08_Link 
  href="http://blogs.msdn.com/mswanson/default.aspx">Michael Swanson, Technical 
  Evangelist, Platform Evangelism</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl09_Link 
  href="http://blogs.msdn.com/stevewhitepsfd/">Steve White, Program Manager, 
  Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl10_Link 
  href="http://blogs.msdn.com/tims">Tim Sneath, Windows Vista Technical 
  Evangelist</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl11_Link 
  href="http://blogs.msdn.com/unnir">Unni Ravindranathan, Program Manager, 
  Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl12_Link 
  href="http://www.wayne-smith.org/">Wayne Smith, Senior Product Manager, 
  Expression</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl13_Link 
  href="http://blogs.msdn.com/mariogu">Mario Guzzi, Software Design Engineer in 
  Test, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl14_Link 
  href="http://blogs.msdn.com/adrianma">Adrian Mascarenhas, Software Design 
  Engineer in Test, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl15_Link 
  href="http://blogs.msdn.com/karstenj/">Karsten Januszewski, Technical 
  Evangelist</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl16_Link 
  href="http://blogs.msdn.com/adrianvinca/">Adrian Vinca, Software Engineer in 
  Test, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl17_Link 
  href="http://blogs.msdn.com/jrowe/">Jen Rowe, Lead Software Design Engineer in 
  Test, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl18_Link 
  href="http://blogs.msdn.com/danteg">Dante Gagne, Software Design Engineer in 
  Test, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl19_Link 
  href="http://www.clarkezone.net/">James Clarke, Program Manager, 
  Expression</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl20_Link 
  href="http://blogs.msdn.com/andrewj">Andrew Jewsbury, Program Manager, Web</A> 

  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl21_Link 
  href="http://blogs.msdn.com/lingesh">Lingesh Palaniappan Software Design 
  Engineer in Test, Blend</A> 
  <LI><A id=ctl00___ctl00___bs___lcl___Categories_ctl04_Links_ctl22_Link 
  href="http://ux.artu.tv/">Arturo Toledo, Product Manager, Expression</A> 
</LI></UL></DIV></DIV>
<DIV id=content>
<DIV id=content2>
<STYLE>.DoNotDisplay {
	DISPLAY: none
}
</STYLE>

<DIV class=post>
<DIV class=posthead>
<DIV class=postviewhead>Monday, March 19, 2007 5:31 PM by <A 
id=ctl00___ctl00___ctl01___Entry___AuthorLink 
href="http://blogs.msdn.com/user/Profile.aspx?UserID=15719">xprblog</A> </DIV>
<H2>ImageButtons</H2></DIV>
<DIV class=postcontent>
<DIV id=breadcrumb><A href="http://blogs.msdn.com/Home.htm">Home</A> &gt; <A 
href="http://blogs.msdn.com/expression/articles/543834.aspx">Samples and 
Tutorials Gallery - Expression Blend</A> &gt; ImageButtons: Customizing a WPF 
control type</DIV>
<H3>Download the sample project files for the RC build of Expression Blend</H3>
<UL>
  <LI><A class="" href="http://xamlshare.com/sparkle/samplesrc/ImageButtons.zip" 
  mce_href="http://xamlshare.com/sparkle/samplesrc/ImageButtons.zip">ImageButtons.zip</A> 
  </LI></UL>
<H2>ImageButtons: Customizing a WPF Control Type</H2>
<P><EM>Basing your own custom control on a Windows Presentation Foundation 
control by using Microsoft® Expression Blend™.</EM></P>
<H3>Contents</H3>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/down_arrow.gif)">
  <LI><A 
  href="http://blogs.msdn.com/expression/articles/525441.aspx#overview">Overview</A> 

  <LI><A 
  href="http://blogs.msdn.com/expression/articles/525441.aspx#feat">Features 
  that you will learn about in this tutorial</A> 
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#task1">Task 
  1: Creating a project in Expression Blend</A> 
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#task2">Task 
  2: Defining the control type</A> 
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#task3">Task 
  3: Designing the control template</A> 
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#task4">Task 
  4: Re-using the control template</A> 
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#next">Where 
  to go from here</A></LI></UL>
<H3><A class="" title=overview name=overview></A>Overview</H3><SPAN>
<P align=center><IMG alt="The finished project" 
src="Expression Blend and Design  ImageButtons_files/tutorial_ImageButtons.png" 
width=500></P>
<P align=center><EM>The finished project</EM></P>
<P>This tutorial shows you how to <SPAN>customize a control that is defined in a 
Windows Presentation Foundation (WPF) library.</SPAN></P>
<P>Because WPF is based on the Microsoft® .NET Framework, you can customize the 
functionality of existing control types. You can draw a control onto the design 
surface of Expression Blend just as easily whether the control is implemented in 
your own library or in a WPF library. In this tutorial, you will extend the 
<B>Button</B> control to create an <B>ImageButton</B> control that has a 
<B>Source</B> property, in addition to the standard <B>Content</B> property. You 
can then specify how the new <B>Source</B> property is to be used by the 
control, by modifying the control's template.</P>
<P>If you want to work through this tutorial while looking at an example of the 
completed project, you can open a second instance of Expression Blend and view 
the&nbsp;<B>ImageButtons</B>&nbsp;sample project which you can download from <A 
class="" href="http://xamlshare.com/sparkle/samplesrc/ImageButtons.zip" 
mce_href="http://xamlshare.com/sparkle/samplesrc/ImageButtons.zip"><FONT 
color=#0000ff>ImageButtons.zip</FONT></A>. </P></SPAN>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/up_arrow.gif); MARGIN-LEFT: 15px">
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#top">Back 
  to top</A></LI></UL>
<H3><A class="" title=feat name=feat></A>Features that you will learn about in 
this tutorial</H3>
<UL>
  <LI>Customizing a control 
  <LI>Using the <B>DependencyProperty</B> type to define custom control 
  properties 
  <LI>Editing a control template</LI></UL>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/up_arrow.gif); MARGIN-LEFT: 15px">
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#top">Back 
  to top</A></LI></UL>
<H3><A class="" title=task1 name=task1></A>Task 1: Creating a project in 
Expression Blend</H3>The following procedure describes how to create a project 
and save it to disk. 
<OL>
  <LI>On the <B>File</B> menu in Expression Blend, click <B>New Project</B>. 
  <BR>The <B>Create New Project</B> dialog box opens. 
  <LI>Select the <B>Standard Application (.exe)</B> project type. <BR>This 
  creates a project for a Windows®-based application that you can build and run 
  while you are designing it. The other project type, <B>Control Library</B>, is 
  used for designing controls that can be used in other Windows-based 
  applications. 
  <LI>In the <B>Name</B> text box, type <B>ImageButtons</B>. Leave 
  <B>Language</B> set to the default, because this tutorial does not involve 
  handwritten code. Click <B>OK</B>.<BR>Expression Blend loads your new project 
  and displays it for editing. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Note 
        src="Expression Blend and Design  ImageButtons_files/Icon_note.png" 
        border=0></TD>
      <TD class="">If you previously had a project open, you might first see a 
        dialog box asking if you want to save or discard your current project 
        before opening the new one. </TD></TR></TBODY></TABLE>
  <LI>After your new project is loaded into memory, save it to disk. On the 
  <B>File</B> menu, click <B>Save All</B>. The <B>Name</B> text box of the 
  <B>Save Project</B> dialog box should already include the name "ImageButtons", 
  so click <B>OK</B>. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Note 
        src="Expression Blend and Design  ImageButtons_files/Icon_note.png" 
        border=0></TD>
      <TD class="">As you work in Expression Blend, your changes take place in 
        memory and not on your hard drive, so be sure to save early and often. 
        <BR>For more information, see the topic "Managing Your Work" in the 
        Expression Blend User Guide (F1).</TD></TR></TBODY></TABLE></LI></OL>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/up_arrow.gif); MARGIN-LEFT: 15px">
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#top">Back 
  to top</A></LI></UL>
<H3><A class="" title=task2 name=task2></A>Task 2: Defining the control 
type</H3>
<P>The following procedure shows you how to define a custom control in the 
code-behind file for your document.</P>
<OL>
  <LI>In the <B>Project</B> panel, locate the file <B>Window1.xaml</B> and 
  expand it to reveal your project’s code-behind file, which is named 
  <B>Window1.xaml.cs</B>. (If you chose Microsoft Visual Basic® as the language 
  when you created your project, the code-behind file will be named 
  <B>Window1.xaml.vb</B>.) Double-click the code-behind file to open it for 
  editing. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Note 
        src="Expression Blend and Design  ImageButtons_files/Icon_note.png" 
        border=0></TD>
      <TD class="">The code-behind file will open in Microsoft® Visual Studio® 
        2005 if it is installed. Otherwise, the code-behind file will open in 
        the application that is mapped to the file extension of the code-behind 
        file. For example, if you have opened a .cs or .vb file in Notepad, 
        Expression Blend will open the file in Notepad.</TD></TR></TBODY></TABLE>
  <LI>In the Window1.xaml.cs file, paste the following class definition source 
  code just before the last closing brace (<CODE>}</CODE>) of the file. (For 
  Visual Basic, paste the appropriate code just before <B>End Namespace</B> or 
  just after the last <B>End Class</B>.) 
  <UL>
    <LI><B>For C#</B> <PRE><CODE>public class ImageButton : Button 
{ 
&nbsp;&nbsp;&nbsp;&nbsp;public ImageSource Source 
&nbsp;&nbsp;&nbsp;&nbsp;{ 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get { return base.GetValue(SourceProperty) as ImageSource; } 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set { base.SetValue(SourceProperty, value); } 
&nbsp;&nbsp;&nbsp;&nbsp;} 
&nbsp;&nbsp;&nbsp;&nbsp;public static readonly DependencyProperty SourceProperty = DependencyProperty.Register("Source", typeof(ImageSource), typeof(ImageButton)); 
}</CODE></PRE>
    <LI><B>For Visual Basic</B> <PRE><CODE>Class ImageButton
    Inherits Button
    Public Property Source() As ImageSource
        Get
            Return CType(MyBase.GetValue(SourceProperty), ImageSource)
        End Get
        Set(ByVal value As ImageSource)
            MyBase.SetValue(SourceProperty, value)
        End Set
    End Property
    Public Shared ReadOnly SourceProperty As DependencyProperty = DependencyProperty.Register("Source", GetType(ImageSource), GetType(ImageButton))
End Class</CODE></PRE></LI></UL>
  <P>Save the modified Window1.xaml.cs file, and then close Visual Studio or 
  whatever application you used to edit the file.</P>
  <P>The <B>ImageButton</B> class demonstrates the <EM>dependency property</EM> 
  pattern. Externally, the class exposes a regular common language runtime (CLR, 
  that is, .NET) property named <B>Source</B>, which is of type 
  <B>ImageSource</B>. The class also registers and exposes a read-only 
  dependency property field named <B>SourceProperty</B>, and implements the CLR 
  accessors for the <B>Source</B> property in terms of the dependency property. 
  Backing a CLR property with a registered dependency property means that WPF 
  can provide a wealth of services to your property. These services include 
  styling, data binding, value inheritance, default values, and animation. There 
  is also a feature in WPF called <EM>template-binding</EM> where you bind to 
  the property's value from within a control template. This tutorial will show 
  template-binding in action. 
  <P>If you prefer to keep your custom control class definition source code in a 
  separate source code file, you can do so. As an alternative to the previous 
  two steps, if you prefer, you can create a new file called 
  <B>ImageButton.cs</B>, paste the source code into this file together with the 
  namespace declaration and the same set of <B>using</B> directives from your 
  document’s code-behind file, and then add the new file to your project (on the 
  <B>Project</B> menu, click <B>Add Item</B>).</P>
  <LI>You now need to build your project so that the new <B>ImageButton</B> 
  control will appear in the <B>Asset Library</B>. On the <B>Project</B> menu of 
  Expression Blend, click <B>Build Project</B> (or press CTRL+SHIFT+B). Verify 
  that the build has completed without errors. 
  <LI>Switch back to editing <B>Window1.xaml</B> in Expression Blend.</LI></OL>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/up_arrow.gif); MARGIN-LEFT: 15px">
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#top">Back 
  to top</A></LI></UL>
<H3><A class="" title=task3 name=task3></A>Task 3: Designing the control 
template</H3>
<OL>
  <P>The following procedure shows you how to design the control template for 
  the <B>ImageButton</B> control type. You first need to draw an 
  <B>ImageButton</B> in your Expression Blend project, and then edit the 
  template for the <B>ImageButton</B> in-place. The template's visual tree will 
  contain an <B>Image</B> (which will have its <B>Source</B> property 
  template-bound to the <B>Source</B> property of the <B>ImageButton</B>) and a 
  <B>ContentPresenter</B> that displays the value of the <B>Content</B> property 
  inherited from <B>Button</B>.</P>
  <LI>With the Window1.xaml file opened for editing in Expression Blend, make 
  sure you are in <B>Design</B> view by clicking the <B>Design</B> tab on the 
  right side of the artboard. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=extra><IMG alt=Note 
        src="Expression Blend and Design  ImageButtons_files/Icon_note.png" 
        border=0></TD>
      <TD class=extra>When in <B>Design</B> view, you can view the structure 
        of your document under <B>Objects and Timeline</B> in the 
        <B>Interaction</B> panel, and view the properties that are set on 
        individual elements in the <B>Properties</B> panel. When in <B>XAML</B> 
        view, you cannot view the document structure or set properties in the 
        <B>Properties</B> panel.</TD></TR></TBODY></TABLE>
  <LI>Under <B>Objects and Timeline</B> in the <B>Interaction</B> panel, 
  double-click <B>LayoutRoot</B> to activate it.&nbsp; 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Note 
        src="Expression Blend and Design  ImageButtons_files/Icon_note.png" 
        border=0></TD>
      <TD class="">When you want to add a child element to an element or do 
        other special operations, double-click the parent element under 
        <B>Objects and Timeline</B> in the <B>Interaction</B> panel, and then 
        add the child element. The action of double-clicking an element is 
        called <EM>activation</EM>. The activated element is identified by a 
        yellow bounding box around the element name.<BR>When you want to change 
        the properties of an element, click the element name once under 
        <B>Objects and Timeline</B> in the <B>Interaction</B> panel. This action 
        is called <EM>selection</EM>. The selected element is identified by a 
        highlighted background color.<BR>You can select an element without 
        activating it.</TD></TR></TBODY></TABLE>
  <LI>In the <B>Toolbox</B> along the left side of Expression Blend, click the 
  <B>Asset Library</B> button <IMG class=buttonart alt="Asset Library button" 
  src="Expression Blend and Design  ImageButtons_files/tool_assetlib_on_24x24.png">. 
  <BR>This opens the <B>Asset Library</B> to show you all of the controls, 
  panels, and elements that you can place in your document. 
  <LI>From the <B>User Controls</B> tab, select the <B>ImageButton</B> control 
  from the list. <BR>The <B>Toolbox</B> icon above the <B>Asset Library</B> 
  button is now set to your <B>ImageButton</B> control, and it is already 
  selected so that you can draw the control on the artboard. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=extra><IMG alt=Note 
        src="Expression Blend and Design  ImageButtons_files/Icon_note.png" 
        border=0></TD>
      <TD class=extra>Custom controls will not appear in the <B>User 
        Controls</B> tab of the <B>Asset Library</B> unless you have added the 
        source code to your project and performed a build 
    (CTRL+SHIFT+B).</TD></TR></TBODY></TABLE>
  <LI>With the <B>ImageButton</B> icon selected in the <B>Toolbox</B>, draw an 
  <B>ImageButton</B> by clicking on the artboard and drawing a bounding box 
  inside the document. <BR>The <B>ImageButton</B> is rendered on the artboard 
  and an <B>ImageButton</B> element named <B>[ImageButton] "ImageButton"</B> is 
  listed as a child element of <B>LayoutRoot</B> under <B>Objects and 
  Timeline</B> in the <B>Interaction</B> panel. 
  <LI>You need an image to work with when you edit the control template. With 
  <B>[ImageButton] "ImageButton"</B> selected under <B>Objects and Timeline</B>, 
  look under <B>Miscellaneous</B> in the <B>Properties</B> panel. Set the 
  <B>Source</B> property to the absolute path of an image file on your local 
  file system. For example, you could set the <B>Source</B> property to the 
  following:<BR><PRE><CODE>    file:///C:/Documents and Settings/All Users/Documents/My Pictures/Sample Pictures/Blue hills.jpg</CODE></PRE>The 
  image will not appear on the artboard yet. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Tip 
        src="Expression Blend and Design  ImageButtons_files/Icon_tip.png" 
        border=0></TD>
      <TD class=extra>If a category of the <B>Properties</B> panel is 
        collapsed, you can expand it by clicking <B>Expand Category</B> <IMG 
        class=buttonart alt="Expand Category button" 
        src="Expression Blend and Design  ImageButtons_files/properties_expandcategory.png"> 
        on the title bar of the category, or by clicking the title bar 
    itself.</TD></TR></TBODY></TABLE>
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Tip 
        src="Expression Blend and Design  ImageButtons_files/Icon_tip.png" 
        border=0></TD>
      <TD class=extra>When you use the <B>Search</B> box at the top of the 
        <B>Properties</B> panel to locate a property, remember to clear the 
        <B>Search</B> box when you done. The properties will remain filtered by 
        whatever is typed into the <B>Search</B> box until it is cleared. To 
        clear the <B>Search</B> box, click the <B>Clear</B> <IMG class=buttonart 
        alt="Clear search box button" 
        src="Expression Blend and Design  ImageButtons_files/ux_close_on_11x11.png"> 
        button.</TD></TR></TBODY></TABLE>
  <LI>To create a control template for all <B>ImageButton</B> elements, 
  right-click the new <B>ImageButton</B>, click <B>Edit Control Parts 
  (Template)</B>, and then click <B>Edit a Copy</B>. <BR>The <B>Create Style 
  Resource</B> dialog box appears. 
  <LI>In the <B>Resource </B>n<B>ame (Key)</B> field of the <B>Create Style 
  Resource</B> dialog box, in the text box next to the first radio button, type 
  <B>ImageButtonStyle</B>. <BR>This sets a name for your template in the 
  resource dictionary so you can set it as the template for any 
  <B>ImageButton</B> element. 
  <LI>In the <B>Define in</B> field, select the <B>This document</B> radio 
  button and make sure that <B>Window: Window</B> is selected in the drop-down 
  list.<BR>The <B>Define in</B> field indicates which resource dictionary to 
  define your new template in. Selecting <B>Window: Window</B> means that the 
  template will be visible to all controls in the window. 
  <LI>Click <B>OK</B>.<BR>You have now copied the default control template of 
  all <B>ImageButton</B> elements and have saved the copy as a new 
  <B>ControlTemplate</B> named <B>ImageButtonStyle</B>. The new template has 
  been placed in the resource dictionary, which you can view in the 
  <B>Window</B> node of the <B>Resources</B> panel.&nbsp; <BR>With the creation 
  of a new template, Expression Blend enters a mode in which you can view and 
  edit the new template. Under <B>Objects and Timeline</B> in the 
  <B>Interaction</B> panel, the word <B>Template</B> above the new element tree 
  indicates the current scope in which you are editing. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Tip 
        src="Expression Blend and Design  ImageButtons_files/Icon_tip.png" 
        border=0></TD>
      <TD class="">To exit the template-editing mode and return to the scope 
        of your document, click the <B>Scope Up</B> button <IMG class=buttonart 
        alt="Scope up button" 
        src="Expression Blend and Design  ImageButtons_files/timeline_scopeRoot_on_16x16.png">, 
        which is above the element tree next to the word 
        <B>Template</B>.<BR><BR>To return to template editing mode for an 
        existing template, right-click the element whose template you want to 
        edit under <B>Objects and Timeline</B> in the <B>Interaction</B> panel 
        (in this case, the <B>[ImageButton] "ImageButton"</B> element), click 
        <B>Edit Control Parts (Template)</B>, and then click <B>Edit 
        Template</B>. </TD></TR></TBODY></TABLE>
  <LI>In the <B>Asset Library</B>, select the <B>Show All</B> check box, select 
  the <B>Controls</B> tab, and then click the <B>Grid</B> panel <IMG 
  class=buttonart alt="Grid control" 
  src="Expression Blend and Design  ImageButtons_files/asset_grid_24x24_on.png"> 
  from the list of element names. Double-click the <B>Grid</B> icon that appears 
  above the <B>Asset Library</B> button in the <B>Toolbox</B>. <BR>The contents 
  of the control template have now been replaced with a new <B>Grid</B>. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Tip 
        src="Expression Blend and Design  ImageButtons_files/Icon_tip.png" 
        border=0></TD>
      <TD class="">You can find all assets in the <B>Asset Library</B> by 
        selecting the <B>Show All</B> check box.<BR>The most common assets are 
        available from the <B>Toolbox</B> along the left side of Expression 
        Blend. Some <B>Toolbox</B> icons display a small arrow in the bottom 
        right corner, which indicates that more than one asset can occupy this 
        spot in the <B>Toolbox</B>. You can right-click one of these icons to 
        see the list of available assets, and then select one of the assets from 
        the list to be represented in that spot. The <B>Grid</B> control is a 
        common control, and appears in the list of available assets for one of 
        the icons, along with the other panel controls such as <B>Canvas</B>, 
        <B>StackPanel</B>, and <B>DockPanel</B>.</TD></TR></TBODY></TABLE>
  <LI>While still editing the <B>ImageButtonStyle</B> control template, activate 
  the new <B>Grid</B> element by double-clicking it under <B>Objects and 
  Timeline</B> in the <B>Interaction</B> panel. 
  <LI>Select the <B>Rectangle</B> tool <IMG class=buttonart alt="Rectangle tool" 
  src="Expression Blend and Design  ImageButtons_files/asset_rectangle_24x24_on.png"> 
  from the <B>Toolbox</B> (also a common asset), and draw a new <B>Rectangle</B> 
  inside the <B>Grid</B>. 
  <LI>Lay out the <B>Rectangle</B> so that it perfectly fills the <B>Grid</B>. 
  You can do this by selecting the <B>Rectangle</B> under <B>Objects and 
  Timeline</B> in the <B>Interaction</B> panel, and changing the properties 
  under <B>Layout</B> in the <B>Properties</B> panel to the following: 
  <UL>
    <LI>Set the <B>Width</B> and <B>Height</B> properties to <B>Auto</B> <IMG 
    class=buttonart alt="Set to Auto button" 
    src="Expression Blend and Design  ImageButtons_files/properties_auto_on_12x12.png">. 

    <LI>Set the <B>HorizontalAlignment</B> and <B>VerticalAlignment</B> 
    properties to <B>Stretch</B> <IMG class=buttonart 
    alt="Stretch Horizontal button" 
    src="Expression Blend and Design  ImageButtons_files/align_stretchH_on_16x16.png"> 
    <IMG class=buttonart alt="Stretch Vertical button" 
    src="Expression Blend and Design  ImageButtons_files/align_stretchV_on_16x16.png">. 

    <LI>Set the <B>Margin</B> properties to 0.</LI></UL>
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Tip 
        src="Expression Blend and Design  ImageButtons_files/Icon_tip.png" 
        border=0></TD>
      <TD class=extra>When you pause the mouse pointer over any item in the 
        Expression Blend user interface (such as over buttons, <B>Toolbox</B> 
        assets, properties in the <B>Properties</B> panel, and so on), the name 
        of that item will display in a tooltip. In some cases, a short 
        description of the item will be included with the item name. These 
        tooltips are especially useful if you want to know what to use a 
        particular property for.</TD></TR></TBODY></TABLE>
  <LI>To round the corners of the rectangle, select the <B>Selection</B> tool 
  <IMG class=buttonart alt="Selection tool" 
  src="Expression Blend and Design  ImageButtons_files/tool_selection_on_24x24.png"> 
  in the <B>Toolbox</B>, and then pause your mouse pointer over the top-left 
  corner of the rectangle on the artboard. The mouse pointer changes, depending 
  on the following actions that you can perform:<BR>
  <UL>
    <LI>A double-ended diagonal arrow <IMG class=buttonart alt="Scale cursor" 
    src="Expression Blend and Design  ImageButtons_files/Cursor_Scale.png"> 
    means that you can scale the rectangle. 
    <LI>A curved double-ended arrow <IMG class=buttonart alt="Rotation cursor" 
    src="Expression Blend and Design  ImageButtons_files/Cursor_Rotate.png"> 
    means that you can rotate the rectangle. 
    <LI>Two crossed double-ended arrows <IMG class=buttonart alt="Move cursor" 
    src="Expression Blend and Design  ImageButtons_files/Cursor_CenterPoint.png"> 
    means that you can move the rectangle. 
    <LI>A rounded square <IMG class=buttonart alt="Corner radius cursor" 
    src="Expression Blend and Design  ImageButtons_files/Cursor_CornerRadius.png"> 
    means that you can round the corners of the rectangle. </LI></UL>When you see 
  the rounded square, click and drag your mouse to increase the radius angle of 
  the corners.<BR>This updates the value of the <B>RadiusX</B> and 
  <B>RadiusY</B> properties under <B>Appearance</B> in the <B>Properties</B> 
  panel. Alternatively, you can manually change the values in the <B>RadiusX</B> 
  and <B>RadiusY</B> text boxes. Any change on the artboard results in a 
  property change. 
  <LI>Under <B>Brushes</B> in the <B>Properties</B> panel, click the <B>Advanced 
  Property Options</B> button <IMG class=buttonart 
  alt="Advanced property options" 
  src="Expression Blend and Design  ImageButtons_files/advancedpropertyoptions.png"> 
  to the right of the <B>Fill </B>property, point to <B>Template Binding</B>, 
  and then click <B>Background</B>. <BR>What you have just done is known as 
  <EM>template-binding</EM>, which means binding a property of an element within 
  the template to a property of the control that uses the template. You have 
  template-bound the&nbsp;<B>Fill</B> property of the <B>Rectangle</B> to the 
  <B>Background</B> of the <B>ImageButton</B>. 
  <LI>Activate the <B>Grid</B> by double-clicking it under <B>Objects and 
  Timeline</B> in the <B>Interaction</B> panel. 
  <LI>With the <B>Selection</B> tool, move the mouse pointer over the thick blue 
  ruler area at the top of the <B>Grid</B> on the artboard. An orange column 
  ruler will follow your mouse pointer to&nbsp; indicate where a new column 
  divider will be placed if you click. <BR>Click to create a new column divider 
  in the middle of the <B>Grid</B>. <BR>A blue column divider appears inside the 
  <B>Grid</B>. 
  <LI>Select the <B>Image</B> tool <IMG class=buttonart alt="Image control" 
  src="Expression Blend and Design  ImageButtons_files/asset_image_24x24_on.png"> 
  from the <B>Control</B> tab of the <B>Asset Library</B>. With the <B>Grid</B> 
  element still activated under <B>Objects and Timeline</B> in the 
  <B>Interaction</B> panel, draw a new <B>Image</B> inside the left column of 
  the <B>Grid</B>.&nbsp; 
  <LI>With the new <B>Image</B> element selected under <B>Objects and 
  Timeline</B>, look under <B>Common Properties</B> in the <B>Properties</B> 
  panel. Click the <B>Advanced Property Options</B> button to the right of the 
  <B>Source </B>property, point to <B>Template Binding</B>, and then click 
  <B>Source</B>. <BR>You have just template-bound the&nbsp;<B>Source</B> 
  property of the <B>Image</B> to the <B>Source</B> property of the 
  <B>ImageButton</B> that uses this template. Your image will now be displayed. 
  <LI>With <B>Grid</B> still activated under <B>Objects and Timeline</B>, select 
  the <B>ContentPresenter</B> control from the <B>Controls</B> tab of the 
  <B>Asset Library</B>, and then create a new <B>ContentPresenter</B> in the 
  right column of the <B>Grid</B>. Lay it out so that it just about fills the 
  right column, taking the rounded corners of the <B>Rectangle</B> into account. 

  <LI>With the new <B>ContentPresenter</B> element selected under <B>Objects and 
  Timeline</B>, look under <B>Common Properties</B> in the <B>Properties</B> 
  panel. Click the <B>Advanced Property Options</B> button to the right of the 
  <B>Content</B> property, point to <B>Template Binding</B>, and then click 
  <B>Content</B>. <BR>You have just template-bound the&nbsp;<B>Content</B> 
  property of the <B>ContentPresenter</B> to the <B>Content</B> property of the 
  <B>ImageButton</B> that uses this template. 
  <LI>You are now done editing the template. To exit to the scope of the root 
  element, click <B>Scope Up</B>&nbsp;under <B>Objects and Timeline</B>. 
  <LI>You can now design the content of the <B>ImageButton</B> as normal and the 
  content will appear to the right of the image.</LI></OL>
<H3><A class="" title=task4 name=task4></A>Task 4: Re-using the control 
template</H3>
<OL>
  <P>The following procedure shows you how to apply an existing control template 
  to another control of the same type for which it was designed. </P>
  <LI>From the <B>User Controls</B> tab of the <B>Asset Library</B>, select the 
  <B>ImageButton</B> control. Draw a new <B>ImageButton</B> control on the 
  artboard. 
  <LI>Select the new <B>ImageButton</B> element under <B>Objects and 
  Timeline</B> in the <B>Interaction</B> panel. On the <B>Object</B> menu, point 
  to <B>Edit Style</B>, point to <B>Apply Resource</B>, and then click the name 
  of your control template, <B>ImageButtonStyle</B>. <BR>The content of the new 
  <B>ImageButton</B> control now appears on the right, with space left for an 
  image. 
  <TABLE class="">
    <TBODY>
    <TR>
      <TD class=""><IMG alt=Tip 
        src="Expression Blend and Design  ImageButtons_files/Icon_tip.png" 
        border=0></TD>
      <TD class=extra>You might wonder why you do not select the <B>Edit 
        Control Parts (Template)</B> item from the <B>Object</B> menu to apply 
        an existing control template to a control. This is because, in 
        Expression Blend, control templates are wrapped in a <B>Style</B> 
        element.</TD></TR></TBODY></TABLE>
  <LI>With your new <B>ImageButton</B> selected under <B>Objects and 
  Timeline</B> in the <B>Interaction</B> panel, look under <B>Miscellaneous</B> 
  in the <B>Properties</B> panel. Set the <B>Source</B> property to the absolute 
  path of an image file on your local file system. For example, you could set 
  the <B>Source</B> property to the following:<BR><PRE><CODE>    file:///C:/Documents and Settings/All Users/Documents/My Pictures/Sample Pictures/Sunset.jpg</CODE></PRE>The 
  image now appears in the <B>ImageButton</B>. 
  <LI>On the <B>Project</B> menu, click <B>Test Project</B> (F5) to see your 
  application.</LI></OL>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/up_arrow.gif); MARGIN-LEFT: 15px">
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#top">Back 
  to top</A></LI></UL>
<H3><A class="" title=#next name=#next></A>Where to go from here</H3>
<UL>
  <LI>Develop your custom <B>ImageButton</B> control further to add a property 
  that specifies a URL to browse to when the button is clicked. To cause the 
  <B>ImageButton</B> to navigate to the URL, you can implement a 
  <B>MouseDown</B> event method for the <B>ImageButton</B> element in the 
  Window1.xaml.cs file and add a line of code similar to the following:<BR><PRE><CODE>    System.Windows.Navigation.NavigationService.GetNavigationService(this).Navigate(new Uri(MyImageButton.URL,UriKind.RelativeOrAbsolute));</CODE></PRE>Note 
  that for this to work, you need to give your <B>ImageButton</B> control a 
  name, such as <CODE>MyImageButton</CODE>. For more information, see "Event 
  handling" in the Expression Blend User Guide (F1). 
  <LI>Use your custom <B>ImageButton</B> control in the <B>HyperBar</B> sample, 
  which is also available from the <B>Welcome Screen</B> of Expression blend. 
  <LI>Animate the template of your <B>ImageButton</B> so that its appearance 
  changes when it is clicked. For more information, see "Animation&nbsp;and 
  interactivity" in the Expression Blend User Guide (F1).</LI></UL>
<UL 
style="LIST-STYLE-IMAGE: url(http://www.xamlshare.com/sparkle/images/rctutorials/main/up_arrow.gif); MARGIN-LEFT: 15px">
  <LI><A href="http://blogs.msdn.com/expression/articles/525441.aspx#top">Back 
  to top</A></LI></UL></DIV>
<DIV><SPAN id=ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel></SPAN><INPUT 
id=ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel_State type=hidden 
value=nochange 
name=ctl00$_$ctl00$_$ctl01$_$Entry$_$InlineTagEditorPanel></DIV></DIV>
<DIV id=postToolbar>
<H2 class=CommonSubTitle>Comment Notification</H2>
<P>If you would like to receive an email when updates are made to this post, 
please register <A id=ctl00___ctl00___ctl01___DetailedSubBar___RegisterLink 
href="http://blogs.msdn.com/user/CreateUser.aspx?ReturnUrl=/expression/articles/525441.aspx">here</A> 
</P>
<P>Subscribe to this post's comments using <A 
id=ctl00___ctl00___ctl01___DetailedSubBar___CommentRssLink 
href="http://blogs.msdn.com/expression/commentrss.aspx?PostID=525441">RSS</A> 
</P></DIV>
<H3>Comments </H3>
<DIV id=comments>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl01_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#525446">#</A> 
ImageButtons - a new EID tutorial<A name=525446></A> </H4>
<DIV class=commentssubhead>Monday, February 06, 2006 12:56 AM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl01_NameLink title=TrackBack 
href="http://blogs.msdn.com/expression/archive/2006/02/05/525445.aspx" 
target=_blank rel=nofollow>The Expression Designers: Graphic, Interactive, 
Web</A> <SPAN class=commentspan></SPAN></DIV>
<DIV class=commentsbody>We have published a new Expression Interactive Designer 
tutorial targeting the January 2006 CTP. It's... </DIV></DIV>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl02_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#525979">#</A> re: 
ImageButtons<A name=525979></A> </H4>
<DIV class=commentssubhead>Monday, February 06, 2006 4:05 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl02_NameLink title=Geoff 
href="http://blogs.msdn.com/user/Profile.aspx?UserID=17373" 
target=_blank>Geoff</A> <SPAN class=commentspan></SPAN></DIV>
<DIV class=commentsbody>getting an error on step 13 of task 2: <BR>Create a new 
Image in the left-hand column and template-bind the Source property to Source. 
Your image will now be displayed. Center the Image. <BR><BR>Error says: <BR>the 
member is already registered as a DependencyPropertyReferenceStep 
<BR><BR>thoughts?? </DIV></DIV>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl03_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#525986">#</A> re: 
ImageButtons<A name=525986></A> </H4>
<DIV class=commentssubhead>Monday, February 06, 2006 4:17 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl03_NameLink title=Geoff 
href="http://blogs.msdn.com/user/Profile.aspx?UserID=17373" 
target=_blank>Geoff</A> <SPAN class=commentspan></SPAN></DIV>
<DIV class=commentsbody>IED crashed and now step 13 works :o) </DIV></DIV>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl04_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#526056">#</A> re: 
ImageButtons<A name=526056></A> </H4>
<DIV class=commentssubhead>Monday, February 06, 2006 5:08 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl04_NameLink 
title="deebs (Alan Lukaszewicz)" href="http://www.deebs.biz/" target=_blank 
rel=nofollow>deebs (Alan Lukaszewicz)</A> <SPAN class=commentspan></SPAN></DIV>
<DIV class=commentsbody>This is a very good start and only another 8 million 
tutorials to go? <BR><BR>Have a look at this: <BR><BR><A 
href="http://www.cartoonsmart.com/" target=_new 
rel=nofollow>http://www.cartoonsmart.com/</A> <BR><BR>A google on flash 
tutorials returns a modest 71 million hits plus. <BR><BR>Only another 70, 999, 
999 to go? </DIV></DIV>
<DIV class=commentowner>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl05_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#526933">#</A> re: 
ImageButtons<A name=526933></A> </H4>
<DIV class=commentssubhead>Tuesday, February 07, 2006 3:48 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl05_NameLink title=xprblog 
href="http://blogs.msdn.com/user/Profile.aspx?UserID=15719" 
target=_blank>xprblog</A> <SPAN class=commentspan></SPAN></DIV>
<DIV class=commentsbody>
<P>Thanks for the comment deebs. You'll find more Expression tutorials over on 
the right of the blog in the Article Categories section. Those are specific to 
Expression but of course Expression is a tool for building apps on the Windows 
Presentation Foundation (WPF) platform due to be released in the Windows Vista 
timeframe. For more WPF tutorials see this resource:</P>
<P><A 
href="http://msdn.microsoft.com/windowsvista/building/presentation/hands_on_lab/default.aspx">http://msdn.microsoft.com/windowsvista/building/presentation/hands_on_lab/default.aspx</A><BR><BR>For 
more info on Windows Vista and the next generation of Windows UX, please see the 
Windows Vista Developer Center here: <A 
href="http://msdn.microsoft.com/windowsvista/" target=_new 
rel=nofollow>http://msdn.microsoft.com/windowsvista/</A> <BR></P></DIV></DIV>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl06_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#543839">#</A> 
Samples and Tutorials Gallery - Expression Interactive Designer March 06 CTP<A 
name=543839></A> </H4>
<DIV class=commentssubhead>Saturday, March 04, 2006 10:23 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl06_NameLink title=TrackBack 
href="http://blogs.msdn.com/expression/articles/543834.aspx" target=_blank 
rel=nofollow>The Expression Designers: Graphic, Interactive, Web</A> <SPAN 
class=commentspan></SPAN></DIV>
<DIV class=commentsbody>To view a sample or tutorial, click on one of thumbnails 
or links below. Some samples also have supporting... </DIV></DIV>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl07_PermaLink 
title=permalink 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx#1915768">#</A> 
Microsoft Expression : ImageButtons<A name=1915768></A> </H4>
<DIV class=commentssubhead>Monday, March 19, 2007 8:54 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl07_NameLink title=TrackBack 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx" target=_blank 
rel=nofollow>Microsoft Expression : ImageButtons</A> <SPAN 
class=commentspan></SPAN></DIV>
<DIV class=commentsbody>
<P>PingBack from <A 
href="http://blogs.msdn.com/expression/pages/imagebuttons.aspx" target=_new 
rel=nofollow>http://blogs.msdn.com/expression/pages/imagebuttons.aspx</A></P></DIV></DIV></DIV>
<DIV id=commentform>
<H3>Leave a Comment</H3>
<DL>
  <DT id=ctl00___ctl00___ctl01___form___NameTitle><LABEL 
  for=ctl00___ctl00___ctl01___form___tbName>Name</LABEL> 
  <EM>(required)</EM><SPAN 
  id=ctl00___ctl00___ctl01___form___Requiredfieldvalidator2 
  style="VISIBILITY: hidden; COLOR: red">*</SPAN>
  <DD id=ctl00___ctl00___ctl01___form___NameDesc><INPUT class=smallbox 
  id=ctl00___ctl00___ctl01___form___tbName 
  name=ctl00$_$ctl00$_$ctl01$_$form$_$tbName> 
  <DT><LABEL for=ctl00___ctl00___ctl01___form___tbUrl>Your URL</LABEL> 
  <EM>(optional</EM>) 
  <DD><INPUT class=smallbox id=ctl00___ctl00___ctl01___form___tbUrl 
  name=ctl00$_$ctl00$_$ctl01$_$form$_$tbUrl> 
  <DT><LABEL for=ctl00___ctl00___ctl01___form___tbComment>Comments</LABEL> 
  <EM>(required)</EM><SPAN 
  id=ctl00___ctl00___ctl01___form___Requiredfieldvalidator3 
  style="VISIBILITY: hidden; COLOR: red">*</SPAN> 
  <DD><TEXTAREA id=ctl00___ctl00___ctl01___form___tbComment name=ctl00$_$ctl00$_$ctl01$_$form$_$tbComment rows=5 cols=25></TEXTAREA> 

  <DT><INPUT id=ctl00___ctl00___ctl01___form___chkRemember type=checkbox 
  name=ctl00$_$ctl00$_$ctl01$_$form$_$chkRemember><LABEL 
  for=ctl00___ctl00___ctl01___form___chkRemember>Remember Me?</LABEL> 
  <DT><INPUT id=ctl00___ctl00___ctl01___form___btnSubmit onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit", "", true, "", "", false, false))' type=submit value=Submit name=ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit> 
  </DT></DL></DIV></DIV></DIV>
<DIV id=contentfooter>&nbsp;</DIV></DIV>
<DIV id=footer></DIV></DIV></DIV>
<SCRIPT type=text/javascript>
<!--
var Page_Validators =  new Array(document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator2"), document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"));
// -->
</SCRIPT>

<SCRIPT type=text/javascript>
<!--
var ctl00___ctl00___ctl01___form___Requiredfieldvalidator2 = document.all ? document.all["ctl00___ctl00___ctl01___form___Requiredfieldvalidator2"] : document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator2");
ctl00___ctl00___ctl01___form___Requiredfieldvalidator2.controltovalidate = "ctl00___ctl00___ctl01___form___tbName";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator2.errormessage = "*";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator2.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator2.initialvalue = "";
var ctl00___ctl00___ctl01___form___Requiredfieldvalidator3 = document.all ? document.all["ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"] : document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3");
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.controltovalidate = "ctl00___ctl00___ctl01___form___tbComment";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.errormessage = "*";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.initialvalue = "";
// -->
</SCRIPT>

<SCRIPT language=javascript type=text/javascript>
<!--
function KeyDownHandlerctl00___ctl00___bt___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$bt$_$ws$_$SearchButton','')	}
}

//-->
</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/expression/pages/imagebuttons.aspx"
dc:identifier="http://blogs.msdn.com/expression/pages/imagebuttons.aspx"
dc:title="ImageButtons"
trackback:ping="http://blogs.msdn.com/expression/trackback.aspx?PostID=525441" />
</rdf:RDF>
-->
<SCRIPT type=text/javascript>
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</SCRIPT>
</FORM></BODY></HTML>
