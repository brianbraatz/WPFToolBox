<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>Mario Guzzi's blog : Ring of Light control using EID</title>
 




<meta name="description" content="Here is my attempt to create a control that contains some animations and could be used to give the XBox 'ring of light' effect using EID. I did it by creating a new template for a control and adding a timeline to the control template that would start">
<meta name="GENERATOR" content="CommunityServer 2.1 SP1 (Build: 61025.2)">
<link rel="pingback" href="http://blogs.msdn.com/mariogu/pingback.aspx">
<link rel="stylesheet" href="Ring%20of%20Light%20control%20using%20EID_files/style.css" type="text/css" media="screen">
<link rel="stylesheet" href="Ring%20of%20Light%20control%20using%20EID_files/print.htm" type="text/css" media="print">
<link rel="stylesheet" href="Ring%20of%20Light%20control%20using%20EID_files/wide.css" type="text/css" media="screen">
<link rel="shortcut icon" type="image/ico" href="http://blogs.msdn.com/favicon.ico">
<link rel="alternate" type="application/rss+xml" title="Mario Guzzi's blog (RSS 2.0)" href="http://blogs.msdn.com/mariogu/rss.xml">
<link rel="alternate" type="application/atom+xml" title="Mario Guzzi's blog (Atom 1.0)" href="http://blogs.msdn.com/mariogu/atom.xml">
<link rel="alternate" type="application/rss+xml" title="Ring of Light control using EID Comment RSS (RSS 2.0)" href="http://blogs.msdn.com/mariogu/commentrss.aspx?PostID=543219">

	<script src="Ring%20of%20Light%20control%20using%20EID_files/global.js" type="text/javascript"></script>
<style>
.DoNotDisplay { display: none; }
</style></head><body>
<form name="aspnetForm" method="post" action="/mariogu/archive/2006/03/03/543219.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="aspnetForm">
<div>
<input name="__EVENTTARGET" id="__EVENTTARGET" value="" type="hidden">
<input name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" type="hidden">
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFI2N0bDAwJF8kY3RsMDAkXyRicyRfJHdzJF8kU2VhcmNoQm94rkRXbV1z5ohWybmugg6l5bfTy3M=" type="hidden">
</div>

<script type="text/javascript">
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script>


<script src="Ring%20of%20Light%20control%20using%20EID_files/WebResource_002.js" type="text/javascript"></script>

<script language="javascript" type="text/javascript" src="Ring%20of%20Light%20control%20using%20EID_files/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</script><script language="javascript" type="text/javascript">
var RatingControlAJAX = {
"SaveRating":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Blogs.Controls.BlogRatePost',id,'SaveRating',[p0],cb,0,0,0,1);}};
</script><script language="javascript" type="text/javascript">
var ThreadSubscribeLinkButton = {
"ToggleEmailReplies":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Controls.ThreadSubscribeLinkButton',id,'ToggleEmailReplies',[p0],cb,0,0,0,0);}};
</script><script type="text/javascript" src="Ring%20of%20Light%20control%20using%20EID_files/ratingcontrol.js"></script><script language="JavaScript" type="text/javascript">var ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = false;var ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = false;function updateSubscriptionText() {if(ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus == true) {document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Stop sending me email alerts for this post';} else {document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Send me email alerts for new comments to this post';}}function toggleSubscription() {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = true;document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Updating email notifications...';ThreadSubscribeLinkButton.ToggleEmailReplies('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton',440177, toggleSubscriptionCallback);}function toggleSubscriptionCallback(response) {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = false;if((response.error == null) && (response.value == true)) {if(ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus == true) {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = false;} else {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = true;}updateSubscriptionText();} else {updateSubscriptionText();alert('An error happened while processing your request.  Please notify an administrator and try again later.');}}</script>
<script src="Ring%20of%20Light%20control%20using%20EID_files/WebResource.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</script>

			
<div id="masthead">
	
		<div id="welcome" align="right">
			
					Signed in as <a href="http://blogs.msdn.com/user/EditProfile.aspx?ReturnUrl=/blogs/post.aspx?App=mariogu&amp;y=2006&amp;m=03&amp;d=03&amp;PostID=543219">bbraatz</a>
 | <a id="ctl00___ctl00___duw1_rc1___logout" href="http://blogs.msdn.com/logout.aspx">Sign out</a>



				
			 | 
			<a id="ctl00___ctl00___duw1_Faq1" href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</a>
		</div>
	
</div>
<div id="wrapper"><div id="container">
	<div id="header">
		
<div id="title">
	<h1><a id="ctl00___ctl00___bt___BlogTitle" class="headermaintitle" href="http://blogs.msdn.com/mariogu/default.aspx">Mario Guzzi's blog</a></h1>
	<p id="tagline">Thoughts on Microsoft Expression, Design, Testing and coding</p>
</div>
<div id="SubscriptionsSideBar">
	
<div id="subscriptions">
<ul>
	<li><a id="ctl00___ctl00___bt___s___rss" href="http://blogs.msdn.com/mariogu/rss.xml">RSS 2.0</a></li>
	<li><a id="ctl00___ctl00___bt___s___atom" href="http://blogs.msdn.com/mariogu/atom.xml">Atom 1.0</a></li>
	<li><a id="ctl00___ctl00___bt___s___email" href="http://blogs.msdn.com/mariogu/emailsubscriptions.aspx">Email alerts</a></li>
</ul>
</div>
 
 
</div>
<div id="nav">
	<ul>
	<li><a id="ctl00___ctl00___bt___home" href="http://blogs.msdn.com/mariogu/default.aspx">Home</a></li>
	
	<li><a id="ctl00___ctl00___bt___Contactlink1" href="http://blogs.msdn.com/mariogu/contact.aspx">Email</a></li>
	</ul>
</div>
	</div>
	<div id="contentwrapper">
		<div id="sidebar-a">
			
<div id="TasksSideBar">
	
</div>

<div id="SearchSideBar">
	
<div id="search">
	<h3>Search</h3>
	<input name="ctl00$_$ctl00$_$bs$_$ws$_$SearchBox" id="ctl00___ctl00___bs___ws___SearchBox" class="searchBox" onkeydown="KeyDownHandlerctl00___ctl00___bs___ws___SearchButton(event);" type="text">
	<a id="ctl00___ctl00___bs___ws___SearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$bs$_$ws$_$SearchButton','')">Go</a>
</div><br>
</div>

<div id="TagSideBar">
	<h3>Tags</h3>
	<ul>
	<div class="SidebarTagCloud">
No tags have been created or used yet.</div>

	</ul>
</div>

<div id="NewsSideBar">
	
<h3>News</h3>
<div id="news"> Content is provided "AS IS" with no warranties and
confers no rights. Opinions are my own and do not represent those of my
employer.
</div>
</div>

<div id="ArchiveSideBar">
	

<h3>Archives</h3>
<ul>

	<li><a href="http://blogs.msdn.com/mariogu/archive/2007/01.aspx">January 2007 (1)</a></li>

	<li><a href="http://blogs.msdn.com/mariogu/archive/2006/03.aspx">March 2006 (2)</a></li>

	<li><a href="http://blogs.msdn.com/mariogu/archive/2006/02.aspx">February 2006 (1)</a></li>

	<li><a href="http://blogs.msdn.com/mariogu/archive/2006/01.aspx">January 2006 (1)</a></li>

</ul>

</div>

<div id="LinkSideBar">
	
    <h3>Expression Bloggers</h3>
    <ul>
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl01_Link" href="http://blogs.msdn.com/expression/">Team Blog</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl02_Link" href="http://blogs.msdn.com/adamu">Adam Ulrich</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl03_Link" href="http://blogs.msdn.com/alanga">Alan Gasperini</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl04_Link" href="http://www.elementsofpassion.com/">Amir Khella</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl05_Link" href="http://blogs.msdn.com/micahel">Michael J Hunter</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl06_Link" href="http://blogs.msdn.com/unnir">Unni Ravindranathan</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl07_Link" href="http://www.joemarini.com/">Joen Marini</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl08_Link" href="http://blogs.msdn.com/johngossman/">John Gossman</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl09_Link" href="http://blogs.msdn.com/adrianma">Adrian Mascarenhas</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl10_Link" href="http://blogs.msdn.com/adrianvinca">Adrian Vinca</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl11_Link" href="http://www.blois.us/blog/">Pete Blois</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl12_Link" href="http://spaces.msn.com/lingesh">Lingesh Palaniappan</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl13_Link" href="http://www.multimediadev.net/">Arturo Toledo</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl14_Link" href="http://www.aisto.com/Roeder/frontier/">Lutz Roeder</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl15_Link" href="http://blogs.msdn.com/stevewhitepsfd/">Steve White</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl16_Link" href="http://spaces.msn.com/members/manodesign/">Manuel Clemment</a></li>
    
        <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl17_Link" href="http://blogs.msdn.com/jrowe">Jen Rowe</a></li>
    </ul>


</div></div>
		<div id="content"><div id="content2">
			
			




<div class="post">
	<div class="posthead">
		Friday, March 03, 2006 9:53 PM
		<a id="ctl00___ctl00___ctl01___Entry___AuthorLink" href="http://blogs.msdn.com/user/Profile.aspx?UserID=16768">mariogu</a> 
		<h2>Ring of Light control using EID <span class="ratemenu" id="ctl00___ctl00___ctl01___Entry___Ratings" title="Not yet rated"><img title="Poor" src="Ring%20of%20Light%20control%20using%20EID_files/star-left-off.gif" align="absmiddle" border="0"><img title="Poor" src="Ring%20of%20Light%20control%20using%20EID_files/star-right-off.gif" align="absmiddle" border="0"><img title="Fair" src="Ring%20of%20Light%20control%20using%20EID_files/star-left-off.gif" align="absmiddle" border="0"><img title="Fair" src="Ring%20of%20Light%20control%20using%20EID_files/star-right-off.gif" align="absmiddle" border="0"><img title="Average" src="Ring%20of%20Light%20control%20using%20EID_files/star-left-off.gif" align="absmiddle" border="0"><img title="Average" src="Ring%20of%20Light%20control%20using%20EID_files/star-right-off.gif" align="absmiddle" border="0"><img title="Good" src="Ring%20of%20Light%20control%20using%20EID_files/star-left-off.gif" align="absmiddle" border="0"><img title="Good" src="Ring%20of%20Light%20control%20using%20EID_files/star-right-off.gif" align="absmiddle" border="0"><img title="Excellent" src="Ring%20of%20Light%20control%20using%20EID_files/star-left-off.gif" align="absmiddle" border="0"><img title="Excellent" src="Ring%20of%20Light%20control%20using%20EID_files/star-right-off.gif" align="absmiddle" border="0"></span><input value="0" id="ctl00___ctl00___ctl01___Entry___Ratings_Value" type="hidden"></h2>
	</div>
	<div class="postcontent">
		<p>Here
is my attempt to create a control that contains some animations and
could be used to give the XBox 'ring of light' effect using EID. I did
it by creating a new template for a control and adding a timeline to
the control template that would start on the Control's Loaded event.
Then I template bound some properties like background and foreground of
the control so that you can change them and you are done. <br>I've
attached a resource dictionary that has the template for the control,
to use it in your app here are the steps you have to do in Interactive
Designer:<br>
</p><ol>
<li>Add a Project Item and select the resource dictionary ("RingOfLightControl.xaml") 
</li><li>From the resource palette click on the button that says "Link to resources" and select the resource dictionary 
</li><li>Then just instantiate a couple of Controls (of type Control)
from the Library palette and apply the template (Right click on the
control | Edit Template | Apply Resource and select RingOfLightTemplate</li></ol>
<p></p>In the app shown in the picture I instantiated three controls of different sizes to give a more dramatic effect<br><img id="IMG1" onclick="return IMG1_onclick()" src="Ring%20of%20Light%20control%20using%20EID_files/original.png"><br>&nbsp;<br><strong>Here are the steps to creating this template in Interactive Designer:<br></strong>
<ol>
<li>File | New | Resource Dictionary 
</li><li>In the resources palette click on Link to resources and select the dictionary you just added 
</li><li>In the scene now create a control (of type Control) from the library palette 
</li><li>Right click on the control | Edit Template | Create Empty Template 
</li><li>In the resource creation dialog slect the radio button that
says "Other document" and select the resource diationary you created </li><li>Add a grid into the template using the library palette 
</li><li>Draw some ellipses into the grid 
</li><li>Now create a timeline 
</li><li>Create some scale animation and opacity animation for the ellipse at different times 
</li><li>Select the template node (may called "value") 
</li><li>In the timeline properties palette add a trigger, the trigger should look like [TargetElement][Loaded][Begin]</li></ol>
<p>At this point you are done with the animation inside the template, some other details you can add</p>
<ol>
<li>Switch back to the None tab in the timeline 
</li><li>Select the Grid and from the properties palette click on
background | Template Binding | Background (this will add a template
binding so that when you change the background property of the control
it'll get reflected on the grid) </li><li>Do the same thing for each ellipse you created but the template binding should be done with the property foreground.</li></ol>
<p>Now you can switch back to the scene and create many controls and re-use this template</p>
	</div>
	<div><span id="ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel"></span><input name="ctl00$_$ctl00$_$ctl01$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel_State" value="nochange" type="hidden"></div>
	
	
<br>
<b>Attachment(s): </b><a id="ctl00___ctl00___ctl01___Entry___Attachment___DownLoadLink" href="http://blogs.msdn.com/mariogu/attachment/543219.ashx">RingOfLightControl.xaml</a>	
</div>

<div class="postfoot">
	
<div id="postToolbar">
<h2 class="CommonSubTitle">Comment Notification</h2>
<p>
	
	<a href="javascript:toggleSubscription();" id="ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton" trackingresourcename="Weblogs_UnTrack" nottrackingresourcename="Weblogs_Track" workingresourcename="Weblogs_TrackWorking">Send me email alerts for new comments to this post</a>
</p>
<p>
	Subscribe to this post's comments using
	<a id="ctl00___ctl00___ctl01___DetailedSubBar___CommentRssLink" href="http://blogs.msdn.com/mariogu/commentrss.aspx?PostID=543219">RSS</a>
</p>
</div>

</div>

	<div id="comments">
	<h3>
	Comments
</h3>

	<div class="comment">
	<h4>
		<a id="ctl00___ctl00___ctl01___Comments___Comments_ctl01_PermaLink" title="permalink" href="http://blogs.msdn.com/mariogu/archive/2006/03/03/543219.aspx#543357">#</a>
		re: Ring of Light control using EID<a name="543357"></a>
	</h4>
	<div class="commentssubhead">
		<span class="commentspan"></span>
		Friday, March 03, 2006 7:57 PM 
			by <a id="ctl00___ctl00___ctl01___Comments___Comments_ctl01_NameLink" title="Adrian Mascarenhas" href="http://blogs.msdn.com/adrianma" target="_blank">Adrian Mascarenhas</a>
	</div>
	<div class="commentsbody">
		very cool.. very nice effect..
	</div>
	</div>

	</div>





<div id="commentform">
<h3>Leave a Comment</h3>
<dl>
	
	<dt><label for="ctl00___ctl00___ctl01___form___tbUrl">Your URL</label> <em>(optional</em>)</dt>
	<dd><input name="ctl00$_$ctl00$_$ctl01$_$form$_$tbUrl" id="ctl00___ctl00___ctl01___form___tbUrl" class="smallbox" type="text"></dd>
	<dt><label for="ctl00___ctl00___ctl01___form___tbComment">Comments</label> <em>(required)</em><span id="ctl00___ctl00___ctl01___form___Requiredfieldvalidator3" style="color: Red; visibility: hidden;">*</span></dt>
	<dd><textarea name="ctl00$_$ctl00$_$ctl01$_$form$_$tbComment" rows="5" cols="25" id="ctl00___ctl00___ctl01___form___tbComment"></textarea></dd>
	<dt></dt>
	<dt><input name="ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit" value="Submit" onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit", "", true, "", "", false, false))' id="ctl00___ctl00___ctl01___form___btnSubmit" type="submit"></dt>
</dl>
</div>



   
    
		</div></div>
		<div id="contentfooter">&nbsp;</div>
	</div>

	<div id="footer"></div></div>
</div>

<script type="text/javascript">
<!--
var Page_Validators =  new Array(document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"));
// -->
</script>

<script type="text/javascript">
<!--
var ctl00___ctl00___ctl01___form___Requiredfieldvalidator3 = document.all ? document.all["ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"] : document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3");
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.controltovalidate = "ctl00___ctl00___ctl01___form___tbComment";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.errormessage = "*";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.initialvalue = "";
// -->
</script>

<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___bs___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$bs$_$ws$_$SearchButton','')	}
}

//-->
</script>
<script language="javascript">var ctl00___ctl00___ctl01___Entry___Ratings=new RateControl('ctl00___ctl00___ctl01___Entry___Ratings','ctl00___ctl00___ctl01___Entry___Ratings','ctl00___ctl00___ctl01___Entry___Ratings_Value', 5, '/Themes/default/images/common/', false, 'ratemenu','CommonRateControlActive','ratemenu',['Terrible','Poor','Fair','Average','Good','Excellent'],false,true);</script>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/mariogu/archive/2006/03/03/543219.aspx"
dc:identifier="http://blogs.msdn.com/mariogu/archive/2006/03/03/543219.aspx"
dc:title="Ring of Light control using EID"
trackback:ping="http://blogs.msdn.com/mariogu/trackback.aspx?PostID=543219" />
</rdf:RDF>
-->

<script type="text/javascript">
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</script>
        </form>
</body></html>