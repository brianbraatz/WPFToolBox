<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0057)http://blogs.msdn.com/text/archive/2006/05/07/545859.aspx -->
<HTML lang=en xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:o = 
"urn:schemas-microsoft-com:office:office" xmlns:st1 = 
"urn:schemas-microsoft-com:office:smarttags"><HEAD><TITLE>WPF Text Blog : MSDN TV Demo Part 1: Creating an OpenType menu in WPF</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Hi, my name is Chris Han, I’m the program manager in Windows Presentation Foundation working on text and globalization. You might have seen our recent MSDN TV episode “Overview of text and flow layout in Windows Presentation Foundation” where I demonstrated" 
name=description>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blogs.msdn.com/text/pingback.aspx" rel=pingback><LINK media=screen 
href="WPF Text Blog  MSDN TV Demo Part 1 Creating an OpenType menu in WPF_files/style.css" 
type=text/css rel=stylesheet><LINK media=print 
href="/Themes/Blogs/luxinterior/style/print.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="WPF Text Blog  MSDN TV Demo Part 1 Creating an OpenType menu in WPF_files/light_sidebar_left.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel="shortcut icon"><LINK title="WPF Text Blog (RSS 2.0)" 
href="http://blogs.msdn.com/text/rss.xml" type=application/rss+xml 
rel=alternate><LINK title="WPF Text Blog (Atom 1.0)" 
href="http://blogs.msdn.com/text/atom.xml" type=application/atom+xml 
rel=alternate><LINK 
title="MSDN TV Demo Part 1: Creating an OpenType menu in WPF  Comment RSS (RSS 2.0)" 
href="http://blogs.msdn.com/text/commentrss.aspx?PostID=545859" 
type=application/rss+xml rel=alternate>
<SCRIPT 
src="WPF Text Blog  MSDN TV Demo Part 1 Creating an OpenType menu in WPF_files/global.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<FORM id=aspnetForm name=aspnetForm action=/text/archive/2006/05/07/545859.aspx 
method=post>
<DIV><INPUT id=__EVENTTARGET type=hidden name=__EVENTTARGET> <INPUT 
id=__EVENTARGUMENT type=hidden name=__EVENTARGUMENT> <INPUT id=__VIEWSTATE 
type=hidden 
value=/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFI2N0bDAwJF8kY3RsMDAkXyRicyRfJHdzJF8kU2VhcmNoQm94rkRXbV1z5ohWybmugg6l5bfTy3M= 
name=__VIEWSTATE> </DIV>
<SCRIPT type=text/javascript>
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</SCRIPT>

<SCRIPT language=javascript 
src="WPF Text Blog  MSDN TV Demo Part 1 Creating an OpenType menu in WPF_files/Telligent_Modal.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript type=text/javascript>
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</SCRIPT>

<DIV id=masthead>
<DIV id=welcome align=right>Welcome to MSDN Blogs <A 
id=ctl00___ctl00___duw1_ac1___Login 
href="http://blogs.msdn.com/login.aspx?ReturnUrl=%2ftext%2farchive%2f2006%2f05%2f07%2f545859.aspx">Sign 
in</A> | <A id=ctl00___ctl00___duw1_ac1___Register 
href="http://blogs.msdn.com/user/CreateUser.aspx?ReturnUrl=/text/archive/2006/05/07/545859.aspx">Join</A> 
| <A id=ctl00___ctl00___duw1_Faq1 
href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</A> </DIV></DIV>
<DIV id=wrapper>
<DIV id=container>
<DIV id=header>
<DIV id=title>
<H1><A class=headermaintitle id=ctl00___ctl00___bt___BlogTitle 
href="http://blogs.msdn.com/text/default.aspx">WPF Text Blog</A></H1>
<P id=tagline>A blog on WinFX: Windows Presentation Foundation text and flow 
layout.</P></DIV>
<DIV id=SubscriptionsSideBar>
<DIV id=subscriptions>
<UL>
  <LI><A id=ctl00___ctl00___bt___s___rss 
  href="http://blogs.msdn.com/text/rss.xml">RSS 2.0</A> 
  <LI><A id=ctl00___ctl00___bt___s___atom 
  href="http://blogs.msdn.com/text/atom.xml">Atom 1.0</A> </LI></UL></DIV></DIV>
<DIV id=nav>
<UL>
  <LI><A id=ctl00___ctl00___bt___home 
  href="http://blogs.msdn.com/text/default.aspx">Home</A> </LI></UL></DIV></DIV>
<DIV id=contentwrapper>
<DIV id=sidebar-a>
<DIV id=TasksSideBar></DIV>
<DIV id=SearchSideBar>
<DIV id=search>
<H3>Search</H3><INPUT class=searchBox id=ctl00___ctl00___bs___ws___SearchBox 
onkeydown=KeyDownHandlerctl00___ctl00___bs___ws___SearchButton(event); 
name=ctl00$_$ctl00$_$bs$_$ws$_$SearchBox> <A 
id=ctl00___ctl00___bs___ws___SearchButton 
href="javascript:__doPostBack('ctl00$_$ctl00$_$bs$_$ws$_$SearchButton','')">Go</A> 
</DIV><BR></DIV>
<DIV id=TagSideBar>
<H3>Tags</H3>
<UL>
  <UL class=SidebarTagCloud>
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/.net+3.0+windows+update/default.aspx" 
    rel=tag>.net 3.0 windows update</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/animating+text/default.aspx" 
    rel=tag>animating text</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/ClearType/default.aspx" 
    rel=tag>ClearType</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/decorative+text/default.aspx" 
    rel=tag>decorative text</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/dot+net+solutions/default.aspx" 
    rel=tag>dot net solutions</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/flow+document/default.aspx" 
    rel=tag>flow document</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/formattedtext/default.aspx" 
    rel=tag>formattedtext</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/Indic+support/default.aspx" 
    rel=tag>Indic support</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/Lab/default.aspx" 
    rel=tag>Lab</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/languages/default.aspx" 
    rel=tag>languages</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/Mac/default.aspx" 
    rel=tag>Mac</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/microsoft+surface/default.aspx" 
    rel=tag>microsoft surface</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/text/archive/tags/MIX/default.aspx" 
    rel=tag>MIX</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/new+york+times/default.aspx" 
    rel=tag>new york times</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/outline+text/default.aspx" 
    rel=tag>outline text</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/pixel+snapping/default.aspx" 
    rel=tag>pixel snapping</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/Safari/default.aspx" 
    rel=tag>Safari</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/seema/default.aspx" 
    rel=tag>seema</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/text/archive/tags/silverlight/default.aspx" 
    rel=tag>silverlight</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/table/default.aspx" 
    rel=tag>table</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/text+rendering/default.aspx" 
    rel=tag>text rendering</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/Tim+Sneath+British+Library+WPF+apps/default.aspx" 
    rel=tag>Tim Sneath British Library WPF apps</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/text/archive/tags/times+reader/default.aspx" 
    rel=tag>times reader</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/TypeCon/default.aspx" 
    rel=tag>TypeCon</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/vista/default.aspx" 
    rel=tag>vista</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/wikipedia+explorer/default.aspx" 
    rel=tag>wikipedia explorer</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/text/archive/tags/wpf/default.aspx" 
    rel=tag>wpf</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/text/archive/tags/WPF+3.5/default.aspx" 
    rel=tag>WPF 3.5</A> </LI></UL></UL></DIV>
<DIV id=NewsSideBar></DIV>
<DIV id=ArchiveSideBar>
<H3>Archives</H3>
<UL>
  <LI><A href="http://blogs.msdn.com/text/archive/2007/09.aspx">September 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2007/08.aspx">August 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2007/06.aspx">June 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2007/05.aspx">May 2007 (3)</A> 

  <LI><A href="http://blogs.msdn.com/text/archive/2007/04.aspx">April 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2007/03.aspx">March 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2007/02.aspx">February 2007 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2007/01.aspx">January 2007 
  (3)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/11.aspx">November 2006 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/10.aspx">October 2006 
  (2)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/09.aspx">September 2006 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/08.aspx">August 2006 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/07.aspx">July 2006 
  (1)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/06.aspx">June 2006 
  (3)</A> 
  <LI><A href="http://blogs.msdn.com/text/archive/2006/05.aspx">May 2006 (3)</A> 

  <LI><A href="http://blogs.msdn.com/text/archive/2006/03.aspx">March 2006 
  (1)</A> </LI></UL></DIV>
<DIV id=LinkSideBar></DIV></DIV>
<DIV id=content>
<DIV id=content2>
<STYLE>.DoNotDisplay {
	DISPLAY: none
}
</STYLE>

<DIV class=post>
<DIV class=posthead>Sunday, May 07, 2006 2:34 AM <A 
id=ctl00___ctl00___ctl01___Entry___AuthorLink 
href="http://blogs.msdn.com/user/Profile.aspx?UserID=21668">text</A> 
<H2>MSDN TV Demo Part 1: Creating an OpenType menu in WPF </H2></DIV>
<DIV class=postcontent>
<P><FONT face=Verdana size=2><IMG 
src="WPF Text Blog  MSDN TV Demo Part 1 Creating an OpenType menu in WPF_files/TextBoxWithOpenTypeMenu.JPG"></FONT></P>
<P><FONT face=Verdana size=2>Hi, my name is Chris Han, I’m the program manager 
in Windows Presentation Foundation working on text and globalization.&nbsp; You 
might have seen our recent MSDN TV episode “Overview of text and flow layout in 
Windows Presentation Foundation” where I demonstrated a text box with a context 
menu which allows a user to turn on and off certain OpenType features.&nbsp; The 
code to achieve this is attached below.</FONT></P>
<P><FONT face=Verdana><FONT size=2>I want to point out a few parts of this code… 
let’s look at Page1.xaml first. &nbsp;Here we’re creating a RichTextBox and a 
ContextMenu to pop up whenever you right click on text (or left click if you’re 
left handed like me). &nbsp;<o:p></o:p></FONT></FONT></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">The interesting thing to note here 
is the value of the FontFamily property.&nbsp; We’re referencing a font file 
that’s actually embedded in the assembly of the application so your app is never 
dependent on whether your user has Pericles installed on his or her 
machine.&nbsp; If you set FontFamily=”Pericles”, then we would still look for it 
in the user’s Windows\Fonts directory and fallback to Segoe UI or Tahoma if it 
didn’t exist.&nbsp; <o:p></o:p></SPAN></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&lt;</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: maroon; FONT-FAMILY: 'Lucida Console'">RichTextBox</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;</SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">DockPanel.Dock</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">Top</SPAN>"<SPAN 
style="COLOR: blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Name</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">MyRichTextBox</SPAN>"<SPAN style="COLOR: blue"> 
<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">FontFamily</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">fonts/#Pericles</SPAN>"<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">FontSize</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">60pt</SPAN>"<SPAN style="COLOR: blue"> 
<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Foreground</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">White</SPAN>"<SPAN style="COLOR: blue"> 
<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Background</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">Black</SPAN>"<SPAN 
style="COLOR: blue">&gt;<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
&lt;</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: maroon; FONT-FAMILY: 'Lucida Console'">RichTextBox.ContextMenu</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&gt;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp; 
&lt;</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: maroon; FONT-FAMILY: 'Lucida Console'">ContextMenu</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'"> 
<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Name</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">FontMenu</SPAN>"<SPAN style="COLOR: blue"> 
<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Opened</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">ContextMenuOpen</SPAN>"<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Foreground</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">White</SPAN>"<SPAN style="COLOR: blue"> 
<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: red; FONT-FAMILY: 'Lucida Console'">Background</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">=</SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Lucida Console'">"<SPAN 
style="COLOR: blue">Black</SPAN>"<SPAN 
style="COLOR: blue">&gt;<o:p></o:p></SPAN></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
&lt;!--</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Lucida Console'"> Populated 
with C# </SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">--&gt;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp;&nbsp;&nbsp; 
&lt;/</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: maroon; FONT-FAMILY: 'Lucida Console'">ContextMenu</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&gt;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&nbsp; 
&lt;/</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: maroon; FONT-FAMILY: 'Lucida Console'">RichTextBox.ContextMenu</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&gt;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face=Verdana><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&lt;/</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: maroon; FONT-FAMILY: 'Lucida Console'">RichTextBox</SPAN><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'">&gt;</SPAN></FONT></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Lucida Console'"></SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Notice that in the Visual Studio 
project, the font files under ‘fonts’ folder have build action set to 
‘Resource’. &nbsp;Setting it to ‘Resource’ embeds these files in the assembly. 
&nbsp;You can make this work too by setting build action to ‘Content’ and Copy 
to Output to ‘Copy if newer’ which would keep the fonts as loose files in the 
directory that your application is deployed. &nbsp;&nbsp;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p><FONT face=Verdana 
size=2></FONT></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><FONT 
face=Verdana size=2></FONT></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">In 
Page1.xaml.cs there are two event handlers which enable this OpenType menu. 
&nbsp;In ContextMenuOpen, we’re creating new MenuItems on the fly to give the 
user a preview of what the text would look like if they applied a particular 
OpenType feature. &nbsp;In ContextMenuClick we’re actually applying the property 
to the selected text in MyRichTextBox.&nbsp; <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p><FONT face=Verdana 
size=2></FONT></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">The font 
you see is in the screenshot above is one of the many cool OpenType sample fonts 
<A title=http://ascendercorp.com/ href="http://ascendercorp.com/">Ascender 
Corp</A> created for our SDK.&nbsp; All of which you can download here 
today:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><A 
title=http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp 
href="http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp">http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp</A><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Check out 
some of features below. &nbsp;I only hooked up 3 of them in the code above. 
&nbsp;Note this is a sample font so there are some limitations. &nbsp;Most of 
Pericles’ features are only available on capital letters.</SPAN></P>
<P><FONT face=Verdana size=2><IMG 
src="WPF Text Blog  MSDN TV Demo Part 1 Creating an OpenType menu in WPF_files/pericles.JPG"></FONT></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Here are 
some relevant articles:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Packaging 
Fonts with Applications:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><A 
title=http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/db15ee48-4d24-49f5-8b9d-a64460865286.asp 
href="http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/db15ee48-4d24-49f5-8b9d-a64460865286.asp">http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/db15ee48-4d24-49f5-8b9d-a64460865286.asp</A><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">OpenType 
Font Features:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><A 
title=http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/4061a9d1-fe8b-4921-9e17-18ec7d2e3ea2.asp 
href="http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/4061a9d1-fe8b-4921-9e17-18ec7d2e3ea2.asp">http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/4061a9d1-fe8b-4921-9e17-18ec7d2e3ea2.asp</A><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN><SPAN lang=FR 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Sample Font 
Pack:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><A 
title=http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp 
href="http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp"><SPAN 
lang=FR 
title=http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp>http://windowssdk.msdn.microsoft.com/library/default.asp?url=/library/en-us/wpf_conceptual/html/56b46fa1-a44e-419b-8f14-25ad51c715c3.asp</SPAN></A></SPAN><SPAN 
lang=FR style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN lang=FR 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Look for my next blog post, <SPAN 
style="FONT-STYLE: italic">MSDN TV Demo Part 2&nbsp;: Painting your text 
foreground with an animating rotatable star sitting in 3-D space</SPAN> which 
will finish the stuff I went through in the MSDN TV segment. 
&nbsp;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><st1:PersonName w:st="on"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">Chris 
Han</SPAN></st1:PersonName><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN></P></DIV>
<DIV><SPAN id=ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel></SPAN><INPUT 
id=ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel_State type=hidden 
value=nochange 
name=ctl00$_$ctl00$_$ctl01$_$Entry$_$InlineTagEditorPanel></DIV><BR><B>Attachment(s): 
</B><A id=ctl00___ctl00___ctl01___Entry___Attachment___DownLoadLink 
href="http://blogs.msdn.com/text/attachment/545859.ashx">TextBoxWithOpenTypeMenu.zip</A> 
</DIV>
<DIV class=postfoot></DIV>
<DIV id=comments>
<H3>Comments </H3>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl01_PermaLink 
title=permalink 
href="http://blogs.msdn.com/text/archive/2006/05/07/545859.aspx#631137">#</A> 
Demos from the TechEd WPF Rich Content talk<A name=631137></A> </H4>
<DIV class=commentssubhead><SPAN class=commentspan></SPAN>Wednesday, June 14, 
2006 1:14 PM by <A id=ctl00___ctl00___ctl01___Comments___Comments_ctl01_NameLink 
title=TrackBack href="http://blogs.msdn.com/text/archive/2006/06/14/631136.aspx" 
target=_blank rel=nofollow>WPF Text Blog</A> </DIV>
<DIV class=commentsbody>I just gave a talk at TechEd in Boston on Creating Rich 
Content Experiences in WPF (DEV326), for those... </DIV></DIV>
<DIV class=comment>
<H4><A id=ctl00___ctl00___ctl01___Comments___Comments_ctl02_PermaLink 
title=permalink 
href="http://blogs.msdn.com/text/archive/2006/05/07/545859.aspx#4394658">#</A> 
re: MSDN TV Demo Part 1: Creating an OpenType menu in WPF <A 
name=4394658></A></H4>
<DIV class=commentssubhead><SPAN class=commentspan></SPAN>Tuesday, August 14, 
2007 11:55 PM by <A 
id=ctl00___ctl00___ctl01___Comments___Comments_ctl02_NameLink 
title=simonjohnroberts href="http://precisemixture.com/preview/Vroom.htm" 
target=_blank>simonjohnroberts</A> </DIV>
<DIV class=commentsbody>
<P>It is a real shame about the link Rot - I would have loved to try this 
out...</P></DIV></DIV></DIV><EM>Anonymous comments are disabled</EM> 
</DIV></DIV>
<DIV id=contentfooter>&nbsp;</DIV></DIV>
<DIV id=footer></DIV></DIV></DIV>
<SCRIPT language=javascript type=text/javascript>
<!--
function KeyDownHandlerctl00___ctl00___bs___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$bs$_$ws$_$SearchButton','')	}
}

//-->
</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/text/archive/2006/05/07/545859.aspx"
dc:identifier="http://blogs.msdn.com/text/archive/2006/05/07/545859.aspx"
dc:title="MSDN TV Demo Part 1: Creating an OpenType menu in WPF "
trackback:ping="http://blogs.msdn.com/text/trackback.aspx?PostID=545859" />
</rdf:RDF>
--></FORM></BODY></HTML>
