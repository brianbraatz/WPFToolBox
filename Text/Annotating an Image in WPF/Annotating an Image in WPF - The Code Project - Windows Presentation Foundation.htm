<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0057)http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp -->
<HTML><HEAD><TITLE>Annotating an Image in WPF - The Code Project - Windows Presentation Foundation</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="Demonstrates how to add text annotations to an Image element" 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Josh Smith" name=Author>
<META content="11 Sep 2007 14:00:00 GMT" name=Search.PublishDate>
<META content="11 Sep 2007 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, Article" 
name=keywords>
<META 
content="Article content copyright Josh Smith, 2007, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.3199" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4035&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Finnerworkings%5F728x90%2Egif&C=False&id=4035&cb=4804584\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,617,584 members and 
            growing! &nbsp; 7,311 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=3157962">My 
            Profile </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/WPF/AnnotatingAnImageInWPF.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=3157962">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/WPF/AnnotatingAnImageInWPF.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD noWrap><A href="http://www.codeproject.com/index.asp?cat=1">All 
            Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC/C++</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=4">ASP.NET</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A>, <A 
            href="http://www.codeproject.com/?cat=6">VB.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/WPF/">Windows Presentation 
            Foundation</A> &gt;&gt; <A 
            href="http://www.codeproject.com/WPF/#Annotations">Annotations</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Annotating an Image 
            in WPF</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=247684">Josh 
            Smith</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">Demonstrates how to add text 
            annotations to an Image element</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C# (C# 2.0), 
            XML<BR>Windows, .NET (.NET 3.0)<BR>Win32, VS (VS2005), XAML, 
            WPF<BR>Dev<BR><SPAN style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>12 
            Sep 2007</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>9,172</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN: 12px 3px 12px 0px" 
            height=12 alt="VS 2008" 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/VS2008_sm.gif" 
            width=20> <A 
            href="http://www.codeproject.com/Feature/VS2008/">Visual Studio 
            2008<BR>competition.<BR>$10,000 in prizes</A></DIV>
            <DIV style="PADDING-TOP: 3px"><IMG 
            style="MARGIN-LEFT: 2px; MARGIN-RIGHT: 5px" height=16 alt=Jobs 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/staff_sm.gif" 
            width=12 align=absMiddle> <A 
            href="http://www.codeproject.com/info/jobs/">http://www.codeproject.com/info/jobs/</A></DIV>
            <DIV style="PADDING-TOP: 3px"><IMG 
            style="MARGIN-LEFT: 2px; MARGIN-RIGHT: 5px" height=20 alt=Comp 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/prize_winner_sm.gif" 
            width=10 align=absMiddle> <A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4392&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FChangeSigExt%5F160x600%2Egif&C=False&id=4392&cb=4804595\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=AnnotatingAnImageInWPF%2Fuseritems9%2F12%2F2007">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2FWPF%2FAnnotatingAnImageInWPF%2Easp&amp;guid=AnnotatingAnImageInWPF%2Fuseritems9%2F12%2F2007">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=AnnotatingAnImageInWPF%2Fuseritems9%2F12%2F2007">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>23 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/red.gif" 
                              width=17 border=0><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/white.gif" 
                              width=3 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        6.63</A>. Rating: <B>4.87</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF/ImageAnnotationDemo.zip">Download 
              demo project - 96.8 KB</A> </LI></UL><IMG height=360 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ImageAnnotation_xray.png" 
            width=310> 
            <H2>Introduction</H2>
            <P>This article shows how to create text annotations over an image, 
            in a WPF application. The technique involves rendering a custom 
            control in the adorner layer of an <CODE>Image</CODE> element, 
            allowing for in-place editing of annotations. The classes used in 
            the demo application can be easily and freely used in other 
            applications to achieve the same functionality.</P>
            <H2>Background</H2>
            <P>When you read the newspaper and scribble a thought on the page, 
            you are creating an annotation. The term "annotation" refers to a 
            note which describes or explains part of another document. The 
            Windows Presentation Foundation has built-in support for document 
            annotations, as described <A 
            href="http://msdn2.microsoft.com/en-us/library/ms748864.aspx">here</A>. 
            It does not, however, provide out-of-the-box support for annotating 
            images.</P>
            <P>A while back I wrote <A 
            href="http://joshsmithonwpf.wordpress.com/2007/08/26/annotating-an-image-in-a-viewbox/">a 
            blog post</A> about how to annotate an <CODE>Image</CODE> element 
            which happens to reside in a <CODE>Viewbox</CODE>. This article 
            takes that idea and generalizes it so that any <CODE>Image</CODE> 
            can be annotated, not just one contained within a 
            <CODE>Viewbox</CODE>. Another improvement seen in this article's 
            demo application is that the annotations are created "in-place", as 
            opposed to typing the annotation text in a <CODE>TextBox</CODE> 
            somewhere else in the user interface.</P>
            <H2>The demo app</H2>
            <P>This article is accompanied by a demo application, available for 
            download at the top of this page. The demo app allows you to create 
            annotations on two images. It contains explanatory text about how to 
            create, modify, and delete annotations.</P>
            <P>Here is a screenshot of the demo application, after a few 
            annotations have been created:</P><IMG height=550 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ImageAnnotation_xray_big.png" 
            width=447> 
            <P>Notice the location of the various annotations, relative to 
            entities in the picture. After the Window is made smaller, you will 
            see that the annotations remain "pinned" to those entities:</P><IMG 
            height=360 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ImageAnnotation_xray.png" 
            width=310> 
            <P>Even though the dimensions of the <CODE>Image</CODE> element have 
            changed, the annotations remain in the same meaningful locations 
            over the picture. This is an important aspect of image annotations, 
            because the location of an annotation is just as meaningful as its 
            text.</P>
            <P>The demo app lets the user delete annotations in several ways. If 
            an annotation loses input focus and has no text, it is automatically 
            deleted. Also, aside from the glaringly obvious 'Delete Annotations' 
            button seen above, you can also delete an annotation by 
            right-clicking on it, to pull up a context menu. For 
            example:</P><IMG height=428 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ImageAnnotation_delete.png" 
            width=410> 
            <H2>Limitations</H2>
            <P>The demo app is not a "complete" solution. It does not provide 
            any means of persisting annotations across runs of the application. 
            I did not write annotation persistence code because there are so 
            many different ways that this functionality might be used, that 
            writing my own implementation seemed like a shot in the dark. I did, 
            however, try to write the classes in such a way that it will be 
            straightforward to implement saving and loading of annotations.</P>
            <P>The demo app also does not provide any fancy UI features like 
            drag-drop of annotations. That might be a useful feature, but I 
            wanted to keep this simple. Drag-drop in WPF is pretty well 
            documented on the Web, so if you need to add that feature you should 
            be able to find some good reference material out there.</P>
            <H2>How it works</H2>
            <P>There are four main participants involved, as seen below:</P><IMG 
            height=337 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ImageAnnotation_classes.png" 
            width=233> 
            <P>The <CODE>ImageAnnotationControl</CODE> is what you actually see 
            on the screen which displays, and allows you to edit, annotations. 
            <CODE>ImageAnnotationControl</CODE> is a <CODE>ContentControl</CODE> 
            which exposes one interesting public dependency property, called 
            <CODE>IsInEditMode</CODE>. When that property is <CODE><SPAN 
            class=cpp-keyword>true</SPAN></CODE>, a <CODE>DataTemplate</CODE> is 
            applied to the <CODE>ContentTemplate</CODE> property which renders 
            the annotation text in a <CODE>TextBox</CODE>. When 
            <CODE>IsInEditMode</CODE> is <CODE><SPAN 
            class=cpp-keyword>false</SPAN></CODE>, the annotation text is 
            rendered in a <CODE>TextBlock</CODE>. The complete XAML for 
            <CODE>ImageAnnotationControl</CODE> is seen below:</P><PRE lang=xml>&lt;ContentControl
  x:Class="ImageAnnotationDemo.ImageAnnotationControl"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="clr-namespace:ImageAnnotationDemo"
  x:Name="mainControl"
  &gt;
  &lt;ContentControl.Resources&gt;
    &lt;!-- The template used to create a TextBox 
         for the user to edit an annotation. --&gt;
    &lt;DataTemplate x:Key="EditModeTemplate"&gt;
      &lt;TextBox
        KeyDown="OnTextBoxKeyDown"
        Loaded="OnTextBoxLoaded"
        LostFocus="OnTextBoxLostFocus"
        Style="{DynamicResource STYLE_AnnotationEditor}"
        Text="{Binding         
                ElementName=mainControl, 
                Path=Content,
                UpdateSourceTrigger=PropertyChanged}"
        /&gt;
    &lt;/DataTemplate&gt;

    &lt;!-- The template used to create a TextBlock 
         for the user to read an annotation. --&gt;
    &lt;DataTemplate x:Key="DisplayModeTemplate"&gt;
      &lt;Border&gt;
        &lt;TextBlock
          MouseLeftButtonDown="OnTextBlockMouseLeftButtonDown"
          Style="{DynamicResource STYLE_Annotation}"
          Text="{Binding ElementName=mainControl, Path=Content}"
          &gt;
          &lt;TextBlock.ContextMenu&gt;
            &lt;ContextMenu&gt;
              &lt;MenuItem 
                Header="Delete" 
                Click="OnDeleteAnnotation"
                &gt;
                &lt;MenuItem.Icon&gt;
                  &lt;Image Source="delete.ico" /&gt;
                &lt;/MenuItem.Icon&gt;
              &lt;/MenuItem&gt;
            &lt;/ContextMenu&gt;
          &lt;/TextBlock.ContextMenu&gt;
        &lt;/TextBlock&gt;
      &lt;/Border&gt;
    &lt;/DataTemplate&gt;

    &lt;Style TargetType="{x:Type local:ImageAnnotationControl}"&gt;
      &lt;Style.Triggers&gt;
        &lt;!-- Applies the 'edit mode' template 
             to the Content property. --&gt;
        &lt;Trigger Property="IsInEditMode" Value="True"&gt;
          &lt;Setter
            Property="ContentTemplate" 
            Value="{StaticResource EditModeTemplate}" 
            /&gt;
        &lt;/Trigger&gt;

        &lt;!-- Applies the 'display mode' template 
             to the Content property. --&gt;
        &lt;Trigger Property="IsInEditMode" Value="False"&gt;
          &lt;Setter
            Property="ContentTemplate" 
            Value="{StaticResource DisplayModeTemplate}" 
            /&gt;
        &lt;/Trigger&gt;
      &lt;/Style.Triggers&gt;
    &lt;/Style&gt;
  &lt;/ContentControl.Resources&gt;
&lt;/ContentControl&gt;
</PRE>
            <P><CODE>ImageAnnotationAdorner</CODE> is an adorner which is 
            responsible for hosting an instance of 
            <CODE>ImageAnnotationControl</CODE>. It is added to the adorner 
            layer of the <CODE>Image</CODE> being annotated. 
            <CODE>ImageAnnotationAdorner</CODE> is created and positioned by the 
            <CODE>ImageAnnotation</CODE> class. That class has no visual 
            representation, but simply serves as a handle to an annotation for 
            the consumer (i.e. the demo app's main <CODE>Window</CODE>).</P>
            <P>When an <CODE>ImageAnnotation</CODE> is created, it installs an 
            adorner in the annotated <CODE>Image</CODE>'s adorner layer, as seen 
            below:</P><PRE lang=cs>void InstallAdorner()
{
    if (_isDeleted)
        return;

    _adornerLayer = AdornerLayer.GetAdornerLayer(_image);

    _adornerLayer.Add(_adorner);
}
</PRE>
            <P>When the <CODE>Image</CODE> element is resized and an annotation 
            must be moved to its new location, these methods in 
            <CODE>ImageAnnotation</CODE> are invoked:</P><PRE lang=cs>void OnImageSizeChanged(object sender, SizeChangedEventArgs e)
{
    Point newLocation = this.CalculateEquivalentTextLocation();
    _adorner.UpdateTextLocation(newLocation);
}

Point CalculateEquivalentTextLocation()
{
    double x = _image.RenderSize.Width * _horizPercent;
    double y = _image.RenderSize.Height * _vertPercent;
    return new Point(x, y);
}
</PRE>
            <P>The <CODE>_horizPercent</CODE> and <CODE>_vertPercent</CODE> 
            fields represent the relative location of an annotation over an 
            picture. Those values are calculated in the 
            <CODE>ImageAnnotation</CODE> constructor, as seen below:</P><PRE lang=cs>private ImageAnnotation(
 Point textLocation, Image image, 
 Style annontationStyle, Style annotationEditorStyle)
{
    if (image == null)
        throw new ArgumentNullException(<SPAN class=cpp-string>"image"</SPAN>);

    _image = image;
    this.HookImageEvents(true);

    Size imageSize = _image.RenderSize;
    if (imageSize.Height == 0 || imageSize.Width == 0)
        throw new ArgumentException(<SPAN class=cpp-string>"image has invalid dimensions"</SPAN>);

<STRONG>    <SPAN class=cs-comment>// Determine the relative location of the TextBlock.</SPAN>
    _horizPercent = textLocation.X / imageSize.Width;
    _vertPercent = textLocation.Y / imageSize.Height;</STRONG>

    <SPAN class=cs-comment>// Create the adorner which displays the annotation.</SPAN>
    _adorner = new ImageAnnotationAdorner(
       this, 
       _image, 
       annontationStyle, 
       annotationEditorStyle, 
       textLocation);

    this.InstallAdorner();
}
</PRE>
            <P>The <CODE>Window</CODE> in the demo app asks 
            <CODE>ImageAnnotation</CODE> to create instances of itself when the 
            user clicks on an <CODE>Image</CODE>. In addition to informing the 
            annotation where it should exist over the <CODE>Image</CODE>, it 
            also specifies two <CODE>Style</CODE>s for the 
            <CODE>ImageAnnotationControl</CODE>, as seen below:</P><PRE lang=cs>void image_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    Image image = sender as Image;

    <SPAN class=cs-comment>// Get the location of the mouse cursor relative to the Image. Offset the</SPAN>
    <SPAN class=cs-comment>// location a bit so that the annotation placement feels more natural.</SPAN>
    Point textLocation = e.GetPosition(image);
    textLocation.Offset(-4, -4);

    <SPAN class=cs-comment>// Get the Style applied to the annotation's TextBlock.</SPAN>
    Style annotationStyle = base.FindResource(<SPAN class=cpp-string>"AnnotationStyle"</SPAN>) as Style;

    <SPAN class=cs-comment>// Get the Style applied to the annotations's TextBox.</SPAN>
    Style annotationEdtiorStyle =
       base.FindResource(<SPAN class=cpp-string>"AnnotationEditorStyle"</SPAN>) as Style;

    <SPAN class=cs-comment>// Create an annotationwhere the mouse cursor is located.</SPAN>
    ImageAnnotation imgAnn = ImageAnnotation.Create(
       image,
       textLocation,
       annotationStyle,
       annotationEdtiorStyle);

    this.CurrentAnnotations.Add(imgAnn);
}</PRE>
            <P>Those two <CODE>Style</CODE> objects allow the annotation 
            consumer to specify how annotations should be rendered, both when in 
            edit mode and display mode. The demo app's <CODE>Style</CODE>s, 
            which exist in the main <CODE>Window</CODE>'s resources, are seen 
            below:</P><PRE lang=xml>&lt;!-- This is the Style applied to the TextBlock within 
     an ImageAnnotationControl. --&gt;
&lt;Style x:Key="AnnotationStyle" TargetType="TextBlock"&gt;
  &lt;Setter Property="Background" Value="#AAFFFFFF" /&gt;
  &lt;Setter Property="FontWeight" Value="Bold" /&gt;      
  &lt;Style.Triggers&gt;
    &lt;Trigger Property="IsMouseOver" Value="True"&gt;
      &lt;Setter Property="Background" Value="#CCFFFFFF" /&gt;
    &lt;/Trigger&gt;
  &lt;/Style.Triggers&gt;
&lt;/Style&gt;

&lt;!-- This is the Style applied to the TextBox within 
     an ImageAnnotationControl. --&gt;
&lt;Style x:Key="AnnotationEditorStyle" TargetType="TextBox"&gt;
  &lt;Setter Property="Background" Value="#FFFFFFFF" /&gt;
  &lt;Setter Property="BorderThickness" Value="0" /&gt;
  &lt;Setter Property="FontWeight" Value="Bold" /&gt;
  &lt;Setter Property="Padding" Value="-2,0,-1,0" /&gt;
&lt;/Style&gt;</PRE>
            <H2>Revision history</H2>
            <UL>
              <LI>September 12, 2007  Created the article </LI></UL><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Josh Smith</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/{EF92FA80-F3E4-4989-9865-F9A3EE88CDAD}.jpg"><BR></TD>
                <TD class=smallText>Josh creates software. C# and XAML are his 
                  preferred modes of expression. <BR><BR>He is currently working 
                  for the New York Times on the <I>Times Reader</I> 
                  application.<BR><BR>He also plays the music of J.S. Bach on 
                  the piano. <BR><BR>Most of all, he loves being with his 
                  wonderful girlfriend.<BR><BR>Download his WPF.JoshSmith 
                  library <A 
                  href="http://www.codeproject.com/useritems/WPFJoshSmith.asp" 
                  rel=nofollow>here</A>[<A title="New Window" 
                  href="http://www.codeproject.com/useritems/WPFJoshSmith.asp" 
                  target=_blank rel=nofollow>^</A>]<BR><BR>You can check out his 
                  WPF blog <A href="http://joshsmithonwpf.wordpress.com/" 
                  rel=nofollow>here</A>[<A title="New Window" 
                  href="http://joshsmithonwpf.wordpress.com/" target=_blank 
                  rel=nofollow>^</A>].<BR><BR>You can take his guided tour of 
                  WPF <A 
                  href="http://joshsmithonwpf.wordpress.com/a-guided-tour-of-wpf/" 
                  rel=nofollow>here</A>[<A title="New Window" 
                  href="http://joshsmithonwpf.wordpress.com/a-guided-tour-of-wpf/" 
                  target=_blank rel=nofollow>^</A>].<BR><BR>His Microsoft MVP 
                  profile can be viewed <A 
                  href="https://mvp.support.microsoft.com/profile=5F7EC527-FEBC-4A5D-A11F-EEF73467D3D5" 
                  rel=nofollow>here</A>[<A title="New Window" 
                  href="https://mvp.support.microsoft.com/profile=5F7EC527-FEBC-4A5D-A11F-EEF73467D3D5" 
                  target=_blank rel=nofollow>^</A>].
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=247684">here</A> 
                  to view Josh Smith's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular Windows Presentation Foundation 
                  articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/WPF/TheWpfThoughtProcess.asp">The 
                    WPF Thought Process</A>
                    <DIV class=smallText>An introspective journey of solving 
                    problems using WPF</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/WPF/SkinningInWPF.asp">Creating 
                    a Skinned User Interface in WPF</A>
                    <DIV class=smallText>Reviews the basics of creating a WPF 
                    user interface with various visual styles.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/useritems/FlashvsWPF.asp">Comparing 
                    Flash and WPF</A>
                    <DIV class=smallText>Comparing Flash and WPF</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/WPF/AdvancedCustomTreeViewLyt.asp">Advanced 
                    Custom TreeView Layout in WPF</A>
                    <DIV class=smallText>Reviews an advanced layout 
                    customization for the WPF TreeView.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4306&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FIronSpeed%5F300x250%5F5%2Egif&C=False&id=4306&cb=4804605\" alt=\"\" border=0 width=300 height=250></a>");</SCRIPT>
                </TD></TR></TBODY></TABLE><BR>
            <SCRIPT language=JavaScript 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/addto.js" 
            type=text/javascript></SCRIPT>

            <SCRIPT language=JavaScript type=text/javascript>
var addtoMethod=1;
var AddURL = document.location.href;
var AddTitle = escape(document.title);
DrawLinks(100, 0, "smallText", "addto") 
</SCRIPT>
            <BR><BR>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden 
            value=AnnotatingAnImageInWPF/useritems9/12/2007 name=vote_name> 
            <INPUT type=hidden value=/WPF/AnnotatingAnImageInWPF.asp name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <DIV style="MARGIN: 10px"><SPAN id=AdBanner5>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=3025&cb=4804589\" border=0 frameborder=0 scrolling=no width=468 height=60></IFRAME>");</SCRIPT>
            </SPAN></DIV></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=458910"><IMG 
                              height=15 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION 
                              value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 17 of 17 (Total: 
                              17) (<A 
                              href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2238577_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2238577xx></A><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2238577#xx2238577xx" 
                                name=2238577><B>Who's the daddy.</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=213147"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>Pete 
                                O'Hanlon</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>10:45 21 Sep 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2238577_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Josh - 
                                is your life just one long round of apartment 
                                hunting and WPF articles? I assume that you take 
                                sustenance from the air because you obviously 
                                don't need (or have time) to eat.<BR><BR>5 vote 
                                as usual my man. <BR><BR>
                                <DIV class=ForumSig><SMALL>Deja View - the 
                                feeling that you've seen this post 
                                before.<BR></I></SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2238577">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2238577">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2238577&amp;forumid=458910&amp;select=2238577#xx2238577xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2238577#xx2238577xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2238577#xx2238577xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(213147,2238577);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2238612_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2238612xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2238612#xx2238612xx" 
                                name=2238612>Re: Who's the daddy.</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000">Josh 
                                Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000">10:57 21 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2238612_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                Pete! I actually do eat. I enjoy barbecued XAML, 
                                roasted leg of Vector, and a glass of ice cold 
                                BAML fresh from a resource stream. <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_rolleyes.gif" 
                                align=absMiddle>
                                <DIV class=CPhogPost 
                                style="DISPLAY: none"></DIV><BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2238612">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2238612">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2238577&amp;forumid=458910&amp;select=2238612#xx2238612xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2238612#xx2238612xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2238577#xx2238577xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2238612);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2232455_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2232455xx></A><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2232455#xx2232455xx" 
                                name=2232455><B>Hey, does this sample use 
                                AJAX?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=713790"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>ntense99</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>9:23 18 Sep 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2232455_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>HAHA 
                                hey, just kidding Josh! It's me, Tom P from IG! 
                                Do you recall the good old days in support? HA, 
                                Great to see you again! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2232455">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2232455">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2232455&amp;forumid=458910&amp;select=2232455#xx2232455xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2232455#xx2232455xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2232455#xx2232455xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(713790,2232455);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2232469_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2232469xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2232469#xx2232469xx" 
                                name=2232469>Re: Hey, does this sample use 
                                AJAX?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:28 18 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2232469_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_laugh.gif" 
                                align=absMiddle> When I read the title of your 
                                post my jaw dropped! <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_laugh.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2232469">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2232469">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2232455&amp;forumid=458910&amp;select=2232469#xx2232469xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2232469#xx2232469xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2232455#xx2232455xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2232469);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2226906_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2226906xx></A><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2226906#xx2226906xx" 
                                name=2226906><B>Nice job</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1566020"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>Patrick 
                                Sears</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>20:47 13 Sep 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2226906_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Got my 
                                5. I like how you took Christian's problem and 
                                ran with it and created something quite reusable 
                                as a result.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226906">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226906">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2226906&amp;forumid=458910&amp;select=2226906#xx2226906xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2226906#xx2226906xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2226906#xx2226906xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(1566020,2226906);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2226964_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2226964xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2226964#xx2226964xx" 
                                name=2226964>Re: Nice job</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>22:37 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2226964_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                Patrick. The problem Christian posed really 
                                piqued my interest. Generalizing a solution for 
                                a specific problem, so that it can be reused, is 
                                always an interesting challenge. <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226964">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226964">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2226906&amp;forumid=458910&amp;select=2226964#xx2226964xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2226964#xx2226964xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2226906#xx2226906xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2226964);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2225452_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225452xx></A><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225452#xx2225452xx" 
                                name=2225452><B>System.TypeLoadException 
                                [modified]</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=38594"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Daniel 
                                Strigl</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>4:31 13 
                                Sep 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225452_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Josh!<BR><BR>When I run your sample code and 
                                click on the image I receive the following 
                                exception:<BR><BR>An unhandled exception of type 
                                'System.TypeLoadException' occurred in 
                                PresentationFramework.dll<BR><BR>The problem 
                                occurs on line 125 in file 
                                ImageAnnotationControl.xaml.cs.<BR><BR>I am 
                                using VS2005, running on Windows XP 
                                Pro.<BR><BR>Do you have any idea what's the 
                                problem? <BR><BR>
                                <DIV 
                                class=ForumSig>Regards,<BR>Daniel.<BR>--<BR><B>F<SMALL>IND</SMALL> 
                                A J<SMALL>OB</SMALL> Y<SMALL>OU</SMALL> 
                                L<SMALL>OVE</SMALL>, A<SMALL>ND</SMALL> 
                                Y<SMALL>OU'LL</SMALL> N<SMALL>EVER</SMALL> 
                                H<SMALL>AVE</SMALL> T<SMALL>O</SMALL> 
                                W<SMALL>ORK</SMALL> A D<SMALL>AY</SMALL> 
                                O<SMALL>F</SMALL> Y<SMALL>OUR</SMALL> 
                                L<SMALL>IFE</SMALL>.</B> <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_wink.gif" 
                                align=absMiddle></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225452">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225452">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2225452#xx2225452xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(38594,2225452);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2225805_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225805xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225805#xx2225805xx" 
                                name=2225805>Re: 
                                System.TypeLoadException</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7:40 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225805_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>That's 
                                odd. I built and tested the demo project on 
                                Windows XP and VS2005. Do you have the release 
                                version of .NET 3.0 installed (not a beta 
                                build)? Do you perhaps have a beta of .NET 3.5? 
                                Can you find out what type is trying to be 
                                loaded when the exception is thrown, from the 
                                exception's Message or InnerException? <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225805">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225805">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2225805#xx2225805xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225805#xx2225805xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2225805);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2225874_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225874xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=36><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225874#xx2225874xx" 
                                name=2225874>Re: 
                                System.TypeLoadException</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=38594"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Daniel 
                                Strigl&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:09 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225874_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=36><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I have 
                                only installed .NET 3.0 (when I look in my 
                                directory C:\WINDOWS\Microsoft.NET\Framework 
                                there is only a folder v1.0.3705, v1.1.4322, 
                                v2.0.50727 and v3.0).<BR><BR>Here the exception 
                                (sorry, parts of the message are in 
                                German):<BR><BR>An unhandled exception of type 
                                'System.TypeLoadException' occurred in 
                                PresentationFramework.dll<BR><BR>Additional 
                                information: Die Methode GetEmbedd%d im Typ 
                                System.Windows.Documents.TextStore der Assembly 
                                PresentationFramework, Version=3.0.0.0, 
                                Culture=neutral, PublicKeyToken=31bf3856ad364e35 
                                hat keine Implementierung.<BR><BR>I think in 
                                English it's:<BR><BR>Additional information: The 
                                method GetEmbedd%d in type 
                                System.Windows.Documents.TextStore of assembly 
                                PresentationFramework, Version=3.0.0.0, 
                                Culture=neutral, PublicKeyToken=31bf3856ad364e35 
                                has no implementation. <BR><BR>
                                <DIV 
                                class=ForumSig>Regards,<BR>Daniel.<BR>--<BR><B>F<SMALL>IND</SMALL> 
                                A J<SMALL>OB</SMALL> Y<SMALL>OU</SMALL> 
                                L<SMALL>OVE</SMALL>, A<SMALL>ND</SMALL> 
                                Y<SMALL>OU'LL</SMALL> N<SMALL>EVER</SMALL> 
                                H<SMALL>AVE</SMALL> T<SMALL>O</SMALL> 
                                W<SMALL>ORK</SMALL> A D<SMALL>AY</SMALL> 
                                O<SMALL>F</SMALL> Y<SMALL>OUR</SMALL> 
                                L<SMALL>IFE</SMALL>.</B> <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_wink.gif" 
                                align=absMiddle></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225874">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225874">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2225874#xx2225874xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225874#xx2225874xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(38594,2225874);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2225899_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225899xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=54><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225899#xx2225899xx" 
                                name=2225899>Re: 
                                System.TypeLoadException</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:24 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225899_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=54><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_confused.gif" 
                                align=absMiddle> That is very strange. The line 
                                of code where the exception is thrown just calls 
                                <CODE>Focus()</CODE> on a TextBox. I have no 
                                idea why that would result in this exception. I 
                                wish I could help you resolve this, but since I 
                                can't reproduce the error I don't know where to 
                                start. If I come across anything that might 
                                help, I'll send it your way.<BR><BR>Thanks again 
                                for the feedback. <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225899">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225899">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2225899#xx2225899xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225899#xx2225899xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2225899);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2225928_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225928xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225928#xx2225928xx" 
                                name=2225928>Re: 
                                System.TypeLoadException</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:35 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225928_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                posted a <A 
                                href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2135589&amp;SiteID=1&amp;mode=1">question</A>[<A 
                                title="New Window" 
                                href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2135589&amp;SiteID=1&amp;mode=1" 
                                target=_blank>^</A>] about this error on the WPF 
                                Forum, so hopefully someone might have a 
                                solution for us. I'll keep you posted. <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225928">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225928">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2225928#xx2225928xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225928#xx2225928xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2225928);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2226551_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2226551xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2226551#xx2226551xx" 
                                name=2226551>Re: 
                                System.TypeLoadException</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=38594"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Daniel 
                                Strigl&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>14:07 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2226551_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>A 
                                reinstall of the .NET 3.0 Framework solved the 
                                problem! <BR><BR>
                                <DIV 
                                class=ForumSig>Regards,<BR>Daniel.<BR>--<BR><B>F<SMALL>IND</SMALL> 
                                A J<SMALL>OB</SMALL> Y<SMALL>OU</SMALL> 
                                L<SMALL>OVE</SMALL>, A<SMALL>ND</SMALL> 
                                Y<SMALL>OU'LL</SMALL> N<SMALL>EVER</SMALL> 
                                H<SMALL>AVE</SMALL> T<SMALL>O</SMALL> 
                                W<SMALL>ORK</SMALL> A D<SMALL>AY</SMALL> 
                                O<SMALL>F</SMALL> Y<SMALL>OUR</SMALL> 
                                L<SMALL>IFE</SMALL>.</B> <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_wink.gif" 
                                align=absMiddle></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226551">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226551">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2226551#xx2226551xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2226551#xx2226551xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(38594,2226551);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2226552_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2226552xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=36><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2226552#xx2226552xx" 
                                name=2226552>Re: 
                                System.TypeLoadException</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>14:11 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2226552_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=36><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>Daniel Strigl wrote:</DIV>A 
                                reinstall of the .NET 3.0 Framework solved the 
                                problem! </BLOCKQUOTE><BR><BR>Great! Thanks for 
                                letting me know. Enjoy WPF! <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226552">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2226552">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225452&amp;forumid=458910&amp;select=2226552#xx2226552xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2226552#xx2226552xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225452#xx2225452xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2226552);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2225412_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225412xx></A><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225412#xx2225412xx" 
                                name=2225412><B>See I knew youd find more to 
                                write about</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=569009"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>Sacha 
                                Barber</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>3:57 13 Sep 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225412_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Excellent as usual 500 
                                Stars if I could <BR><BR>
                                <DIV class=ForumSig><B>Sacha Barber</B><BR>A 
                                Modern Geek - I cook, I clean, I drink, I 
                                Program. Modern or what?<BR><BR><B>My Blog : <A 
                                href="http://sachabarber.net/" 
                                target=_blank>sachabarber.net</A></B></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225412">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225412">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225412&amp;forumid=458910&amp;select=2225412#xx2225412xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225412#xx2225412xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225412#xx2225412xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(569009,2225412);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2225798_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225798xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225798#xx2225798xx" 
                                name=2225798>Re: See I knew youd find more to 
                                write about</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7:37 13 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225798_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                Sacha. <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_cool.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225798">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225798">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2225412&amp;forumid=458910&amp;select=2225798#xx2225798xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225798#xx2225798xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225412#xx2225412xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2225798);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2224989_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2224989xx></A><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2224989#xx2224989xx" 
                                name=2224989><B>Who's The Man - 
                                Again</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=271234"><IMG 
                                title="Click for User Profile" height=15 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>Karl_Shifflett</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>18:24 12 Sep 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2224989_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Josh,<BR><BR>Nice job! Love 
                                the Darf Vader profile, x-ray.<BR><BR>Been gone 
                                for 3 weeks, just getting back to 
                                work.<BR><BR>The game is going real well 
                                also.<BR><BR>We allow users to attach an image 
                                or document to any record in our WPF product. 
                                This annotation teaching is a great idea for our 
                                product. Can probably store the annotations in 
                                the same row as the image as 
                                .xml.<BR><BR><BR><BR>
                                <DIV class=ForumSig>Cheers, Karl<BR><BR><FONT 
                                color=#c0943f>Just a grain of sand on the worlds 
                                beaches.</FONT></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2224989">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2224989">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2224989&amp;forumid=458910&amp;select=2224989#xx2224989xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2224989#xx2224989xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2224989#xx2224989xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(271234,2224989);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2225001_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2225001xx></A><IMG 
                                height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;forumid=458910&amp;select=2225001#xx2225001xx" 
                                name=2225001>Re: Who's The Man - Again</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=247684"><IMG 
                                title="CodeProject MVP" height=16 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/MVP_sm.gif" 
                                width=16 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Josh Smith&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>18:44 12 Sep 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2225001_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/ind.gif" 
                                width=18><IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hey 
                                Karl,<BR><BR>Thanks a lot! <BR><BR>I'm glad 
                                someone already found a use for this code. That 
                                was quick! <IMG 
                                src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>:josh:<BR><A 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                rel=nofollow>My WPF Blog</A>[<A 
                                title="New Window" 
                                href="http://joshsmithonwpf.wordpress.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR><SMALL>Without a strive 
                                for perfection I would be terribly 
                                bored.</SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225001">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/WPF/AnnotatingAnImageInWPF.asp&amp;df=100&amp;forumid=458910&amp;select=2225001">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?df=100&amp;tid=2224989&amp;forumid=458910&amp;select=2225001#xx2225001xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2225001#xx2225001xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/WPF/AnnotatingAnImageInWPF.asp?msg=2224989#xx2224989xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(247684,2225001);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 11:40 Saturday 
                              20th October, 2007</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 12 Sep 2007 </TD>
                <TD class=SmallText align=right>Article content copyright Josh 
                  Smith, 2007<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web11 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Annotating an Image in WPF - The Code Project - Windows Presentation Foundation_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
