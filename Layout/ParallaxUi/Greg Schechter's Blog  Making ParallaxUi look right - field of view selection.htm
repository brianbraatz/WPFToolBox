<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0113)http://blogs.msdn.com/greg_schechter/archive/2007/04/15/making-parallaxui-look-right-field-of-view-selection.aspx -->
<HTML lang=en xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:o = 
"urn:schemas-microsoft-com:office:office"><HEAD><TITLE>Greg Schechter's Blog : Making ParallaxUi look right - field of view selection</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META content=WPF name=keywords>
<META 
content="In my last post , I said that &quot;one of the more subtle aspects of the otherwise pretty straightforward ParallaxUi is the ‘registration' between the 2D and the 3D&quot;, and proceeded to discuss how this is done. This amounted to figuring out how far back to" 
name=description>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR><LINK 
href="http://blogs.msdn.com/greg_schechter/pingback.aspx" rel=pingback><LINK 
media=screen 
href="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/style.css" 
type=text/css rel=stylesheet><LINK media=print 
href="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/print.css" 
type=text/css rel=stylesheet><LINK media=screen 
href="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/brown.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel="shortcut icon"><LINK title="Greg Schechter's Blog (RSS 2.0)" 
href="http://blogs.msdn.com/greg_schechter/rss.xml" type=application/rss+xml 
rel=alternate><LINK title="Greg Schechter's Blog (Atom 1.0)" 
href="http://blogs.msdn.com/greg_schechter/atom.xml" type=application/atom+xml 
rel=alternate><LINK 
title="Making ParallaxUi look right - field of view selection Comment RSS (RSS 2.0)" 
href="http://blogs.msdn.com/greg_schechter/commentrss.aspx?PostID=2146970" 
type=application/rss+xml rel=alternate>
<SCRIPT 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/global.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<FORM id=aspnetForm name=aspnetForm 
action=/greg_schechter/archive/2007/04/15/making-parallaxui-look-right-field-of-view-selection.aspx 
method=post>
<DIV><INPUT id=__EVENTTARGET type=hidden name=__EVENTTARGET> <INPUT 
id=__EVENTARGUMENT type=hidden name=__EVENTARGUMENT> <INPUT id=__VIEWSTATE 
type=hidden 
value=/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFJGN0bDAwJF8kY3RsMDAkXyRiczEkXyR3cyRfJFNlYXJjaEJveK+MuGaxoZvO4xI7byA887OvUqUR 
name=__VIEWSTATE> </DIV>
<SCRIPT type=text/javascript>
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</SCRIPT>

<SCRIPT language=javascript 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/Telligent_Modal.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript type=text/javascript>
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</SCRIPT>

<DIV id=masthead>
<DIV id=welcome align=right>Welcome to MSDN Blogs <A 
id=ctl00___ctl00___duw1_ac1___Login 
href="http://blogs.msdn.com/login.aspx?ReturnUrl=%2fgreg_schechter%2farchive%2f2007%2f04%2f15%2fmaking-parallaxui-look-right-field-of-view-selection.aspx">Sign 
in</A> | <A id=ctl00___ctl00___duw1_ac1___Register 
href="http://blogs.msdn.com/user/CreateUser.aspx?ReturnUrl=/greg_schechter/archive/2007/04/15/making-parallaxui-look-right-field-of-view-selection.aspx">Join</A> 
| <A id=ctl00___ctl00___duw1_Faq1 
href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</A> </DIV></DIV>
<DIV id=wrapper>
<DIV id=container>
<DIV id=header>
<DIV id=title>
<H1><A class=headermaintitle id=ctl00___ctl00___bth___BlogTitle 
href="http://blogs.msdn.com/greg_schechter/default.aspx">Greg Schechter's 
Blog</A></H1>
<P id=tagline><A href="http://msdn.microsoft.com/windowsvista">Windows Vista</A> 
and <A 
href="http://msdn.microsoft.com/Longhorn/understanding/pillars/avalon/default.aspx">Windows 
Presentation Foundation (Avalon)</A> -- Graphics, Media, Animation, Programming 
Model and other goodies.</P></DIV></DIV>
<DIV id=contentwrapper>
<DIV id=sidebar-a>
<DIV id=BlogLinksSideBar>
<DIV id=WeblogLinks>
<H3>This Blog</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs1___wl___Contactlink1 
  href="http://blogs.msdn.com/greg_schechter/contact.aspx">Email</A> 
</LI></UL></DIV></DIV>
<DIV id=TasksSideBar></DIV>
<DIV id=SubscriptionsSideBar>
<DIV id=Subscriptions>
<H3>Syndication</H3>
<UL>
  <LI><A id=ctl00___ctl00___bs1___bs___rss 
  href="http://blogs.msdn.com/greg_schechter/rss.xml">RSS 2.0</A> 
  <LI><A id=ctl00___ctl00___bs1___bs___atom 
  href="http://blogs.msdn.com/greg_schechter/atom.xml">Atom 1.0</A> 
</LI></UL></DIV></DIV>
<DIV id=SearchSideBar>
<DIV id=Search>
<H3>Search</H3>
<UL>
  <LI><INPUT class=searchBox id=ctl00___ctl00___bs1___ws___SearchBox 
  onkeydown=KeyDownHandlerctl00___ctl00___bs1___ws___SearchButton(event); 
  name=ctl00$_$ctl00$_$bs1$_$ws$_$SearchBox> <A 
  id=ctl00___ctl00___bs1___ws___SearchButton 
  href="javascript:__doPostBack('ctl00$_$ctl00$_$bs1$_$ws$_$SearchButton','')">Go</A> 
  </LI></UL></DIV></DIV>
<DIV id=NewsSideBar></DIV>
<DIV id=LinkSideBar></DIV></DIV>
<DIV id=sidebar-b>
<DIV id=TagSideBar>
<H3>Tags</H3>
<UL>
  <UL class=SidebarTagCloud>
    <LI class=Tag4><A 
    href="http://blogs.msdn.com/greg_schechter/archive/tags/DWM/default.aspx" 
    rel=tag>DWM</A> 
    <LI class=Tag6><A 
    href="http://blogs.msdn.com/greg_schechter/archive/tags/Silverlight/default.aspx" 
    rel=tag>Silverlight</A> 
    <LI class=Tag1><A 
    href="http://blogs.msdn.com/greg_schechter/archive/tags/WPF/default.aspx" 
    rel=tag>WPF</A> </LI></UL></UL></DIV>
<DIV id=RecentPostsSideBar>
<H3>Recent Posts</H3>
<UL>
  <LI><A id=ctl00___ctl00___rp___PostList_ctl01_Link 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/09/26/making-use-of-multiprocessing-in-wpf.aspx">Making 
  use of multiprocessing in WPF</A> 
  <LI><A id=ctl00___ctl00___rp___PostList_ctl02_Link 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/08/21/silverlight-1-1-virtualearth-viewer.aspx">Silverlight 
  1.1 VirtualEarth Viewer</A> 
  <LI><A id=ctl00___ctl00___rp___PostList_ctl03_Link 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/05/19/wpf-silverlight-and-c-3-0-object-initializers.aspx">WPF, 
  Silverlight and C# 3.0 object initializers</A> 
  <LI><A id=ctl00___ctl00___rp___PostList_ctl04_Link 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/04/15/making-parallaxui-look-right-field-of-view-selection.aspx">Making 
  ParallaxUi look right - field of view selection</A> 
  <LI><A id=ctl00___ctl00___rp___PostList_ctl05_Link 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/04/03/camera-construction-in-parallaxui.aspx">Camera 
  construction in ParallaxUi</A> </LI></UL></DIV>
<DIV id=ArchiveSideBar>
<H3>Archives</H3>
<UL>
  <LI><A 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/09.aspx">September 
  2007 (1)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2007/08.aspx">August 
  2007 (1)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2007/05.aspx">May 
  2007 (1)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2007/04.aspx">April 
  2007 (3)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2007/03.aspx">March 
  2007 (1)</A> 
  <LI><A 
  href="http://blogs.msdn.com/greg_schechter/archive/2007/01.aspx">January 2007 
  (1)</A> 
  <LI><A 
  href="http://blogs.msdn.com/greg_schechter/archive/2006/10.aspx">October 2006 
  (1)</A> 
  <LI><A 
  href="http://blogs.msdn.com/greg_schechter/archive/2006/09.aspx">September 
  2006 (3)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2006/08.aspx">August 
  2006 (1)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2006/06.aspx">June 
  2006 (1)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2006/05.aspx">May 
  2006 (2)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2006/04.aspx">April 
  2006 (2)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2006/03.aspx">March 
  2006 (5)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2005/06.aspx">June 
  2005 (1)</A> 
  <LI><A href="http://blogs.msdn.com/greg_schechter/archive/2004/05.aspx">May 
  2004 (4)</A> 
  <LI><A 
  href="http://blogs.msdn.com/greg_schechter/archive/2003/12.aspx">December 2003 
  (3)</A> </LI></UL></DIV></DIV>
<DIV id=content>
<DIV id=content2><BR>
<DIV class=post>
<DIV class=postsub>
<H2>Making ParallaxUi look right - field of view selection</H2>&nbsp; 
<P>In my <A class="" 
href="http://blogs.msdn.com/greg_schechter/archive/2007/04/03/camera-construction-in-parallaxui.aspx" 
mce_href="http://blogs.msdn.com/greg_schechter/archive/2007/04/03/camera-construction-in-parallaxui.aspx">last 
post</A>, I said that "one of the more subtle aspects of the otherwise pretty 
straightforward <A 
href="http://blogs.msdn.com/greg_schechter/archive/2007/03/30/parallaxui_5F00_escaping_5F00_flatland.aspx">ParallaxUi</A>&nbsp;is 
the ‘registration' between the 2D and the 3D", and proceeded to discuss how this 
is done.&nbsp; This amounted to figuring out how far back to place our camera 
based on a given Field of View (FOV).&nbsp; </P>
<P>The other subtle aspect of ParallaxUi is how we actually choose that FOV for 
the camera.&nbsp; It's not as simple as just choosing a single FOV to use 
throughout all interactions.&nbsp; </P>
<P>We know from experience that when a camera is close to a set of subjects, the 
depth differences between those subjects is much more apparent than when the 
camera is far away from the subjects.&nbsp; And when the camera is at infinity, 
everything appears to be in the same plane.</P>
<P mce_keep="true">In order to achieve the parallax effect that ParallaxUi 
demonstrates, and be able to experience these objects in 3D, the camera needs to 
be reasonably close to the objects.&nbsp; However, when the camera is close, it 
accentuates the depth differences between the objects.&nbsp; Thus, if ParallaxUi 
maintained a constant camera distance, the initial view, when we rotated even 
slightly away from the 2D representation, would jump dramatically and introduce 
unwanted depth effects.</P>
<P mce_keep="true">Here's an example.&nbsp; This first image is a head on view 
of our sample UI:</P>
<P mce_keep="true"><IMG title="ParallaxUi Head On" 
style="WIDTH: 500px; HEIGHT: 328px" height=328 alt="ParallaxUi Head On" 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/500x328.jpg" 
width=500 align=middle 
mce_src="http://blogs.msdn.com/photos/greg_schechter/images/1992921/500x328.aspx"></P>
<P mce_keep="true">This next image is from a broken version of the code that 
always keeps the camera at the same distance, and it's taken when the sample UI 
is rotated just slightly off of 0°:</P>
<P mce_keep="true"><IMG title="Bad Parallax" style="WIDTH: 500px; HEIGHT: 300px" 
height=300 alt="Bad Parallax" 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/500x300.jpg" 
width=500 align=middle 
mce_src="http://blogs.msdn.com/photos/greg_schechter/images/2142817/500x300.aspx"></P>
<P mce_keep="true">And this just completely breaks the illusion we're going 
for.</P>
<P mce_keep="true">&nbsp;</P>
<P mce_keep="true">On the other hand, if we always use a camera distance that's 
too far from the subject, then at angles further away from 0° we don't get any 
sense of perspective or 3D-ness.&nbsp; Here are two examples of the same 
rotation angle, where the first has a camera reasonably near in, and the second 
has the camera at infinity.&nbsp; Believe it or not, both scenes are at the same 
rotation angle.&nbsp; We clearly need to stay away from the second one, as it 
really doesn't give any sense of perspective.</P>
<P mce_keep="true"><IMG title="Good Parallax at an Angle" 
style="WIDTH: 425px; HEIGHT: 249px" height=249 alt="Good Parallax at an Angle" 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/fov-choice-3.png" 
width=425 
mce_src="http://blogs.msdn.com/photos/greg_schechter/images/2146894/original.aspx">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<IMG 
title="Bad Parallax at an Angle" style="WIDTH: 437px; HEIGHT: 251px" height=251 
alt="Bad Parallax at an Angle" 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/fov-choice-4.png" 
width=437 
mce_src="http://blogs.msdn.com/photos/greg_schechter/images/2146891/original.aspx"></P>
<P>The solution we use here is to adjust the camera distance as we change our 
rotation.&nbsp; The camera distance moves towards infinity as we approach 0°, 
and it moves closer in as we approach some threshold rotation angle (the sample 
app chooses 90°).&nbsp; But it's not sufficient just to adjust the camera 
distance, since with a fixed FOV, the further back we move the camera, the more 
of the image that we catch in our "viewfinder".&nbsp; So, as we move forward and 
back, we also need to adjust our FOV to keep the same image cropping in the 
"viewfinder".&nbsp; This is like walking backwards with your camera and zooming 
in at the same time.&nbsp; </P>
<P mce_keep="true">&nbsp;</P>
<P>The following is a diagram demonstrating how FOV and camera distance can be 
coordinated in order to keep the same image section in view:</P>
<P mce_keep="true"><IMG title="Relationship between FOV and camera distance" 
style="WIDTH: 769px; HEIGHT: 228px" height=228 
alt="Relationship between FOV and camera distance" 
src="Greg Schechter's Blog  Making ParallaxUi look right - field of view selection_files/fov-choice-1.png" 
width=769 
mce_src="http://blogs.msdn.com/photos/greg_schechter/images/2142827/original.aspx"></P>
<P mce_keep="true">Once one sees the relationship there, and knows (from the 
previous post) how to derive distance from FOV, it becomes relatively simple to 
just adjust the FOV based on the ParallaxUI's rotation angle, knowing that that 
will result in pushing the camera backwards and forwards.&nbsp; Here's the code 
that the ParallaxUi uses to do this... nothing special, once the general 
principle is understood:</P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> 
</SPAN><SPAN style="COLOR: gray">&lt;summary&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> Update 
the 3D rotation applied.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>As the 
angle approaches 0, bring the Field of View<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> of the 
camera towards 0 as well (making it more like an orthographic camera).<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN>This<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> is 
required so a face-on view will not show any signs of differences in z-values 
for<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> the 
different elements.<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: gray">///</SPAN><SPAN style="COLOR: green"> 
</SPAN><SPAN style="COLOR: gray">&lt;/summary&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">private</SPAN> <SPAN 
style="COLOR: blue">void</SPAN> RotChanged(<SPAN 
style="COLOR: #2b91af">Rotation3D</SPAN> rot, <SPAN 
style="COLOR: #2b91af">Point3D</SPAN> relativeCenter)<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">if</SPAN> (_vp3d != <SPAN 
style="COLOR: blue">null</SPAN>)<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: green">// as the angle approaches 0, bring the Field 
of View towards 0<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">double</SPAN> absAngle = <SPAN 
style="COLOR: #2b91af">Math</SPAN>.Abs(GetAngle(rot));<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">const</SPAN> <SPAN 
style="COLOR: blue">double</SPAN> defaultFov = 65.0;<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">const</SPAN> <SPAN 
style="COLOR: blue">double</SPAN> angleThreshold = 90.0;<SPAN 
style="COLOR: green"><o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">const</SPAN> <SPAN 
style="COLOR: blue">double</SPAN> multiplierWithinThreshold = defaultFov / 
angleThreshold;<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">double</SPAN> fov;<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">if</SPAN> (absAngle &lt; 
angleThreshold)<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: green">// x is the fraction of the angle within the 
threshold and within [0,1]<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">double</SPAN> x = absAngle / 
angleThreshold;<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: green">// makes descent into fov of 0 be non-linear, 
so less obvious jump.<SPAN style="mso-spacerun: yes">&nbsp; </SPAN>Requirement 
for this<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: green">// calculation is that 0=&gt;0, and 
1=&gt;1.<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">double</SPAN> factor = x * x;<SPAN 
style="mso-spacerun: yes">&nbsp; </SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>fov = factor * angleThreshold * 
multiplierWithinThreshold;<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>fov = <SPAN style="COLOR: #2b91af">Math</SPAN>.Max(fov, 
0.01);<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: blue">else<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>fov = defaultFov;<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt 1in; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp; </SPAN>… elided irrelevant stuff 
…<o:p></o:p></SPAN></P>
<P class=MsoNormal 
style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN 
style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><SPAN 
style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN>}</SPAN><SPAN lang=EN 
style="mso-ansi-language: EN"><o:p></o:p></SPAN></P>
<P mce_keep="true">&nbsp;</P>
<DIV class=postfoot>Published Sunday, April 15, 2007 1:05 PM by <A 
id=ctl00___ctl00___ctl01___Entry___AuthorLink 
href="http://blogs.msdn.com/user/Profile.aspx?UserID=2944">Greg Schechter</A> 
<DIV><SPAN id=ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel>Filed under: 
<A href="http://blogs.msdn.com/greg_schechter/archive/tags/WPF/default.aspx" 
rel=tag>WPF</A></SPAN><INPUT 
id=ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel_State type=hidden 
value=nochange 
name=ctl00$_$ctl00$_$ctl01$_$Entry$_$InlineTagEditorPanel></DIV></DIV></DIV></DIV>
<H3>Comments </H3>
<DIV id=comments>
<DIV class=comment>No Comments </DIV></DIV><EM>New Comments to this post are 
disabled</EM> </DIV></DIV>
<DIV id=contentfooter>&nbsp;</DIV></DIV>
<DIV id=footer></DIV></DIV></DIV>
<SCRIPT language=javascript type=text/javascript>
<!--
function KeyDownHandlerctl00___ctl00___bs1___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$bs1$_$ws$_$SearchButton','')	}
}

//-->
</SCRIPT>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/greg_schechter/archive/2007/04/15/making-parallaxui-look-right-field-of-view-selection.aspx"
dc:identifier="http://blogs.msdn.com/greg_schechter/archive/2007/04/15/making-parallaxui-look-right-field-of-view-selection.aspx"
dc:title="Making ParallaxUi look right - field of view selection"
trackback:ping="http://blogs.msdn.com/greg_schechter/trackback.aspx?PostID=2146970" />
</rdf:RDF>
--></FORM></BODY></HTML>
