<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><title>Windows Presentation Foundation SDK : Centering WPF Windows with WPF and Non-WPF Owner Windows</title>
 




<meta name="description" content="This post demonstrates how to manually center a window with respect to both a WPF and non-WPF owner window. Centering a Window with a WPF Owner Window To center a window over another window in WPF, you need to do two things. First, you need to set the">
<meta name="GENERATOR" content="CommunityServer 2.1 SP1 (Build: 61025.2)">
<link rel="pingback" href="http://blogs.msdn.com/wpfsdk/pingback.aspx">
<link rel="stylesheet" href="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/style.css" type="text/css" media="screen">
<link rel="stylesheet" href="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/print.css" type="text/css" media="print">
<link rel="stylesheet" href="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/right%2520sidebar.css" type="text/css" media="screen">
<link rel="shortcut icon" type="image/ico" href="http://blogs.msdn.com/favicon.ico">
<link rel="alternate" type="application/rss+xml" title="Windows Presentation Foundation SDK  (RSS 2.0)" href="http://blogs.msdn.com/wpfsdk/rss.xml">
<link rel="alternate" type="application/atom+xml" title="Windows Presentation Foundation SDK  (Atom 1.0)" href="http://blogs.msdn.com/wpfsdk/atom.xml">
<link rel="alternate" type="application/rss+xml" title="Centering WPF Windows with WPF and Non-WPF Owner Windows Comment RSS (RSS 2.0)" href="http://blogs.msdn.com/wpfsdk/commentrss.aspx?PostID=2022412">

	<script src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/global.js" type="text/javascript"></script></head><body>
<form name="aspnetForm" method="post" action="/wpfsdk/archive/2007/04/03/centering-wpf-windows-with-wpf-and-non-wpf-owner-windows.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="aspnetForm">
<div>
<input name="__EVENTTARGET" id="__EVENTTARGET" value="" type="hidden">
<input name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" type="hidden">
<input name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTMyNjg0MDc1MWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFI2N0bDAwJF8kY3RsMDAkXyRicyRfJHdzJF8kU2VhcmNoQm94rkRXbV1z5ohWybmugg6l5bfTy3M=" type="hidden">
</div>

<script type="text/javascript">
<!--
var theForm = document.forms['aspnetForm'];
if (!theForm) {
    theForm = document.aspnetForm;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
// -->
</script>


<script src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/WebResource.js" type="text/javascript"></script>

<script language="javascript" type="text/javascript" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/Telligent_Modal.js"></script><script language="javascript" type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['Modal'],['ModalTitle'],['ModalClose'],['ModalContent'],['ModalFooter'],['ModalResize'],['ModalMask'],100);
// ]]>
</script><script language="javascript" type="text/javascript">
var RatingControlAJAX = {
"SaveRating":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Blogs.Controls.BlogRatePost',id,'SaveRating',[p0],cb,0,0,0,1);}};
</script><script language="javascript" type="text/javascript">
var ThreadSubscribeLinkButton = {
"ToggleEmailReplies":function(id,p0,cb){return Ajax_CallBack('CommunityServer.Controls.ThreadSubscribeLinkButton',id,'ToggleEmailReplies',[p0],cb,0,0,0,0);}};
</script><script type="text/javascript" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/ratingcontrol.js"></script><script language="JavaScript" type="text/javascript">var ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = false;var ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = false;function updateSubscriptionText() {if(ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus == true) {document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Stop sending me email alerts for this post';} else {document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Send me email alerts for new comments to this post';}}function toggleSubscription() {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = true;document.getElementById('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton').innerHTML = 'Updating email notifications...';ThreadSubscribeLinkButton.ToggleEmailReplies('ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton',505166, toggleSubscriptionCallback);}function toggleSubscriptionCallback(response) {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackWorking = false;if((response.error == null) && (response.value == true)) {if(ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus == true) {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = false;} else {ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton_trackStatus = true;}updateSubscriptionText();} else {updateSubscriptionText();alert('An error happened while processing your request.  Please notify an administrator and try again later.');}}</script>
<script src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/WebResource_002.js" type="text/javascript"></script>
<script type="text/javascript">
<!--
function WebForm_OnSubmit() {
if (typeof(ValidatorOnSubmit) == "function" && ValidatorOnSubmit() == false) return false;
return true;
}
// -->
</script>

			
<div id="masthead">
	
		<div id="welcome" align="right">
			
					Signed in as <a href="http://blogs.msdn.com/user/EditProfile.aspx?ReturnUrl=/blogs/post.aspx?App=wpfsdk&amp;y=2007&amp;m=04&amp;d=03&amp;PostName=centering-wpf-windows-with-wpf-and-non-wpf-owner-windows">bbraatz</a>
 | <a id="ctl00___ctl00___duw1_rc1___logout" href="http://blogs.msdn.com/logout.aspx">Sign out</a>



				
			 | 
			<a id="ctl00___ctl00___duw1_Faq1" href="http://blogs.msdn.com/languages/en-US/docs/faq.aspx">Help</a>
		</div>
	
</div>
<div id="wrapper">
	<div id="container">
		<div id="header">
			
<div id="title">
<h1><a id="ctl00___ctl00___bth___BlogTitle" class="headermaintitle" href="http://blogs.msdn.com/wpfsdk/default.aspx">Windows Presentation Foundation SDK </a></h1>
<p id="tagline"></p></div>

		</div>
		<div id="contentwrapper">
			<div id="sidebar-a">
				
<div id="BlogLinksSideBar">
	
<div id="WeblogLinks">
<h3>This Blog</h3>
<ul>
    <li><a id="ctl00___ctl00___bs___wl___email" href="http://blogs.msdn.com/wpfsdk/emailsubscriptions.aspx">Email alerts</a></li>
	<li><a id="ctl00___ctl00___bs___wl___Aboutlink1" href="http://blogs.msdn.com/wpfsdk/about.aspx">About</a></li>
	<li><a id="ctl00___ctl00___bs___wl___Contactlink1" href="http://blogs.msdn.com/wpfsdk/contact.aspx">Email</a></li>
</ul>
</div>
</div>

<div id="TasksSideBar">
	
</div>

<div id="SubscriptionsSideBar">
	
<div id="Subscriptions">
 <h3>Syndication</h3>
    <ul>
        <li><a id="ctl00___ctl00___bs___bs___rss" href="http://blogs.msdn.com/wpfsdk/rss.xml">RSS 2.0</a></li>
        <li><a id="ctl00___ctl00___bs___bs___atom" href="http://blogs.msdn.com/wpfsdk/atom.xml">Atom 1.0</a></li>
    </ul>
 </div>
</div>

<div id="SearchSideBar">
	
<h3>Search</h3>	
<div id="Search">
<ul><li>
<input name="ctl00$_$ctl00$_$bs$_$ws$_$SearchBox" id="ctl00___ctl00___bs___ws___SearchBox" class="searchBox" onkeydown="KeyDownHandlerctl00___ctl00___bs___ws___SearchButton(event);" type="text"> <a id="ctl00___ctl00___bs___ws___SearchButton" href="javascript:__doPostBack('ctl00$_$ctl00$_$bs$_$ws$_$SearchButton','')">Go</a>
</li></ul>
</div>

</div>

<div id="TagSideBar">
	<h3>Tags</h3>
	<ul>
	<ul class="SidebarTagCloud">
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/3.5/default.aspx" rel="tag">3.5</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/3D/default.aspx" rel="tag">3D</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Accessibility/default.aspx" rel="tag">Accessibility</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Animation/default.aspx" rel="tag">Animation</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Annotations/default.aspx" rel="tag">Annotations</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/bitmap+effects/default.aspx" rel="tag">bitmap effects</a></li>
<li class="Tag2"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Controls/default.aspx" rel="tag">Controls</a></li>
<li class="Tag2"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Data+Binding/default.aspx" rel="tag">Data Binding</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Data+Visualization/default.aspx" rel="tag">Data Visualization</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Design/default.aspx" rel="tag">Design</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Dispatcher/default.aspx" rel="tag">Dispatcher</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Documents/default.aspx" rel="tag">Documents</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/drop+shadow/default.aspx" rel="tag">drop shadow</a></li>
<li class="Tag3"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/FAQ/default.aspx" rel="tag">FAQ</a></li>
<li class="Tag1"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Features/default.aspx" rel="tag">Features</a></li>
<li class="Tag2"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/General/default.aspx" rel="tag">General</a></li>
<li class="Tag1"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/News/default.aspx" rel="tag">News</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Performance/default.aspx" rel="tag">Performance</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Sample/default.aspx" rel="tag">Sample</a></li>
<li class="Tag3"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Styles+and+Templates/default.aspx" rel="tag">Styles and Templates</a></li>
<li class="Tag2"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Tips+_2600_amp_3B00_+Tricks/default.aspx" rel="tag">Tips &amp; Tricks</a></li>
<li class="Tag1"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Windows+Presentation+Foundation/default.aspx" rel="tag">Windows Presentation Foundation</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/Wizard/default.aspx" rel="tag">Wizard</a></li>
<li class="Tag1"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/WPF/default.aspx" rel="tag">WPF</a></li>
<li class="Tag6"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/XAML/default.aspx" rel="tag">XAML</a></li>
<li class="Tag4"><a href="http://blogs.msdn.com/wpfsdk/archive/tags/XAML+Clip+Art/default.aspx" rel="tag">XAML Clip Art</a></li>
</ul>

	</ul>
</div>

<div id="NewsSideBar">
	
<h3>News</h3>
<div id="news"><table height="24" width="100%">
<tbody><tr>
<td align="left" valign="top">
<font face="Verdana" size="1">Download<br><a href="http://msdn2.microsoft.com/en-us/vstudio/aa700831.aspx"><b>VS 2008 Beta 2/.NET FX 3.5 Beta 2</b></a></font></td>
</tr>
<tr>
<td align="left" valign="top">
<font face="Verdana" size="1">Download<br><a href="http://msdn.microsoft.com/windowsvista/downloads/products/getthebeta/default.aspx"><b>.NET Framework 3.0</b></a></font></td>
<td width="24">
<img src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/original_002.png" border="0" height="22" width="24"></td>
</tr>
<tr>
<td align="left" valign="top">
<font size="1">View<br>
<a href="http://msdn2.microsoft.com/en-us/library/ms754130.aspx">
<b>WPF SDK docs</b></a><b></b></font></td>
<td width="24">
<img src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/original.jpg" border="0" height="15" width="30"></td>
</tr>
</tbody></table>
</div>
</div>

<div id="ArchiveSideBar">
	
	
<h3>Archives</h3>
<ul>

        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/10.aspx">October 2007 (1)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/09.aspx">September 2007 (2)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/08.aspx">August 2007 (4)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/07.aspx">July 2007 (4)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/06.aspx">June 2007 (4)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/05.aspx">May 2007 (3)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/04.aspx">April 2007 (5)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/03.aspx">March 2007 (6)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/02.aspx">February 2007 (4)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2007/01.aspx">January 2007 (11)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/12.aspx">December 2006 (6)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/11.aspx">November 2006 (4)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/10.aspx">October 2006 (5)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/09.aspx">September 2006 (2)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/07.aspx">July 2006 (3)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/06.aspx">June 2006 (13)</a>
        </li>
    
        <li>
            <a href="http://blogs.msdn.com/wpfsdk/archive/2006/05.aspx">May 2006 (10)</a>
        </li>
    
</ul>
	
</div>

<div id="LinkSideBar">
	
        <h3>Related Blogs</h3>
        <ul>
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl01_Link" href="http://blogs.msdn.com/windowssdk/">Microsoft Windows SDK Blog</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl00_Links_ctl02_Link" href="http://blogs.msdn.com/karinm">Karin Meier (Windows SDK Samples PM)</a></li>
            </ul>
    
        <h3>WPF Blogs</h3>
        <ul>
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl01_Link" href="http://blogs.msdn.com/tims/articles/475132.aspx">WPF Bloggers</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl02_Link" href="http://spaces.msn.com/michaelweinhardt/">mikeDub @ Microsoft</a></li>
            
                <li><a id="ctl00___ctl00___bs___lcl___Categories_ctl01_Links_ctl03_Link" href="http://blogs.msdn.com/silverlight_sdk/">Silverlight SDK</a></li>
            </ul>
    

	
</div>
			</div>
			<div id="content"><div id="content2">
				
        

<div class="post">
	<div class="postview">			
		<h2>Centering WPF Windows with WPF and Non-WPF Owner Windows</h2>
		<p class="MsoNormal" style="margin: 0in 0in 0pt;">This post demonstrates how to manually center a window with respect to both a WPF and non-WPF owner window.</p>
<h3 style="margin: 12pt 0in 3pt;">Centering a Window with a WPF Owner Window</h3>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">To center a window over another window in WPF, you need to do two things. First, you need to set the <b style="">WindowStartupLocation</b> property of the <b style="">Window</b> you want centered to <b style="">WindowStartupLocation</b>.<b style="">CenterOwner</b>:</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">&lt;</span><span style="color: rgb(163, 21, 21); font-family: 'Courier New';">Window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">xmlns</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">xmlns:x</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">http://schemas.microsoft.com/winfx/2006/xaml</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">x:Class</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">SDKSample.CenteredWindow</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">Title</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">Centered Window</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span></b><b style=""><span style="color: red; font-family: 'Courier New';">WindowStartupLocation</span></b><b style=""><span style="color: blue; font-family: 'Courier New';">=</span></b><b style=""><span style="font-family: 'Courier New';">"<span style="color: blue;">CenterOwner</span>"<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">Width</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">250</span>"<span style="color: blue;"> </span><span style="color: red;">Height</span><span style="color: blue;">=</span>"<span style="color: blue;">250</span>"<span style="color: blue;">&gt;<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="font-family: 'Courier New';">...<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">&lt;/</span><span style="color: rgb(163, 21, 21); font-family: 'Courier New';">Window</span><span style="color: blue; font-family: 'Courier New';">&gt;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">using</span><span style="font-family: 'Courier New';"> System.Windows; <span style="color: green;">// Window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">namespace</span><span style="font-family: 'Courier New';"> SDKSample<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">CenteredWindow</span> : <span style="color: rgb(43, 145, 175);">Window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">public</span> CenteredWindow()<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InitializeComponent();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">}</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">Second, when you open the window to be centered, you <b style="">*must*</b> set its <b style="">Owner</b> property with the <b style="">Window</b> that opens it:</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">&lt;</span><span style="color: rgb(163, 21, 21); font-family: 'Courier New';">Window</span><span style="color: blue; font-family: 'Courier New';"> <o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">xmlns</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">http://schemas.microsoft.com/winfx/2006/xaml/presentation</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">xmlns:x</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">http://schemas.microsoft.com/winfx/2006/xaml</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">x:Class</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">SDKSample.OwnerWindow</span>"<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">Title</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">Owner Window</span>"<span style="color: blue;"> <o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp; </span></span><span style="color: red; font-family: 'Courier New';">Width</span><span style="color: blue; font-family: 'Courier New';">=</span><span style="font-family: 'Courier New';">"<span style="color: blue;">300</span>"<span style="color: blue;"> </span><span style="color: red;">Height</span><span style="color: blue;">=</span>"<span style="color: blue;">300</span>"<span style="color: blue;">&gt;<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New';">...<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>&lt;</span></b><b style=""><span style="color: rgb(163, 21, 21); font-family: 'Courier New';">Button</span></b><b style=""><span style="color: blue; font-family: 'Courier New';"> </span></b><b style=""><span style="color: red; font-family: 'Courier New';">Click</span></b><b style=""><span style="color: blue; font-family: 'Courier New';">=</span></b><b style=""><span style="font-family: 'Courier New';">"<span style="color: blue;">button_Click</span>"<span style="color: blue;">&gt;<o:p></o:p></span></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Show Centered Window<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>&lt;/</span></b><b style=""><span style="color: rgb(163, 21, 21); font-family: 'Courier New';">Button</span></b><b style=""><span style="color: blue; font-family: 'Courier New';">&gt;<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family: 'Courier New';">...<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">&lt;/</span><span style="color: rgb(163, 21, 21); font-family: 'Courier New';">Window</span><span style="color: blue; font-family: 'Courier New';">&gt;</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">using</span><span style="font-family: 'Courier New';"> System.Windows; <span style="color: green;">// Window, RoutedEventArgs<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">namespace</span><span style="font-family: 'Courier New';"> SDKSample<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">public</span> <span style="color: blue;">partial</span> <span style="color: blue;">class</span> <span style="color: rgb(43, 145, 175);">OwnerWindow</span> : <span style="color: rgb(43, 145, 175);">Window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">public</span> OwnerWindow()<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InitializeComponent();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">void</span> button_Click(<span style="color: blue;">object</span> sender, <span style="color: rgb(43, 145, 175);">RoutedEventArgs</span> e)<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Open window and set this window as its owner.<o:p></o:p></span></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// This causes the window to be centered with <o:p></o:p></span></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// respect to this window<o:p></o:p></span></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">CenteredWindow</span> cw = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">CenteredWindow</span>();<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cw.Owner = <span style="color: blue;">this</span>;<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cw.Show();<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>}<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">}</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">When the button in
this example is clicked, the owned window appears centered with respect
to the owner window, as shown in the following figure:</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;" mce_keep="true">&nbsp;</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;" mce_keep="true"><img style="width: 312px; height: 314px;" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/original.png" mce_src="http://blogs.msdn.com/photos/wcsdkteam/images/2022413/original.aspx" height="314" width="312"></p>
<h3 style="margin: 12pt 0in 3pt;">Centering a Window with a Non-WPF Owner Window</h3>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">WPF does allow you to
set a non-WPF window as the owner of a WPF window. For example, a
Visual Studio 2005 (VS05) add-in that shows a WPF window whose owner is
the main VS05 IDE window. The following shows a generalized version of
code that sets a WPF window with a non-WPF owner, using <b style="">WindowInteropHelper</b>:</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">using</span><span style="font-family: 'Courier New';"> System.Windows; <span style="color: green;">// Window</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: blue; font-family: 'Courier New';">using</span></b><b style=""><span style="font-family: 'Courier New';"> System.Windows.Interop; <span style="color: green;">// WindowInteropHelper</span></span><o:p></o:p></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">...<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Instantiate the owned WPF window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">CenteredWindow</span><span style="font-family: 'Courier New';"> cw = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">CenteredWindow</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: green; font-family: 'Courier New';">// Get the handle to the non-WPF owner window<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">IntPtr ownerWindowHandle = </span></b><b style=""><span style="font-family: 'Courier New';">...;<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: green; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: green; font-family: 'Courier New';">// Set the owned WPF window’s Owner property with <o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: green; font-family: 'Courier New';">// the non-WPF owner window<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">WindowInteropHelper</span></b><b style=""><span style="font-family: 'Courier New';"> helper = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">WindowInteropHelper</span>(cw);<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="font-family: 'Courier New';">helper.Owner = (<span style="color: rgb(43, 145, 175);">IntPtr</span>)_applicationObject.MainWindow.HWnd;<o:p></o:p></span></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Show the owned WPF window</span><span style="font-family: 'Courier New';"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.Show();</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">When a WPF window has
a non-WPF owner, WPF honors the owner window/owned window relationship
eg when a non-WPF owner window is minimized, the owned WPF window
follows suit. However, if the owned WPF window has its <b style="">WindowStartupLocation</b> property set to <b style="">WindowStartupLocation.CenterOwner</b>, WPF does not center the owned WPF window over the non-WPF owner window. Instead, you’ll need to set the <b style="">WindowStartupLocation</b> of the owned window to <b style="">WindowStartupLocation.Manual</b> and manually calculate its Top and Left properties with values that make it appear centered:</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">using</span><span style="font-family: 'Courier New';"> System.Windows; <span style="color: green;">// Window,</span><span style="color: rgb(43, 145, 175);"> </span><span style="color: green;">WindowStartupLocation<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">using</span><span style="font-family: 'Courier New';"> System.Windows.Interop; <span style="color: green;">// WindowInteropHelper</span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">...<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Instantiate the owned WPF window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">CenteredWindow</span><span style="font-family: 'Courier New';"> cw = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">CenteredWindow</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Get the handle to the non-WPF owner window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">IntPtr </span><span style="font-family: 'Courier New';">ownerWindowHandle = ...; <span style="color: green;">// Get hWnd for non-WPF window</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Set the owned WPF window’s owner with the non-WPF owner window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">WindowInteropHelper</span><span style="font-family: 'Courier New';"> helper = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">WindowInteropHelper</span>(cw);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">helper.Owner = ownerWindowHandle;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Manually calculate Top/Left to appear centered<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">int</span><span style="font-family: 'Courier New';"> nonWPFOwnerLeft = ...; <span style="color: green;">// Get non-WPF owner’s Left</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">int</span><span style="font-family: 'Courier New';"> nonWPFOwnerWidth = ...; <span style="color: green;">// Get non-WPF owner’s Width</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">int</span><span style="font-family: 'Courier New';"> nonWPFOwnerTop = ...; <span style="color: green;">// Get non-WPF owner’s Top</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">int</span><span style="font-family: 'Courier New';"> nonWPFOwnerHeight = ...; <span style="color: green;">// Get non-WPF owner’s Height</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.WindowStartupLocation = <span style="color: rgb(43, 145, 175);">WindowStartupLocation</span>.Manual;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.Left = nonWPFOwnerLeft + (nonWPFOwnerWidth - cw.Width) / 2;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.Top = nonWPFOwnerTop + (nonWPFOwnerHeight - cw.Height) / 2;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Show the owned WPF window</span><span style="font-family: 'Courier New';"><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.Show();</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">There is one issue
with this code; WPF supports device-independence, which means that,
irrespective of DPI; this code will center a WPF window with respect to
a WPF owner window in both low and high DPI. However, this code may not
center a WPF window with respect to a non-WPF owner window in high DPI.
In this case, you need to perform a little extra work to convert the
non-WPF owner window’s location and size into device-independent
versions that the WPF owned window can calculate against. This work is
facilitated by <b style="">HwndSource</b>:</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p><span style="font-size: 10pt; font-family: Arial;"><br style="page-break-before: always;" clear="all"></span>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';">using</span><span style="font-family: 'Courier New';"> System.Windows; <span style="color: green;">// Window, WindowStartupLocation, <b style="">Point</b><o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: blue; font-family: 'Courier New';">using</span></b><b style=""><span style="font-family: 'Courier New';"> System.Windows.Interop; <span style="color: green;">// </span></span></b><span style="color: green; font-family: 'Courier New';">WindowInteropHelper, <b style="">HwndSource<o:p></o:p></b></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><b style=""><span style="color: blue; font-family: 'Courier New';">using</span></b><b style=""><span style="font-family: 'Courier New';"> System.Windows.Media; <span style="color: green;">// Matrix</span></span><o:p></o:p></b></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">...<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Instantiate the owned WPF window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">CenteredWindow</span><span style="font-family: 'Courier New';"> cw = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">CenteredWindow</span>();<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Get the handle to the non-WPF owner window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">IntPtr </span><span style="font-family: 'Courier New';">ownerWindowHandle = ...; <span style="color: green;">// Get hWnd for non-WPF window</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Set the owned WPF window’s owner with the non-WPF owner window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: rgb(43, 145, 175); font-family: 'Courier New';">WindowInteropHelper</span><span style="font-family: 'Courier New';"> helper = <span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">WindowInteropHelper</span>(cw);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">helper.Owner = ownerWindowHandle;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Center window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Note - Need to use HwndSource to get handle to WPF owned window,<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">//<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>and the handle only exists when SourceInitialized has been<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">//<span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>raised<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.SourceInitialized += <span style="color: blue;">delegate<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">{<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get WPF size and location for non-WPF owner window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>int</span><span style="font-family: 'Courier New';"> nonWPFOwnerLeft = ...; <span style="color: green;">// Get non-WPF owner’s Left</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>int</span><span style="font-family: 'Courier New';"> nonWPFOwnerWidth = ...; <span style="color: green;">// Get non-WPF owner’s Width</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>int</span><span style="font-family: 'Courier New';"> nonWPFOwnerTop = ...; <span style="color: green;">// Get non-WPF owner’s Top</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: blue; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>int</span><span style="font-family: 'Courier New';"> nonWPFOwnerHeight = ...; <span style="color: green;">// Get non-WPF owner’s Height</span><o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Get transform matrix to transform non-WPF owner window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// size and location units into device-independent WPF <o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>// size and location units<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">HwndSource</span> source = <span style="color: rgb(43, 145, 175);">HwndSource</span>.FromHwnd(helper.Handle);<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">if</span> (source == <span style="color: blue;">null</span>) <span style="color: blue;">return</span>;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">Matrix</span> matrix = source.CompositionTarget.TransformFromDevice;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">Point</span> ownerWPFSize = matrix.Transform(<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Point</span>(nonWPFOwnerWidth, nonWPFOwnerHeight));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(43, 145, 175);">Point</span> ownerWPFPosition = matrix.Transform(<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue;">new</span> <span style="color: rgb(43, 145, 175);">Point</span>(nonWPFOwnerLeft, nonWPFOwnerTop));<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span><span style="color: green;">// Center WPF window<o:p></o:p></span></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>cw.WindowStartupLocation = <span style="color: rgb(43, 145, 175);">WindowStartupLocation</span>.Manual;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>cw.Left = ownerWPFPosition.X + (ownerWPFSize.X - cw.Width) / 2;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><span style="">&nbsp;&nbsp;&nbsp; </span>cw.Top = ownerWPFPosition.Y + (ownerWPFSize.Y - cw.Height) / 2;<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">};<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';"><o:p>&nbsp;</o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Courier New';">// Show WPF owned window<o:p></o:p></span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><span style="font-family: 'Courier New';">cw.Show();</span></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">This code basically
converts the non-device-independent size and position of the non-WPF
owner window, and converts them to device-independent values. This
allows you to calculate the Top and Left values that will cause the
owned WPF window to be appeared centered. This requires a little help
from <b style="">HwndSource</b>, which is used to do the co-ordinate system conversion (or transforms). <b style="">HwndSource</b> relies on the WPF window having a hWnd, which doesn’t happen until the <b style="">SourceInitialized</b> event is raised. Hence the anonymous delegate code.</p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;"><o:p>&nbsp;</o:p></p>
<p class="MsoNormal" style="margin: 0in 0in 0pt;">This solution is generalized, but does work in both normal and high DPI. </p>
		<div class="postfoot">
			Published Tuesday, April 03, 2007 6:20 PM
			by
			<a id="ctl00___ctl00___ctl01___Entry___AuthorLink" href="http://blogs.msdn.com/user/Profile.aspx?UserID=30194">wcsdkteam</a>
			
			<span class="CommonRateControl" id="ctl00___ctl00___ctl01___Entry___Ratings" title="Not yet rated"><img title="Poor" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-left-off.gif" align="absmiddle" border="0"><img title="Poor" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-right-off.gif" align="absmiddle" border="0"><img title="Fair" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-left-off.gif" align="absmiddle" border="0"><img title="Fair" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-right-off.gif" align="absmiddle" border="0"><img title="Average" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-left-off.gif" align="absmiddle" border="0"><img title="Average" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-right-off.gif" align="absmiddle" border="0"><img title="Good" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-left-off.gif" align="absmiddle" border="0"><img title="Good" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-right-off.gif" align="absmiddle" border="0"><img title="Excellent" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-left-off.gif" align="absmiddle" border="0"><img title="Excellent" src="Centering%20WPF%20Windows%20with%20WPF%20and%20Non-WPF%20Owner%20Windows_files/star-right-off.gif" align="absmiddle" border="0"></span><input value="0" id="ctl00___ctl00___ctl01___Entry___Ratings_Value" type="hidden">
			<div><span id="ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel"></span><input name="ctl00$_$ctl00$_$ctl01$_$Entry$_$InlineTagEditorPanel" id="ctl00___ctl00___ctl01___Entry___InlineTagEditorPanel_State" value="nochange" type="hidden"></div>
										
		</div>
	</div>
</div>


<div id="postToolbar">
<h2 class="CommonSubTitle">Comment Notification</h2>
<p>
	
	<a href="javascript:toggleSubscription();" id="ctl00___ctl00___ctl01___DetailedSubBar___BlogThreadButton" trackingresourcename="Weblogs_UnTrack" nottrackingresourcename="Weblogs_Track" workingresourcename="Weblogs_TrackWorking">Send me email alerts for new comments to this post</a>
</p>
<p>
	Subscribe to this post's comments using
	<a id="ctl00___ctl00___ctl01___DetailedSubBar___CommentRssLink" href="http://blogs.msdn.com/wpfsdk/commentrss.aspx?PostID=2022412">RSS</a>
</p>
</div>

<h3>
	Comments
</h3>	
<div id="comments">

		<div class="comment">
			<h4>
				<a id="ctl00___ctl00___ctl01___Comments___Comments_ctl00_PermaLink" title="permalink" href="http://blogs.msdn.com/wpfsdk/archive/2007/04/03/centering-wpf-windows-with-wpf-and-non-wpf-owner-windows.aspx#2637480">#</a>
				<span>设置WPF窗口相对于非WPF窗口的位置 <a name="2637480"></a></span>
			</h4>
			<div class="commentsbody">
				<p>在
前一个Post当中，指出了在WPF的WindowInteropHelper类中的一个BUG：通过WindowInteropHelper的
Owner属性不能实现把WPF窗口的Owner属性设置为一个非WPF窗口的句柄。在我的Post帖出后不到一天，在WPF
SDK的Blog上，就针对这个BUG给出了一个非常完美的解决方案。既然不同通过设置
WindowStartupLocation.CenterOwner来改变窗口的位置。那么我们就用
WindowStartupLocation.Manual来手动计算设置窗口的位置</p>

			</div>
			<div class="commentssubhead">
				<span class="commentspan"></span>Monday, May 14, 2007 9:20 PM by <a id="ctl00___ctl00___ctl01___Comments___Comments_ctl00_NameLink" rel="nofollow" title="TrackBack" href="http://www.cnblogs.com/YilingLai/archive/2007/05/15/746706.html" target="_blank">Yiling Lai</a>
			</div>
		</div>
	

</div>

	


	
<div id="commentform">
<h3>Leave a Comment</h3>

    <dl>
        <dt><label for="ctl00___ctl00___ctl01___form___tbTitle">Title</label> <em>(required)</em><span id="ctl00___ctl00___ctl01___form___Requiredfieldvalidator1" style="color: Red; visibility: hidden;">*</span></dt>
        <dd><input name="ctl00$_$ctl00$_$ctl01$_$form$_$tbTitle" value="re: Centering WPF Windows with WPF and Non-WPF Owner Windows" id="ctl00___ctl00___ctl01___form___tbTitle" class="smallbox" type="text"></dd>
        
        
        
        <dt><label for="ctl00___ctl00___ctl01___form___tbUrl">Your URL</label> </dt>
        <dd><input name="ctl00$_$ctl00$_$ctl01$_$form$_$tbUrl" id="ctl00___ctl00___ctl01___form___tbUrl" class="smallbox" type="text"></dd>
        
        <dt><label for="ctl00___ctl00___ctl01___form___tbComment">Comments</label> <em>(required)</em><span id="ctl00___ctl00___ctl01___form___Requiredfieldvalidator3" style="color: Red; visibility: hidden;">*</span></dt>
        <dd><textarea name="ctl00$_$ctl00$_$ctl01$_$form$_$tbComment" rows="5" cols="25" id="ctl00___ctl00___ctl01___form___tbComment"></textarea></dd>

        <dt></dt>

        <dt><input name="ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit" value="Submit" onclick='javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$_$ctl00$_$ctl01$_$form$_$btnSubmit", "", true, "", "", false, false))' id="ctl00___ctl00___ctl01___form___btnSubmit" type="submit"></dt>
    </dl>
</div>



	
   
    
			</div></div>
			<div id="contentfooter">&nbsp;</div>
		</div>
		<div id="footer">
			
		</div>
	</div>
</div>

<script type="text/javascript">
<!--
var Page_Validators =  new Array(document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator1"), document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"));
// -->
</script>

<script type="text/javascript">
<!--
var ctl00___ctl00___ctl01___form___Requiredfieldvalidator1 = document.all ? document.all["ctl00___ctl00___ctl01___form___Requiredfieldvalidator1"] : document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator1");
ctl00___ctl00___ctl01___form___Requiredfieldvalidator1.controltovalidate = "ctl00___ctl00___ctl01___form___tbTitle";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator1.errormessage = "*";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator1.initialvalue = "";
var ctl00___ctl00___ctl01___form___Requiredfieldvalidator3 = document.all ? document.all["ctl00___ctl00___ctl01___form___Requiredfieldvalidator3"] : document.getElementById("ctl00___ctl00___ctl01___form___Requiredfieldvalidator3");
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.controltovalidate = "ctl00___ctl00___ctl01___form___tbComment";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.errormessage = "*";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
ctl00___ctl00___ctl01___form___Requiredfieldvalidator3.initialvalue = "";
// -->
</script>

<script language="javascript" type="text/javascript">
<!--
function KeyDownHandlerctl00___ctl00___bs___ws___SearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$_$ctl00$_$bs$_$ws$_$SearchButton','')	}
}

//-->
</script>
<script language="javascript">var ctl00___ctl00___ctl01___Entry___Ratings=new RateControl('ctl00___ctl00___ctl01___Entry___Ratings','ctl00___ctl00___ctl01___Entry___Ratings','ctl00___ctl00___ctl01___Entry___Ratings_Value', 5, '/Themes/default/images/common/', false, 'CommonRateControl','CommonRateControlActive','CommonRateControlReadOnly',['Terrible','Poor','Fair','Average','Good','Excellent'],false,true);</script>
<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://blogs.msdn.com/wpfsdk/archive/2007/04/03/centering-wpf-windows-with-wpf-and-non-wpf-owner-windows.aspx"
dc:identifier="http://blogs.msdn.com/wpfsdk/archive/2007/04/03/centering-wpf-windows-with-wpf-and-non-wpf-owner-windows.aspx"
dc:title="Centering WPF Windows with WPF and Non-WPF Owner Windows"
trackback:ping="http://blogs.msdn.com/wpfsdk/trackback.aspx?PostID=2022412" />
</rdf:RDF>
-->

<script type="text/javascript">
<!--
var Page_ValidationActive = false;
if (typeof(ValidatorOnLoad) == "function") {
    ValidatorOnLoad();
}

function ValidatorOnSubmit() {
    if (Page_ValidationActive) {
        return ValidatorCommonOnSubmit();
    }
    else {
        return true;
    }
}
// -->
</script>
        </form>
</body></html>