<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0065)http://blog.spencen.com/2007/09/24/i-command-thee--exception.aspx -->
<HTML xmlns="http://www.w3.org/1999/xhtml" XMLNS:BlogInfo = 
"http://www.godaddy.com/BlogInfo" XMLNS:BlogEntry = 
"http://www.godaddy.com/BlogEntry" XMLNS:BlogCategory = 
"http://www.godaddy.com/BlogCategory" XMLNS:BlogComment = 
"http://www.godaddy.com/BlogComment" XMLNS:BlogTrackback = 
"http://www.godaddy.com/BlogTrackback" xmlns:wstx = 
"http://www.godaddy.com/wstx"><HEAD><TITLE>Nigel Spencer's Blog</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8"><LINK 
href="navigator.html" rel=popup>
<META content=".NET, WPF, Developer, Windows Home Server" name=keywords>
<META content="Nigel Spencer's Personal Blog" name=description><LINK title=RSD 
href="http://blog.spencen.com/rsd.xml" type=application/rsd+xml 
rel=EditURI><LINK title="Recent Entries Atom 1.0" 
href="http://blog.spencen.com/atom.aspx" type=application/atom+xml 
rel=alternate><LINK title="Recent Comments Atom 1.0" 
href="http://blog.spencen.com/comments/atom.aspx" type=application/atom+xml 
rel=alternate><LINK title="Recent Entries RSS 2.0" 
href="http://blog.spencen.com/rss2.aspx" type=application/rss+xml 
rel=alternate><LINK title="Recent Comments RSS 2.0" 
href="http://blog.spencen.com/comments/rss2.aspx" type=application/rss+xml 
rel=alternate><LINK title="Podcasts RSS 2.0" 
href="http://blog.spencen.com/podcasts-only/rss2.aspx" type=application/rss+xml 
rel=alternate>
<META content="MSHTML 6.00.2900.3199" name=GENERATOR>
<SCRIPT language=javascript src="I Command Thee - Exception_files/imageSwap.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript id=WstxImagePreload type=text/javascript>
        MM_preloadImages('http://blog.spencen.com/ThemeFiles/83489-72989/images/passport_photo_with_blue_background.png');
    </SCRIPT>

<SCRIPT language=javascript src="I Command Thee - Exception_files/siteUtil.js" 
type=text/javascript></SCRIPT>
<LINK id=theme.css 
href="http://blog.spencen.com/ThemeFiles/83489-72989/styles/theme.css" 
type=text/css rel=stylesheet><LINK id=color_2.css 
href="http://blog.spencen.com/ThemeFiles/83489-72989/styles/color_2.css" 
type=text/css rel=stylesheet><LINK id=custom.css 
href="http://blog.spencen.com/ThemeFiles/83489-72989/styles/custom.css" 
type=text/css rel=stylesheet><LINK media=screen 
href="I Command Thee - Exception_files/theme.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="I Command Thee - Exception_files/color_2.css" type=text/css 
rel=stylesheet><LINK media=screen 
href="I Command Thee - Exception_files/custom.css" type=text/css rel=stylesheet>
<SCRIPT src="I Command Thee - Exception_files/flasher.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="I Command Thee - Exception_files/vpip.js" 
type=text/javascript></SCRIPT>

<STYLE type=text/css media=all>@import url( http://blog.spencen.com/scripts/vPIP/vPIPBox.css );
</STYLE>

<SCRIPT src="I Command Thee - Exception_files/jquery.js" 
type=text/javascript></SCRIPT>
</HEAD>
<BODY>
<DIV class=sf_blog_outer_wrapper><!-- 1 -->
<DIV class=sf_blog_extra1><SPAN></SPAN></DIV>
<DIV class=sf_blog_wrapper>
<DIV class=sf_blog_navigation_top><!-- Nav:Begin --><!--
            <ul>
                <li class="sf_blog_first_nav_item"><a href="#">Navigation Item 1</a></li>
                <li><a href="#">Navigation Item 2</a></li>
                <li class="sf_blog_last_nav_item"><a href="#">Navigation Item 3</a></li>
            </ul>
		--><!-- Nav:End --></DIV><!-- /sf_blog_navigation_top --><!-- 10 -->
<DIV class=sf_blog_extra10><SPAN></SPAN></DIV>
<DIV class=sf_blog_header_wrapper><!-- 2 -->
<DIV class=sf_blog_extra2><SPAN></SPAN></DIV><!-- MainHead:Begin -->
<DIV class=sf_blog_main_header>
<DIV style="DISPLAY: block"><FONT face=Verdana><STRONG><IMG 
style="BORDER-LEFT-COLOR: #000000; BORDER-BOTTOM-COLOR: #000000; BORDER-TOP-COLOR: #000000; BORDER-RIGHT-COLOR: #000000" 
height=67 hspace=8 
src="I Command Thee - Exception_files/passport_photo_with_blue_background.png" 
width=63 align=left border=2>Nigel Spencer's Blog</STRONG></FONT><BR><FONT 
color=#ccffff size=3>This is where the tag line goes.</FONT></DIV></DIV><!-- MainHead:End --><!-- 3 -->
<DIV class=sf_blog_extra3><SPAN></SPAN></DIV></DIV><!-- /sf_blog_header_wrapper --><!-- 4 -->
<DIV class=sf_blog_extra4><SPAN></SPAN></DIV><!-- Nav:Begin -->
<DIV class=sf_blog_sidebar id=sidebar_left>
<DIV id=sidebar>
<UL class=sidebarlist>
  <LI class=sidebaritem id=si11>
  <DIV class=homelinkbox>
  <H2 class=homelinkheader><A href="http://blog.spencen.com/">Back to Main 
  Page</A></H2></DIV>
  <LI class=sidebaritem id=si68819>
  <H2 class=customheader>Contact</H2>
  <DIV class=listitemcontent><A href="mailto:home@spencen.com">E-mail</A> </DIV>
  <LI class=sidebaritem id=si3>
  <DIV class=searchbox>
  <H2 class=searchheader>Quicksearch</H2>
  <DIV class=listitemcontent><INPUT class=searchterm id=q maxLength=50 
  name=q><BR><INPUT id=sc type=checkbox name=sc> <LABEL for=sc>Include 
  comments</LABEL><BR><INPUT class=searchimage 
  onclick="(document.getElementById('sc').checked) ? incom = '&amp;sc=1' : incom = ''; document.location.href='http://blog.spencen.com/search.aspx?q=' + document.getElementById('q').value + incom;" 
  type=image alt=Search src="I Command Thee - Exception_files/btn_search.gif" 
  value=Search name=Search> </DIV></DIV>
  <LI class=sidebaritem id=si4>
  <TABLE class=calendar title=Calendar 
  style="BORDER-RIGHT: 1px solid; BORDER-TOP: 1px solid; BORDER-LEFT: 1px solid; BORDER-BOTTOM: 1px solid; BORDER-COLLAPSE: collapse" 
  cellSpacing=0 cellPadding=0 border=0>
    <TBODY>
    <TR>
      <TD style="BACKGROUND-COLOR: transparent" colSpan=7>
        <TABLE class=calendartitle 
        style="WIDTH: 100%; BORDER-COLLAPSE: collapse" cellSpacing=0 border=0>
          <TBODY>
          <TR>
            <TD style="WIDTH: 70%" align=middle>October 
        2007</TD></TR></TBODY></TABLE></TD></TR>
    <TR>
      <TH class=calendarweek scope=col align=middle abbr=Sunday>Su</TH>
      <TH class=calendarweek scope=col align=middle abbr=Monday>Mo</TH>
      <TH class=calendarweek scope=col align=middle abbr=Tuesday>Tu</TH>
      <TH class=calendarweek scope=col align=middle abbr=Wednesday>We</TH>
      <TH class=calendarweek scope=col align=middle abbr=Thursday>Th</TH>
      <TH class=calendarweek scope=col align=middle abbr=Friday>Fr</TH>
      <TH class=calendarweek scope=col align=middle abbr=Saturday>Sa</TH></TR>
    <TR>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>1</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>2</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>3</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle><A 
        class=calendarlink title="Show the 2 entries created on this day" 
        href="http://blog.spencen.com/2007/10/04.aspx">4</A></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>5</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>6</TD></TR>
    <TR>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>7</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle><A 
        class=calendarlink title="Show the entry created on this day" 
        href="http://blog.spencen.com/2007/10/08.aspx">8</A></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>9</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>10</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>11</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle><A 
        class=calendarlink title="Show the entry created on this day" 
        href="http://blog.spencen.com/2007/10/12.aspx">12</A></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>13</TD></TR>
    <TR>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>14</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle><A 
        class=calendarlink title="Show the entry created on this day" 
        href="http://blog.spencen.com/2007/10/15.aspx">15</A></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>16</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>17</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle><A 
        class=calendarlink title="Show the entry created on this day" 
        href="http://blog.spencen.com/2007/10/18.aspx">18</A></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle><A 
        class=calendarlink title="Show the entry created on this day" 
        href="http://blog.spencen.com/2007/10/19.aspx">19</A></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>20</TD></TR>
    <TR>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>21</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>22</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>23</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>24</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>25</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>26</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>27</TD></TR>
    <TR>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>28</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>29</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>30</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle>31</TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD></TR>
    <TR>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" align=middle></TD>
      <TD class=calendarcell style="WIDTH: 14%" 
  align=middle></TD></TR></TBODY></TABLE>
  <LI class=sidebaritem id=si6>
  <H2 class=feedheader>Syndicate</H2>
  <DIV class=listitemcontent>
  <UL>
    <LI><A title="Recent Entries Atom 1.0" 
    href="http://blog.spencen.com/atom.aspx"><IMG class=feedbutton 
    alt="Recent Entries Atom 1.0" 
    src="I Command Thee - Exception_files/xml.gif"></A> <A class=feedlink 
    href="http://blog.spencen.com/atom.aspx">Entries Atom 1.0</A> 
    <LI><A title="Recent Comments Atom 1.0" 
    href="http://blog.spencen.com/comments/atom.aspx"><IMG class=feedbutton 
    alt="Recent Comments Atom 1.0" 
    src="I Command Thee - Exception_files/xml.gif"></A> <A class=feedlink 
    href="http://blog.spencen.com/comments/atom.aspx">Comments Atom 1.0</A> 
    <LI><A title="Recent Entries RSS 2.0" 
    href="http://blog.spencen.com/rss2.aspx"><IMG class=feedbutton 
    alt="Recent Entries RSS 2.0" 
    src="I Command Thee - Exception_files/xml.gif"></A> <A class=feedlink 
    href="http://blog.spencen.com/rss2.aspx">Entries RSS 2.0</A> 
    <LI><A title="Recent Comments RSS 2.0" 
    href="http://blog.spencen.com/comments/rss2.aspx"><IMG class=feedbutton 
    alt="Recent Comments RSS 2.0" 
    src="I Command Thee - Exception_files/xml.gif"></A> <A class=feedlink 
    href="http://blog.spencen.com/comments/rss2.aspx">Comments RSS 2.0</A> 
    <LI><A title="Podcasts RSS 2.0" 
    href="http://blog.spencen.com/podcasts-only/rss2.aspx"><IMG class=feedbutton 
    alt="Podcasts RSS 2.0" src="I Command Thee - Exception_files/xml.gif"></A> 
    <A class=feedlink 
    href="http://blog.spencen.com/podcasts-only/rss2.aspx">Podcasts RSS 2.0</A> 
    </LI></UL></DIV>
  <LI class=sidebaritem id=si1>
  <H2 class=archiveheader>Monthly Archives</H2>
  <DIV class=listitemcontent>
  <UL>
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/2007/10.aspx">October 2007 (7)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/2007/09.aspx">September 2007 (5)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/2007/08.aspx">August 2007 (6)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/2007/05.aspx">May 2007 (1)</A> </LI></UL></DIV>
  <LI class=sidebaritem id=si2>
  <H2 class=archiveheader>Category Archives</H2>
  <DIV class=listitemcontent>
  <UL>
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/categories/.NET.aspx">.NET (12)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/categories/Development.aspx">Development 
    (13)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/categories/General.aspx">General (7)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/categories/Windows%20Home%20Server.aspx">Windows 
    Home Server (2)</A> 
    <LI class=archiveitem><A class=archivelink 
    href="http://blog.spencen.com/categories/WPF.aspx">WPF (3)</A> 
</LI></UL></DIV>
  <LI class=sidebaritem id=si5>
  <DIV class=recentlist>
  <H2 class=recentheader>Recent Entries</H2>
  <DIV class=listitemcontent>
  <OL>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/19/winforms-animation.aspx">WinForms 
    Animation</A> 
    <DIV class=recentdate>Friday, October 19, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/17/whs-remote-access.aspx">WHS Remote 
    Access</A> 
    <DIV class=recentdate>Thursday, October 18, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/15/validation-engine.aspx">Validation 
    Engine</A> 
    <DIV class=recentdate>Monday, October 15, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/11/validation-panel.aspx">Validation 
    Panel</A> 
    <DIV class=recentdate>Friday, October 12, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/04/wpf-validation-rules.aspx">WPF 
    Validation Rules</A> 
    <DIV class=recentdate>Monday, October 08, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/04/restoring-pcs-using-windows-home-server.aspx">Restoring 
    PCs using Windows Home Server</A> 
    <DIV class=recentdate>Thursday, October 04, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/10/04/winner.aspx">Winner!</A> 
    <DIV class=recentdate>Thursday, October 04, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/09/30/off-track.aspx">Off Track</A> 
    <DIV class=recentdate>Monday, October 01, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/09/24/i-command-thee--exception.aspx">I 
    Command Thee - Exception?</A> 
    <DIV class=recentdate>Monday, September 24, 2007 </DIV>
    <LI class=recentitem><A class=recentlink title="Read entry" 
    href="http://blog.spencen.com/2007/09/23/windows-home-server-rtm.aspx">Windows 
    Home Server RTM</A> 
    <DIV class=recentdate>Sunday, September 23, 2007 </DIV></LI></OL></DIV></DIV>
  <LI class=sidebaritem id=si8>
  <DIV class=recentlist>
  <H2 class=recentheader>Recent Comments</H2>
  <DIV class=listitemcontent>
  <OL>
    <LI class=recentitem>Nigel Spencer on <A class=recentlink 
    title="Read comment" 
    href="http://blog.spencen.com/2007/09/30/off-track.aspx#comment-600891">Off 
    Track</A> 
    <DIV class=recentdate>10/18/2007 </DIV>
    <LI class=recentitem>Karim on <A class=recentlink title="Read comment" 
    href="http://blog.spencen.com/2007/09/30/off-track.aspx#comment-600329">Off 
    Track</A> 
    <DIV class=recentdate>10/18/2007 </DIV>
    <LI class=recentitem>Jason Stangroome on <A class=recentlink 
    title="Read comment" 
    href="http://blog.spencen.com/2007/10/15/validation-engine.aspx#comment-596521">Validation 
    Engine</A> 
    <DIV class=recentdate>10/16/2007 </DIV>
    <LI class=recentitem>Darren Neimke on <A class=recentlink 
    title="Read comment" 
    href="http://blog.spencen.com/2007/10/04/wpf-validation-rules.aspx#comment-582646">WPF 
    Validation Rules</A> 
    <DIV class=recentdate>10/8/2007 </DIV></LI></OL></DIV></DIV>
  <LI class=sidebaritem id=si9><A id=blogsubscribeanchor></A>
  <DIV class=subscribebox>
  <FORM name=blogentrysubscribe method=post>
  <H2 class=subscribeheader>Subscribe</H2>
  <DIV class=listitemcontent><INPUT id=SubscriberEmail maxLength=255 
  name=SubscriberEmail><BR><INPUT id=EntryID type=hidden value=719303 
  name=EntryID> <INPUT id=SubscribeBlog type=checkbox name=SubscribeBlog>Blog 
  <INPUT id=SubscribeEntry type=checkbox name=SubscribeEntry>Entry<BR><IMG 
  class=subscribeimage onclick=document.blogentrysubscribe.submit() 
  alt=Subscribe src="I Command Thee - Exception_files/btn_subscribe.gif"> 
  </FORM></DIV></DIV>
  <LI class=sidebaritem id=si14>
  <DIV class=homelinkbox>
  <CENTER><A href="http://www.godaddy.com/gdshop/blog/landing.asp"><IMG 
  src="I Command Thee - Exception_files/black_createdby.gif" border=0></A> 
  </CENTER></DIV></LI></UL></DIV></DIV><!-- Nav:End --><!-- 5 -->
<DIV class=sf_blog_extra5><SPAN></SPAN></DIV>
<DIV class=sf_blog_pagetitle><!-- PageTitle:Begin -->
<DIV>Nigel Spencer's Blog: I Command Thee - Exception?</DIV><!-- PageTitle:End --></DIV><!-- 6 -->
<DIV class=sf_blog_extra6><SPAN></SPAN></DIV>
<DIV class=sf_blog_subnavigation></DIV><!-- 11 -->
<DIV class=sf_blog_extra11><SPAN></SPAN></DIV><!-- Content:Begin -->
<DIV class=sf_blog_content>
<DIV class="sf_blog_post single-post">
<H2 class=sf_blog_posttitle id=post-123>I Command Thee - Exception?</H2>
<DIV class=sf_blog_postmeta>Posted by Nigel Spencer at <A 
href="http://blog.spencen.com/2007/09/24/i-command-thee--exception.aspx">9/24/2007 
7:21 AM</A> and is filed under <A class=categorylink 
title="View all entries in this category." 
href="http://blog.spencen.com/categories/e-nFzgNo8LmCjIFHd2WRYbwdHHVSS3wDaUnxk1h-YDc=.aspx">Development</A>,<A 
class=categorylink title="View all entries in this category." 
href="http://blog.spencen.com/categories/TzNOauR-RDA0BrwFTBNfVFZDk3QzEbIms3herNmqgqg=.aspx">.NET</A>,<A 
class=categorylink title="View all entries in this category." 
href="http://blog.spencen.com/categories/4X9Kam23Z-In5H-RALYV4fK4honRVujwr1aa-XbIvQY=.aspx">General</A> 
<A 
href="javascript:this.location.href='http://blog.spencen.com//2007/09/24/i-command-thee--exception/print.aspx'" 
target=_blank><IMG src="I Command Thee - Exception_files/printicon.gif" 
align=absBottom border=0></A> </DIV>
<DIV class=sf_blog_entry>
<P>Ok - so I'm reading through <A 
href="http://blog.spencen.com/2007/08/28/wpf-book.aspx">WPF Unleashed</A> and I 
finish reading the chapter on the various deployment types which also covers the 
inbuilt page navigation framework. Now this is something that I'm very 
interested in having attempted the feat myself a few times. So I decide its time 
to stop reading, roll up the sleeves and give it a try.</P>
<P>To start with I try something like this:</P>
<P>The startup XAML defines we're using a NavigationWindow with the startup page 
being HomePage.xaml.</P><PRE class=code><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">NavigationWindow</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Class</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="WpfParameterPassing.Window1"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> xmlns</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> xmlns</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">x</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="http://schemas.microsoft.com/winfx/2006/xaml"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> Title</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Window1"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Height</SPAN><SPAN style="COLOR: rgb(0,0,255)">="300"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Width</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="300"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> Source</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="HomePage.xaml"&gt;
&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">NavigationWindow</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN></FONT></FONT></PRE>
<P>The HomePage contains a Button and a TextBox. The idea is that the Button 
triggers the navigation passing the content of the TextBox to the called page.<A 
href="http://11011.net/software/vspaste"></A></P>
<P><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Page</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">Class</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="WpfParameterPassing.HomePage"<BR></SPAN>&nbsp;&nbsp; 
<SPAN style="COLOR: rgb(255,0,0)">xmlns</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"<BR></SPAN>&nbsp;&nbsp; 
<SPAN style="COLOR: rgb(255,0,0)">xmlns</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">x</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="http://schemas.microsoft.com/winfx/2006/xaml"<BR></SPAN>&nbsp;&nbsp; 
<SPAN style="COLOR: rgb(255,0,0)">xmlns</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">local</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="clr-namespace:WpfParameterPassing"<BR></SPAN>&nbsp;&nbsp; 
<SPAN style="COLOR: rgb(255,0,0)">Title</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="HomePage"<BR></SPAN>&nbsp;&nbsp; <SPAN 
style="COLOR: rgb(255,0,0)">x</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="_this"&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
Content</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Make Selection"</SPAN><SPAN 
style="COLOR: rgb(255,0,0)"> Click</SPAN><SPAN style="COLOR: rgb(0,0,255)"> 
="Button_Click"/&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">TextBox</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="selectionTextBox"/&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp; </SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&gt;<BR>&lt;/</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Page</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&gt;</SPAN></P>
<P><SPAN style="COLOR: rgb(0,0,255)"></SPAN></P>
<P>The page to call is defined as a PageFunction which means it allows a value 
to be returned. The type of this return value is defined by the x:TypeArguments 
attribute, in this case a string. The called form just has an Ok and Cancel 
button, together with a TextBox that is populated with the input parameter and 
which is used to populate the return value.</P><PRE class=code><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">PageFunction</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Class</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="WpfParameterPassing.SelectFunction"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> xmlns</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> xmlns</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">x</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="http://schemas.microsoft.com/winfx/2006/xaml"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> xmlns</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">sys</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="clr-namespace:System;assembly=mscorlib"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">TypeArguments</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="sys:String"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> Title</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="SelectFunction"
</SPAN>   <SPAN style="COLOR: rgb(255,0,0)"> RemoveFromJournal</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="True"&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">    </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">        </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">WrapPanel</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">            </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Label</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Content</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="Choice to return:"/&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">            </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">TextBox</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="choice"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> HorizontalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Stretch"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Width</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="150"/&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">        </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">WrapPanel</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">        </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">WrapPanel</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">            </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="okButton"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> IsDefault</SPAN><SPAN style="COLOR: rgb(0,0,255)"> ="True"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Content</SPAN><SPAN style="COLOR: rgb(0,0,255)">="_OK"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                       HorizontalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Right"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Click</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="Button_Click" /&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">            </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="cancelButton"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> IsCancel</SPAN><SPAN style="COLOR: rgb(0,0,255)">="True"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Content</SPAN><SPAN style="COLOR: rgb(0,0,255)">="_Cancel"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                       HorizontalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Right"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Click</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">="cancelButton_Click" /&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">        </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">WrapPanel</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&gt;
</SPAN><SPAN style="COLOR: rgb(163,21,21)">    </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN></FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">&gt;
&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">PageFunction</SPAN></FONT></FONT><SPAN style="COLOR: rgb(0,0,255)"><FONT face=Verdana size=2>&gt;</FONT>
</SPAN></PRE>
<P>A little bit of code behind for the HomePage is used to trigger the 
navigation and to subscribe to the Return event so we can update the TextBox 
with the value returned from the called page.</P><PRE class=code><FONT face=Verdana size=2>    <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">partial</SPAN> <SPAN style="COLOR: rgb(0,0,255)">class</SPAN> <SPAN style="COLOR: rgb(43,145,175)">HomePage</SPAN> : </FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(43,145,175)">Page
</SPAN>    {
        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> HomePage()
        {
            InitializeComponent();
        }

        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> Button_Click(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> sender, <SPAN style="COLOR: rgb(43,145,175)">RoutedEventArgs</SPAN> e)
        {
            <SPAN style="COLOR: rgb(43,145,175)">SelectFunction</SPAN> nextPage = <SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">SelectFunction</SPAN>(selectionTextBox.Text);
            nextPage.Return += <SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">ReturnEventHandler</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt;(nextPage_Return);
            <SPAN style="COLOR: rgb(0,0,255)">this</SPAN>.NavigationService.Navigate(nextPage);
        }

        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> nextPage_Return(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> sender, <SPAN style="COLOR: rgb(43,145,175)">ReturnEventArgs</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt; e)
        {
            <SPAN style="COLOR: rgb(0,0,255)">if</SPAN> (!<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>.IsNullOrEmpty(e.Result))
                selectionTextBox.Text = e.Result;
        }
    }</FONT></FONT></PRE><A href="http://11011.net/software/vspaste"></A>
<P>Some code behind on the PageFunction derived class is used to wire up the Ok 
and Cancel buttons. The constructor overload is then used to allow the input 
parameters to be passed. I like the idea of using constructors to pass the 
parameters - neat. [Its a shame parameterized constructors can't be used to 
initialize objects in XAML - but that's a whole other story.]</P><PRE class=code><FONT face=Verdana size=2>    <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">partial</SPAN> <SPAN style="COLOR: rgb(0,0,255)">class</SPAN> <SPAN style="COLOR: rgb(43,145,175)">SelectFunction</SPAN> : <SPAN style="COLOR: rgb(43,145,175)">PageFunction</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt;
    {
        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> SelectFunction()
        {
            InitializeComponent();
        }

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> SelectFunction(<SPAN style="COLOR: rgb(0,0,255)">string</SPAN> previousSelection) : <SPAN style="COLOR: rgb(0,0,255)">this</SPAN>()
        {
            choice.Text = previousSelection;
        }

        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> Button_Click(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> sender, <SPAN style="COLOR: rgb(43,145,175)">RoutedEventArgs</SPAN> e)
        {
            OnReturn(<SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">ReturnEventArgs</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt;(choice.Text));
        }

        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> cancelButton_Click(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> sender, <SPAN style="COLOR: rgb(43,145,175)">RoutedEventArgs</SPAN> e)
        {
            OnReturn(<SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">ReturnEventArgs</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt;());
        }
    }</FONT></PRE><A href="http://11011.net/software/vspaste"></A>
<P>So - put all this together and it works as expected. Enter a value on the 
first page (HomePage) - click the button and the value is transferred to the 
second page (SelectFunction) where it can be modified and returned via the 
return result. </P>
<P>The next step is to get rid of all that code behind that binds HomePage to 
SelectFunction. What better way to do this than with a Command? This is where 
things began to get fuzzy. If I want to create my own command what should it 
derive from? After a few false starts attempting to derive from RoutedCommand 
etc. I decide not to derive from anything and just implement ICommand 
myself.</P><PRE class=code><FONT face=Verdana size=2>    <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">class</SPAN> <SPAN style="COLOR: rgb(43,145,175)">SelectCommand</SPAN> : <SPAN style="COLOR: rgb(43,145,175)">ICommand</SPAN>, </FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(43,145,175)">INotifyPropertyChanged
</SPAN>    {
        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">string</SPAN> _selection;

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> SelectCommand()
        {
            </FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,128,0)">//Text = "Select Choice";
</SPAN>        }

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(43,145,175)">Page</SPAN> CallingPage { <SPAN style="COLOR: rgb(0,0,255)">get</SPAN>; <SPAN style="COLOR: rgb(0,0,255)">set</SPAN>; }

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">string</SPAN> Selection 
        { 
            <SPAN style="COLOR: rgb(0,0,255)">get</SPAN> 
            { <SPAN style="COLOR: rgb(0,0,255)">return</SPAN> _selection; } 
            <SPAN style="COLOR: rgb(0,0,255)">set</SPAN> 
            {
                _selection = <SPAN style="COLOR: rgb(0,0,255)">value</SPAN>;
                OnPropertyChanged(<SPAN style="COLOR: rgb(163,21,21)">"Selection"</SPAN>); 
            } 
        }

        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> OnPropertyChanged(<SPAN style="COLOR: rgb(0,0,255)">string</SPAN> p)
        {
            <SPAN style="COLOR: rgb(0,0,255)">if</SPAN> (PropertyChanged != <SPAN style="COLOR: rgb(0,0,255)">null</SPAN>)
                PropertyChanged(<SPAN style="COLOR: rgb(0,0,255)">this</SPAN>, <SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">PropertyChangedEventArgs</SPAN>(p));
        }
</FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,128,0)">
</SPAN><SPAN style="COLOR: rgb(0,0,255)">        #region</SPAN> ICommand Members

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">bool</SPAN> CanExecute(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> parameter)
        {
            <SPAN style="COLOR: rgb(0,0,255)">return</SPAN> <SPAN style="COLOR: rgb(0,0,255)">true</SPAN>;
        }

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">event</SPAN> <SPAN style="COLOR: rgb(43,145,175)">EventHandler</SPAN> CanExecuteChanged;

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> Execute(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> parameter)
        {
            <SPAN style="COLOR: rgb(0,0,255)">if</SPAN> (CallingPage == <SPAN style="COLOR: rgb(0,0,255)">null</SPAN>)
                CallingPage = (<SPAN style="COLOR: rgb(43,145,175)">Page</SPAN>) parameter;

            <SPAN style="COLOR: rgb(0,0,255)">if</SPAN> (CallingPage == <SPAN style="COLOR: rgb(0,0,255)">null</SPAN>)
                <SPAN style="COLOR: rgb(0,0,255)">throw</SPAN> <SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">InvalidOperationException</SPAN>(<BR>                                 <SPAN style="COLOR: rgb(163,21,21)">"CallingPage cannot be null when invoking the Execute method."</SPAN>);

            <SPAN style="COLOR: rgb(43,145,175)">SelectFunction</SPAN> nextPage = <SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">SelectFunction</SPAN>(Selection);
            nextPage.Return += <SPAN style="COLOR: rgb(0,0,255)">new</SPAN> <SPAN style="COLOR: rgb(43,145,175)">ReturnEventHandler</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt;(nextPage_Return);
            CallingPage.NavigationService.Navigate(nextPage);
        }

</FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">        #endregion

</SPAN>        <SPAN style="COLOR: rgb(0,0,255)">private</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> nextPage_Return(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> sender, <SPAN style="COLOR: rgb(43,145,175)">ReturnEventArgs</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt; e)
        {
</FONT></FONT><FONT size=2><FONT face=Verdana>            <SPAN style="COLOR: rgb(0,0,255)">if</SPAN> (!<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>.IsNullOrEmpty(e.Result))
                Selection = e.Result;
        }

<SPAN style="COLOR: rgb(0,0,255)">        #region</SPAN> INotifyPropertyChanged Members

        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">event</SPAN> <SPAN style="COLOR: rgb(43,145,175)">PropertyChangedEventHandler</SPAN> PropertyChanged;

</FONT></FONT><FONT size=2><FONT face=Verdana><SPAN style="COLOR: rgb(0,0,255)">        #endregion
</SPAN>    }</FONT></FONT></PRE><A href="http://11011.net/software/vspaste"></A>
<P>Get rid of all the code behind in HomePage and redefine the Button and 
TextBox to instantiate a new command and a bit of binding to glue it 
together.</P><A href="http://11011.net/software/vspaste"></A>
<P><SPAN style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
Content</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Make Selection"</SPAN><SPAN 
style="COLOR: rgb(255,0,0)"> CommandParameter</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
ElementName</SPAN><SPAN style="COLOR: rgb(0,0,255)">=</SPAN>_<SPAN 
style="COLOR: rgb(0,0,255)">this}"&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Button.Command</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">local</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">SelectCommand</SPAN><SPAN 
style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="selectCommand"/&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Button.Command</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&gt;<BR></SPAN><SPAN 
style="COLOR: rgb(163,21,21)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN 
style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">TextBox</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN 
style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="selectionTextBox"</SPAN><SPAN 
style="COLOR: rgb(255,0,0)"> Text</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN 
style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> 
ElementName</SPAN><SPAN style="COLOR: rgb(0,0,255)">=selectCommand,</SPAN><SPAN 
style="COLOR: rgb(255,0,0)"> Path</SPAN><SPAN 
style="COLOR: rgb(0,0,255)">=Selection}"/&gt;</SPAN></P>
<P>Now that's much better. My button is set to execute a command when its 
activated (Clicked) and the command controls the page navigation and parameter 
passing for me. We get the result back into the page simply by binding our 
output field (in this case selectionTextBox) to the Selection property of the 
command (essentially the output parameter).</P>
<P>But does it work... well no. It generates this little beauty:</P>
<P><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
height=314 alt="WPF Exception" 
src="I Command Thee - Exception_files/WPF%20Exception_3.png" width=456 border=0> 
</P>
<P>Hmm... so is this a bug - or have I somehow hooked into some interop? If I 
remove the event handler subscription to the Return event everything works fine 
- except of course I don't get my value <IMG 
src="I Command Thee - Exception_files/sad.png" border=0>.</P>
<P>I even tried Dispatching back to the UI thread in case it was a weird 
threading related issue - no luck. Interestingly when I first attempted to 
create my command by inheriting from RoutedCommand the button was disabled. This 
was despite the fact that my CanExecute method is hard-coded to return true. Its 
at this point I think I need to go back to the books - I'm obviously missing 
something.</P>
<P>___________________________________</P>
<P>And the answer is given <A 
href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1975763&amp;SiteID=1">here</A>.</P>
<P>To work around the limitation I need to make the callback for the return an 
instance method of the calling form. Hmm... easy enough passing as a callback 
delegate in C# but how to declare that in XAML? Not too sure about the merits of 
this limitation - means putting code in the HomePage code behind again.<PRE class=code><FONT face=Verdana size=2>        <SPAN style="COLOR: rgb(0,0,255)">public</SPAN> <SPAN style="COLOR: rgb(0,0,255)">void</SPAN> Returned(<SPAN style="COLOR: rgb(0,0,255)">object</SPAN> sender, <SPAN style="COLOR: rgb(43,145,175)">ReturnEventArgs</SPAN>&lt;<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>&gt; e)
        {
            <SPAN style="COLOR: rgb(0,0,255)">if</SPAN> (!<SPAN style="COLOR: rgb(0,0,255)">string</SPAN>.IsNullOrEmpty(e.Result))
                selectionTextBox.Text = e.Result;
        }</FONT></PRE><A href="http://11011.net/software/vspaste"></A>
<P>Oh - and a bit of reading into RoutedUICommand makes things clearer as to why 
inheriting from it got me nowhere <IMG 
src="I Command Thee - Exception_files/smile.png" border=0> Maybe it can help me 
with the problem above though?</P>
<P></P></DIV>
<DIV id=divline>&nbsp;</DIV><!-- Survey Component -->
<DIV class=sf_blog_survey>
<DIV id=blogsurvey>
<FORM id=formsurvey name=formsurvey 
action=/2007/09/24/i-command-thee--exception.aspx method=post>
<P id=surveytitletext>What did you think of this article?</P>
<DIV id=surveyoptions><INPUT id=liked type=radio value=1 name=opinion><LABEL 
for=liked>Liked</LABEL><BR><INPUT id=disliked type=radio value=2 
name=opinion><LABEL for=disliked>Disliked</LABEL><BR><INPUT id=noopinion 
type=radio value=3 name=opinion><LABEL for=noopinion>No 
Opinion</LABEL><BR></DIV>
<DIV id=surveysubmit><INPUT type=submit value="Vote &amp; See Results" name=SubmitSurvey> 
</DIV></FORM></DIV></DIV><!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
	xmlns:trackback="http://madskills.com/public/sml/rss/module/trackback/" 
	xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description 
	rdf:about="http://blog.spencen.com/2007/09/24/i-command-thee--exception.aspx" 
	trackback:ping="http://blog.spencen.com/2007/09/24/i-command-thee--exception/trackback.aspx" 
	dc:title="I Command Thee - Exception?" 
	dc:identifier="http://blog.spencen.com/2007/09/24/i-command-thee--exception.aspx" 
/>
</rdf:RDF>
-->
<DIV id=trackbacks>
<H6 id=trackbackslabel>Trackbacks</H6>
<DIV class=trackbacklinks><A 
onclick="alert('You can use the trackback URL to link to this entry from your own blog or Web site. To copy this link, right-click on the link and select &quot;Copy Shortcut&quot; in Internet Explorer or &quot;Copy Link Location&quot; in Mozilla.'); return false; " 
href="http://blog.spencen.com/2007/09/24/i-command-thee--exception/trackback.aspx">Trackback 
specific URL for this entry</A> </DIV>
<UL class=trackbacklist>
  <LI><A id=Trackback></A>No trackbacks exist for this entry. </LI></UL></DIV>
<DIV id=comments1><A id=Comment></A>
<H6 id=commentslabel>Comments</H6>
<UL class=commentlist>
  <LI>No comments exist for this entry.</LI></UL></DIV>
<DIV id=leavecomment>
<H6 id=leavecommentlabel>Leave a comment</H6>
<SCRIPT language=javascript src="I Command Thee - Exception_files/a.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=javascript src="I Command Thee - Exception_files/spell.js" 
type=text/javascript></SCRIPT>
<A id=AddComment></A>
<FORM id=formcomment name=formcomment 
action=/2007/09/24/i-command-thee--exception.aspx method=post>
<P style="FONT-WEIGHT: bold; COLOR: red">Submitted comments will be subject to 
moderation before being displayed.</P>
<P><IMG src="I Command Thee - Exception_files/captchaimage.jpg" border=1></P>
<P><INPUT id=captcha tabIndex=1 size=22 name=captcha>&nbsp;<SPAN 
id=comment_captcha>Enter the above security code (required)</SPAN></P>
<P><INPUT id=author tabIndex=2 size=22 name=author>&nbsp;<SPAN 
id=comment_name>Name</SPAN></P>
<P><INPUT id=email tabIndex=3 size=22 name=email>&nbsp;<SPAN 
id=comment_email>Email (will not be published)</SPAN></P>
<P><INPUT id=url tabIndex=4 size=22 name=url>&nbsp;<SPAN 
id=comment_url>Website</SPAN></P>
<DIV class=hidden id=reply></DIV>
<P><TEXTAREA id=comments tabIndex=5 name=comments rows=6 cols=40></TEXTAREA></P>
<P>
<DIV id=div_numchars>Your comment is 0 characters <FONT color=red>limited to 
3000 characters</FONT>.<BR><BR></DIV>
<P></P>
<P><INPUT id=entrysubscribe tabIndex=6 type=checkbox name=entrysubscribe><LABEL 
for=entrysubscribe>Subscribe to this entry</LABEL> <BR><INPUT id=blogsubscribe 
tabIndex=7 type=checkbox name=blogsubscribe><LABEL for=blogsubscribe>Subscribe 
to this blog</LABEL> <BR><INPUT id=rememberme tabIndex=8 type=checkbox 
name=rememberme><LABEL for=rememberme>Remember me</LABEL></P>
<P><INPUT id=submitcomment tabIndex=9 type=submit value="Submit Comment" name=submitcomment>&nbsp;<INPUT id=resetcomment tabIndex=10 type=submit value=Cancel name=resetcomment>&nbsp;<INPUT id=spellchk onclick=checkSpelling() tabIndex=11 type=button value="Check Spelling" name=spellchk><INPUT 
id=Hidden1 type=hidden name=entry_id></P><INPUT id=parent type=hidden value=0 
name=parent></FORM>
<SCRIPT language=JavaScript>var c = 0;
	function countNumChars(){
		var commentField = document.getElementById('comments');
		var numChars = commentField.value.length;
		if (numChars > 3000){
			commentField.value = commentField.value.substring(0,3000);

			if (document.getElementById('div_numchars')){
				document.getElementById('div_numchars').innerHTML = 'Your comment is <b>3000 characters</b>.';
			}
		}
		else {
			if (document.getElementById('div_numchars')){
				if (numChars != c){
					document.getElementById('div_numchars').innerHTML = 'Your comment is <b>' + numChars + '</b> characters <font color=red>limited to 3000 characters</font>.<br><br>';
					c = numChars;
				}
			}
		}

		setTimeout("countNumChars()", 100);
	}
	document.getElementById('comments').onFocus = countNumChars();
</SCRIPT>
</DIV></DIV></DIV><!-- /sf_blog_content --><!-- Content:End --><!-- /sf_blog_content --><!-- 12 -->
<DIV class=sf_blog_extra12s><SPAN></SPAN></DIV>
<DIV class=sf_blog_subnavigation2></DIV><!-- 7 -->
<DIV class=sf_blog_extra7><SPAN></SPAN></DIV><!-- Footer:Begin -->
<DIV class=sf_blog_footer>
<DIV style="DISPLAY: block">Copyright 2007. All rights reserved.</DIV></DIV><!-- Footer:End --><!-- /sf_blog_footer --><!-- 8 -->
<DIV class=sf_blog_extra8><SPAN></SPAN></DIV>
<DIV class=sf_blog_banner></DIV></DIV><!-- /sf_blog_wrapper --><!-- 9 -->
<DIV class=sf_blog_extra9><SPAN></SPAN></DIV></DIV><!-- /sf_blog_outer_wrapper --></BODY></HTML>
